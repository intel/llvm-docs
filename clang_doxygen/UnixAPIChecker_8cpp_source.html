<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>clang: lib/StaticAnalyzer/Checkers/UnixAPIChecker.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">clang
   &#160;<span id="projectnumber">15.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_5323669f7aaa7f9ff43db9a3c9e1bf2d.html">StaticAnalyzer</a></li><li class="navelem"><a class="el" href="dir_98a0d9a5a3820cce728a787f3e823141.html">Checkers</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">UnixAPIChecker.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="UnixAPIChecker_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//= UnixAPIChecker.h - Checks preconditions for various Unix APIs --*- C++ -*-//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This defines UnixAPIChecker, which is an assortment of checks on calls</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// to various, widely used UNIX/Posix functions.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BuiltinCheckerRegistration_8h.html">clang/StaticAnalyzer/Checkers/BuiltinCheckerRegistration.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="include_2clang_2Basic_2TargetInfo_8h.html">clang/Basic/TargetInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BugType_8h.html">clang/StaticAnalyzer/Core/BugReporter/BugType.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Checker_8h.html">clang/StaticAnalyzer/Core/Checker.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CheckerManager_8h.html">clang/StaticAnalyzer/Core/CheckerManager.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CheckerContext_8h.html">clang/StaticAnalyzer/Core/PathSensitive/CheckerContext.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;llvm/ADT/Optional.h&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;llvm/ADT/STLExtras.h&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;llvm/ADT/SmallString.h&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;llvm/ADT/StringExtras.h&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;llvm/Support/raw_ostream.h&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceclang.html">clang</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">using namespace </span>ento;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="UnixAPIChecker_8cpp.html#a541c929849428f58631407235a1aaac2">   29</a></span>&#160;<span class="keyword">enum class</span> <a class="code" href="UnixAPIChecker_8cpp.html#a541c929849428f58631407235a1aaac2">OpenVariant</a> {<span class="comment"></span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">  /// The standard open() call:</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">  ///    int open(const char *path, int oflag, ...);</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"></span>  Open,</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">  /// The variant taking a directory file descriptor and a relative path:</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">  ///    int openat(int fd, const char *path, int oflag, ...);</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span>  <a class="code" href="UnixAPIChecker_8cpp.html#a541c929849428f58631407235a1aaac2a95d1d829b95945407cd57e529fa5d98e">OpenAt</a></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;};</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">class </span>UnixAPIMisuseChecker : <span class="keyword">public</span> Checker&lt; check::PreStmt&lt;CallExpr&gt; &gt; {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;BugType&gt; BT_open, BT_pthreadOnce;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keyword">mutable</span> <a class="code" href="classllvm_1_1Optional.html">Optional&lt;uint64_t&gt;</a> Val_O_CREAT;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  DefaultBool CheckMisuse, CheckPortability;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">void</span> checkPreStmt(<span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">void</span> CheckOpen(CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">void</span> CheckOpenAt(CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordtype">void</span> CheckPthreadOnce(CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">void</span> CheckOpenVariant(CheckerContext &amp;C,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE, <a class="code" href="UnixAPIChecker_8cpp.html#a541c929849428f58631407235a1aaac2">OpenVariant</a> Variant) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">void</span> ReportOpenBug(CheckerContext &amp;C,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                     <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">char</span> *Msg,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                     <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> SR) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;};</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">class </span>UnixAPIPortabilityChecker : <span class="keyword">public</span> Checker&lt; check::PreStmt&lt;CallExpr&gt; &gt; {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordtype">void</span> checkPreStmt(<span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;BugType&gt; BT_mallocZero;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordtype">void</span> CheckCallocZero(CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordtype">void</span> CheckMallocZero(CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">void</span> CheckReallocZero(CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">void</span> CheckReallocfZero(CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">void</span> CheckAllocaZero(CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordtype">void</span> CheckAllocaWithAlignZero(CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">void</span> CheckVallocZero(CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">bool</span> ReportZeroByteAllocation(CheckerContext &amp;C,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> falseState,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *<a class="code" href="namespacestd.html#abc7307bd3d6368059069bfe77bee0439">arg</a>,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">char</span> *fn_name) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">void</span> BasicAllocationCheck(CheckerContext &amp;C,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> numArgs,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> sizeArg,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">char</span> *fn) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;};</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;} <span class="comment">//end anonymous namespace</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="UnixAPIChecker_8cpp.html#a32b38fe04abbe10e1de6b9af6b2b7919">   92</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="UnixAPIChecker_8cpp.html#a32b38fe04abbe10e1de6b9af6b2b7919">LazyInitialize</a>(<span class="keyword">const</span> CheckerBase *Checker,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                           std::unique_ptr&lt;BugType&gt; &amp;BT,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespaceclang_1_1transformer.html#afb9ae3f6ff9907205cd12c218f76df7e">name</a>) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span> (BT)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  BT.reset(<span class="keyword">new</span> BugType(Checker, <a class="code" href="namespaceclang_1_1transformer.html#afb9ae3f6ff9907205cd12c218f76df7e">name</a>, <a class="code" href="namespaceclang_1_1ento_1_1categories.html#a54df5af5f5165c3ce2daf6c8ebdfc64d">categories::UnixAPI</a>));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">// &quot;open&quot; (man 2 open)</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//===----------------------------------------------------------------------===/</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keywordtype">void</span> UnixAPIMisuseChecker::checkPreStmt(<span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                        CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *FD = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getCalleeDecl(CE);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">if</span> (!FD || FD-&gt;<a class="code" href="classclang_1_1Decl.html#aedd1ee920162f9a35e8d249a4926d9d5">getKind</a>() != Decl::Function)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">// Don&#39;t treat functions in namespaces with the same name a Unix function</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="comment">// as a call to the Unix function.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1DeclContext.html">DeclContext</a> *NamespaceCtx = FD-&gt;<a class="code" href="classclang_1_1DeclContext.html#aa838660af381c6967722c6552580c2a2">getEnclosingNamespaceContext</a>();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">if</span> (isa_and_nonnull&lt;NamespaceDecl&gt;(NamespaceCtx))</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  StringRef FName = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getCalleeName(FD);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (FName.empty())</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;open&quot;</span>)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    CheckOpen(C, CE);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;openat&quot;</span>)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    CheckOpenAt(C, CE);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;pthread_once&quot;</span>)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    CheckPthreadOnce(C, CE);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keywordtype">void</span> UnixAPIMisuseChecker::ReportOpenBug(CheckerContext &amp;C,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                         <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                         <span class="keyword">const</span> <span class="keywordtype">char</span> *Msg,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                         <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> SR)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateErrorNode(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">if</span> (!N)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="UnixAPIChecker_8cpp.html#a32b38fe04abbe10e1de6b9af6b2b7919">LazyInitialize</a>(<span class="keyword">this</span>, BT_open, <span class="stringliteral">&quot;Improper use of &#39;open&#39;&quot;</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keyword">auto</span> Report = std::make_unique&lt;PathSensitiveBugReport&gt;(*BT_open, Msg, N);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  Report-&gt;addRange(SR);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::move(Report));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordtype">void</span> UnixAPIMisuseChecker::CheckOpen(CheckerContext &amp;C,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  CheckOpenVariant(C, CE, <a class="code" href="UnixAPIChecker_8cpp.html#a541c929849428f58631407235a1aaac2ac3bf447eabe632720a3aa1a7ce401274">OpenVariant::Open</a>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordtype">void</span> UnixAPIMisuseChecker::CheckOpenAt(CheckerContext &amp;C,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  CheckOpenVariant(C, CE, <a class="code" href="UnixAPIChecker_8cpp.html#a541c929849428f58631407235a1aaac2a95d1d829b95945407cd57e529fa5d98e">OpenVariant::OpenAt</a>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordtype">void</span> UnixAPIMisuseChecker::CheckOpenVariant(CheckerContext &amp;C,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                            <a class="code" href="UnixAPIChecker_8cpp.html#a541c929849428f58631407235a1aaac2">OpenVariant</a> Variant)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// The index of the argument taking the flags open flags (O_RDONLY,</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">// O_WRONLY, O_CREAT, etc.),</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> FlagsArgIndex;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *VariantName;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">switch</span> (Variant) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="UnixAPIChecker_8cpp.html#a541c929849428f58631407235a1aaac2ac3bf447eabe632720a3aa1a7ce401274">OpenVariant::Open</a>:</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    FlagsArgIndex = 1;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    VariantName = <span class="stringliteral">&quot;open&quot;</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="UnixAPIChecker_8cpp.html#a541c929849428f58631407235a1aaac2a95d1d829b95945407cd57e529fa5d98e">OpenVariant::OpenAt</a>:</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    FlagsArgIndex = 2;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    VariantName = <span class="stringliteral">&quot;openat&quot;</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  };</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// All calls should at least provide arguments up to the &#39;flags&#39; parameter.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> MinArgCount = FlagsArgIndex + 1;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// If the flags has O_CREAT set then open/openat() require an additional</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// argument specifying the file mode (permission bits) for the created file.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> CreateModeArgIndex = FlagsArgIndex + 1;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">// The create mode argument should be the last argument.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> MaxArgCount = CreateModeArgIndex + 1;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">if</span> (CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa439df008533164342c841a8a22dec1f">getNumArgs</a>() &lt; MinArgCount) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// The frontend should issue a warning for this case. Just return.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa439df008533164342c841a8a22dec1f">getNumArgs</a>() == MaxArgCount) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *Arg = CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa454d6f1e76623da60451885239f63c6">getArg</a>(CreateModeArgIndex);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="classclang_1_1QualType.html">QualType</a> QT = Arg-&gt;<a class="code" href="classclang_1_1Expr.html#ac9bfcc699442f2093723cfcf703d9f47">getType</a>();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">if</span> (!QT-&gt;<a class="code" href="classclang_1_1Type.html#a3b8d0cdfe0bdd8b98296b84ae9d438c5">isIntegerType</a>()) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;256&gt;</a> SBuf;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      llvm::raw_svector_ostream <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a>(SBuf);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a> &lt;&lt; <span class="stringliteral">&quot;The &quot;</span> &lt;&lt; CreateModeArgIndex + 1</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;         &lt;&lt; llvm::getOrdinalSuffix(CreateModeArgIndex + 1)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; argument to &#39;&quot;</span> &lt;&lt; VariantName &lt;&lt; <span class="stringliteral">&quot;&#39; is not an integer&quot;</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      ReportOpenBug(C, <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>,</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    SBuf.c_str(),</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    Arg-&gt;<a class="code" href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">getSourceRange</a>());</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa439df008533164342c841a8a22dec1f">getNumArgs</a>() &gt; MaxArgCount) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;256&gt;</a> SBuf;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    llvm::raw_svector_ostream <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a>(SBuf);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a> &lt;&lt; <span class="stringliteral">&quot;Call to &#39;&quot;</span> &lt;&lt; VariantName &lt;&lt; <span class="stringliteral">&quot;&#39; with more than &quot;</span> &lt;&lt; MaxArgCount</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;       &lt;&lt; <span class="stringliteral">&quot; arguments&quot;</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    ReportOpenBug(C, <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                  SBuf.c_str(),</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                  CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa454d6f1e76623da60451885239f63c6">getArg</a>(MaxArgCount)-&gt;<a class="code" href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">getSourceRange</a>());</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// The definition of O_CREAT is platform specific.  We need a better way</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// of querying this information from the checking environment.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">if</span> (!Val_O_CREAT.hasValue()) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getASTContext().getTargetInfo().getTriple().getVendor()</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                                      == llvm::Triple::Apple)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      Val_O_CREAT = 0x0200;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="comment">// FIXME: We need a more general way of getting the O_CREAT value.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="comment">// We could possibly grovel through the preprocessor state, but</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="comment">// that would require passing the Preprocessor object to the ExprEngine.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="comment">// See also: MallocChecker.cpp / M_ZERO.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// Now check if oflags has O_CREAT set.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *oflagsEx = CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa454d6f1e76623da60451885239f63c6">getArg</a>(FlagsArgIndex);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keyword">const</span> SVal <a class="code" href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(oflagsEx);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a>.getAs&lt;NonLoc&gt;()) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// The case where &#39;V&#39; can be a location can only be due to a bad header,</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// so in this case bail out.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  NonLoc oflags = <a class="code" href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a>.castAs&lt;NonLoc&gt;();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  NonLoc ocreateFlag = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSValBuilder()</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      .makeIntVal(Val_O_CREAT.getValue(), oflagsEx-&gt;<a class="code" href="classclang_1_1Expr.html#ac9bfcc699442f2093723cfcf703d9f47">getType</a>()).castAs&lt;NonLoc&gt;();</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  SVal maskedFlagsUC = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSValBuilder().evalBinOpNN(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>, BO_And,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                                      oflags, ocreateFlag,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                                      oflagsEx-&gt;<a class="code" href="classclang_1_1Expr.html#ac9bfcc699442f2093723cfcf703d9f47">getType</a>());</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">if</span> (maskedFlagsUC.isUnknownOrUndef())</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  DefinedSVal maskedFlags = maskedFlagsUC.castAs&lt;DefinedSVal&gt;();</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="comment">// Check if maskedFlags is non-zero.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> trueState, falseState;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  std::tie(trueState, falseState) = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;assume(maskedFlags);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// Only emit an error if the value of &#39;maskedFlags&#39; is properly</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// constrained;</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">if</span> (!(trueState &amp;&amp; !falseState))</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">if</span> (CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa439df008533164342c841a8a22dec1f">getNumArgs</a>() &lt; MaxArgCount) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;256&gt;</a> SBuf;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    llvm::raw_svector_ostream <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a>(SBuf);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a> &lt;&lt; <span class="stringliteral">&quot;Call to &#39;&quot;</span> &lt;&lt; VariantName &lt;&lt; <span class="stringliteral">&quot;&#39; requires a &quot;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;       &lt;&lt; CreateModeArgIndex + 1</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;       &lt;&lt; llvm::getOrdinalSuffix(CreateModeArgIndex + 1)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;       &lt;&lt; <span class="stringliteral">&quot; argument when the &#39;O_CREAT&#39; flag is set&quot;</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    ReportOpenBug(C, trueState,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                  SBuf.c_str(),</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                  oflagsEx-&gt;<a class="code" href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">getSourceRange</a>());</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">// pthread_once</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="keywordtype">void</span> UnixAPIMisuseChecker::CheckPthreadOnce(CheckerContext &amp;C,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// This is similar to &#39;CheckDispatchOnce&#39; in the MacOSXAPIChecker.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">// They can possibly be refactored.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordflow">if</span> (CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa439df008533164342c841a8a22dec1f">getNumArgs</a>() &lt; 1)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// Check if the first argument is stack allocated.  If so, issue a warning</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// because that&#39;s likely to be bad news.</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keyword">const</span> MemRegion *R = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa454d6f1e76623da60451885239f63c6">getArg</a>(0)).getAsRegion();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">if</span> (!R || !isa&lt;StackSpaceRegion&gt;(R-&gt;getMemorySpace()))</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateErrorNode(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span> (!N)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;256&gt;</a> S;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  llvm::raw_svector_ostream os(S);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Call to &#39;pthread_once&#39; uses&quot;</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> VarRegion *VR = dyn_cast&lt;VarRegion&gt;(R))</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot; the local variable &#39;&quot;</span> &lt;&lt; VR-&gt;getDecl()-&gt;getName() &lt;&lt; <span class="charliteral">&#39;\&#39;&#39;</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot; stack allocated memory&quot;</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; for the \&quot;control\&quot; value.  Using such transient memory for &quot;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="stringliteral">&quot;the control value is potentially dangerous.&quot;</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">if</span> (isa&lt;VarRegion&gt;(R) &amp;&amp; isa&lt;StackLocalsSpaceRegion&gt;(R-&gt;getMemorySpace()))</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;  Perhaps you intended to declare the variable as &#39;static&#39;?&quot;</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="UnixAPIChecker_8cpp.html#a32b38fe04abbe10e1de6b9af6b2b7919">LazyInitialize</a>(<span class="keyword">this</span>, BT_pthreadOnce, <span class="stringliteral">&quot;Improper use of &#39;pthread_once&#39;&quot;</span>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keyword">auto</span> report =</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      std::make_unique&lt;PathSensitiveBugReport&gt;(*BT_pthreadOnce, os.str(), N);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  report-&gt;addRange(CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa454d6f1e76623da60451885239f63c6">getArg</a>(0)-&gt;<a class="code" href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">getSourceRange</a>());</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::move(report));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">// &quot;calloc&quot;, &quot;malloc&quot;, &quot;realloc&quot;, &quot;reallocf&quot;, &quot;alloca&quot; and &quot;valloc&quot;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">// with allocation size 0</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">// FIXME: Eventually these should be rolled into the MallocChecker, but right now</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">// they&#39;re more basic and valuable for widespread use.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">// Returns true if we try to do a zero byte allocation, false otherwise.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">// Fills in trueState and falseState.</span></div>
<div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="UnixAPIChecker_8cpp.html#a17cae85b3247d20de9bf6c1af4f708e7">  323</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="UnixAPIChecker_8cpp.html#a17cae85b3247d20de9bf6c1af4f708e7">IsZeroByteAllocation</a>(<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                 <span class="keyword">const</span> SVal argVal,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                 <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> *trueState,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                 <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> *falseState) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  std::tie(*trueState, *falseState) =</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;assume(argVal.castAs&lt;DefinedSVal&gt;());</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">return</span> (*falseState &amp;&amp; !*trueState);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;}</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">// Generates an error report, indicating that the function whose name is given</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">// will perform a zero byte allocation.</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">// Returns false if an error occurred, true otherwise.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keywordtype">bool</span> UnixAPIPortabilityChecker::ReportZeroByteAllocation(</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                                    CheckerContext &amp;C,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                                    <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> falseState,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                                    <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *<a class="code" href="namespacestd.html#abc7307bd3d6368059069bfe77bee0439">arg</a>,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *fn_name)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateErrorNode(falseState);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">if</span> (!N)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <a class="code" href="UnixAPIChecker_8cpp.html#a32b38fe04abbe10e1de6b9af6b2b7919">LazyInitialize</a>(<span class="keyword">this</span>, BT_mallocZero,</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                 <span class="stringliteral">&quot;Undefined allocation of 0 bytes (CERT MEM04-C; CWE-131)&quot;</span>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;256&gt;</a> S;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  llvm::raw_svector_ostream os(S);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Call to &#39;&quot;</span> &lt;&lt; fn_name &lt;&lt; <span class="stringliteral">&quot;&#39; has an allocation size of 0 bytes&quot;</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keyword">auto</span> report =</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      std::make_unique&lt;PathSensitiveBugReport&gt;(*BT_mallocZero, os.str(), N);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  report-&gt;addRange(<a class="code" href="namespacestd.html#abc7307bd3d6368059069bfe77bee0439">arg</a>-&gt;getSourceRange());</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="namespaceclang_1_1ento_1_1bugreporter.html#a9f4acbc86c4e8c0a8601b7e7e42814c9">bugreporter::trackExpressionValue</a>(N, <a class="code" href="namespacestd.html#abc7307bd3d6368059069bfe77bee0439">arg</a>, *report);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::move(report));</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">// Does a basic check for 0-sized allocations suitable for most of the below</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">// functions (modulo &quot;calloc&quot;)</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="keywordtype">void</span> UnixAPIPortabilityChecker::BasicAllocationCheck(CheckerContext &amp;C,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                                     <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> numArgs,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> sizeArg,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">char</span> *fn)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">// Check for the correct number of arguments.</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordflow">if</span> (CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa439df008533164342c841a8a22dec1f">getNumArgs</a>() != numArgs)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">// Check if the allocation size is 0.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> trueState = <span class="keyword">nullptr</span>, falseState = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *<a class="code" href="namespacestd.html#abc7307bd3d6368059069bfe77bee0439">arg</a> = CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa454d6f1e76623da60451885239f63c6">getArg</a>(sizeArg);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  SVal argVal = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(<a class="code" href="namespacestd.html#abc7307bd3d6368059069bfe77bee0439">arg</a>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">if</span> (argVal.isUnknownOrUndef())</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="comment">// Is the value perfectly constrained to zero?</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="UnixAPIChecker_8cpp.html#a17cae85b3247d20de9bf6c1af4f708e7">IsZeroByteAllocation</a>(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>, argVal, &amp;trueState, &amp;falseState)) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    (void) ReportZeroByteAllocation(C, falseState, <a class="code" href="namespacestd.html#abc7307bd3d6368059069bfe77bee0439">arg</a>, fn);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// Assume the value is non-zero going forward.</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  assert(trueState);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">if</span> (trueState != <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(trueState);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;}</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keywordtype">void</span> UnixAPIPortabilityChecker::CheckCallocZero(CheckerContext &amp;C,</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                                <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nArgs = CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa439df008533164342c841a8a22dec1f">getNumArgs</a>();</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">if</span> (nArgs != 2)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> trueState = <span class="keyword">nullptr</span>, falseState = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; nArgs; i++) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *<a class="code" href="namespacestd.html#abc7307bd3d6368059069bfe77bee0439">arg</a> = CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa454d6f1e76623da60451885239f63c6">getArg</a>(i);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    SVal argVal = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(<a class="code" href="namespacestd.html#abc7307bd3d6368059069bfe77bee0439">arg</a>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">if</span> (argVal.isUnknownOrUndef()) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keywordflow">if</span> (i == 0)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="UnixAPIChecker_8cpp.html#a17cae85b3247d20de9bf6c1af4f708e7">IsZeroByteAllocation</a>(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>, argVal, &amp;trueState, &amp;falseState)) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">if</span> (ReportZeroByteAllocation(C, falseState, <a class="code" href="namespacestd.html#abc7307bd3d6368059069bfe77bee0439">arg</a>, <span class="stringliteral">&quot;calloc&quot;</span>))</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == 0)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">// Assume the value is non-zero going forward.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  assert(trueState);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">if</span> (trueState != <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(trueState);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;}</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keywordtype">void</span> UnixAPIPortabilityChecker::CheckMallocZero(CheckerContext &amp;C,</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                                <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  BasicAllocationCheck(C, CE, 1, 0, <span class="stringliteral">&quot;malloc&quot;</span>);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;}</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="keywordtype">void</span> UnixAPIPortabilityChecker::CheckReallocZero(CheckerContext &amp;C,</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                                 <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  BasicAllocationCheck(C, CE, 2, 1, <span class="stringliteral">&quot;realloc&quot;</span>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;}</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keywordtype">void</span> UnixAPIPortabilityChecker::CheckReallocfZero(CheckerContext &amp;C,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                                  <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  BasicAllocationCheck(C, CE, 2, 1, <span class="stringliteral">&quot;reallocf&quot;</span>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;}</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordtype">void</span> UnixAPIPortabilityChecker::CheckAllocaZero(CheckerContext &amp;C,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                                <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  BasicAllocationCheck(C, CE, 1, 0, <span class="stringliteral">&quot;alloca&quot;</span>);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;}</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keywordtype">void</span> UnixAPIPortabilityChecker::CheckAllocaWithAlignZero(</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                                     CheckerContext &amp;C,</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                                     <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  BasicAllocationCheck(C, CE, 2, 0, <span class="stringliteral">&quot;__builtin_alloca_with_align&quot;</span>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;}</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keywordtype">void</span> UnixAPIPortabilityChecker::CheckVallocZero(CheckerContext &amp;C,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                                <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  BasicAllocationCheck(C, CE, 1, 0, <span class="stringliteral">&quot;valloc&quot;</span>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keywordtype">void</span> UnixAPIPortabilityChecker::checkPreStmt(<span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                             CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *FD = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getCalleeDecl(CE);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">if</span> (!FD || FD-&gt;<a class="code" href="classclang_1_1Decl.html#aedd1ee920162f9a35e8d249a4926d9d5">getKind</a>() != Decl::Function)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="comment">// Don&#39;t treat functions in namespaces with the same name a Unix function</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">// as a call to the Unix function.</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1DeclContext.html">DeclContext</a> *NamespaceCtx = FD-&gt;<a class="code" href="classclang_1_1DeclContext.html#aa838660af381c6967722c6552580c2a2">getEnclosingNamespaceContext</a>();</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">if</span> (isa_and_nonnull&lt;NamespaceDecl&gt;(NamespaceCtx))</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  StringRef FName = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getCalleeName(FD);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">if</span> (FName.empty())</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;calloc&quot;</span>)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    CheckCallocZero(C, CE);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;malloc&quot;</span>)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    CheckMallocZero(C, CE);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;realloc&quot;</span>)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    CheckReallocZero(C, CE);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;reallocf&quot;</span>)</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    CheckReallocfZero(C, CE);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;alloca&quot;</span> || FName ==  <span class="stringliteral">&quot;__builtin_alloca&quot;</span>)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    CheckAllocaZero(C, CE);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;__builtin_alloca_with_align&quot;</span>)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    CheckAllocaWithAlignZero(C, CE);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;valloc&quot;</span>)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    CheckVallocZero(C, CE);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">// Registration.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="UnixAPIChecker_8cpp.html#ad332217bd6f63a03a7d51c4e7082f682">  501</a></span>&#160;<span class="preprocessor">#define REGISTER_CHECKER(CHECKERNAME)                                          \</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="preprocessor">  void ento::register##CHECKERNAME(CheckerManager &amp;mgr) {                      \</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">    mgr.registerChecker&lt;CHECKERNAME&gt;();                                        \</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="preprocessor">  }                                                                            \</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="preprocessor">                                                                               \</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="preprocessor">  bool ento::shouldRegister##CHECKERNAME(const CheckerManager &amp;mgr) {              \</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="preprocessor">    return true;                                                               \</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor">  }</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<a class="code" href="UnixAPIChecker_8cpp.html#ad332217bd6f63a03a7d51c4e7082f682">REGISTER_CHECKER</a>(UnixAPIMisuseChecker)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<a class="code" href="UnixAPIChecker_8cpp.html#ad332217bd6f63a03a7d51c4e7082f682">REGISTER_CHECKER</a>(UnixAPIPortabilityChecker)</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aUnixAPIChecker_8cpp_html_a32b38fe04abbe10e1de6b9af6b2b7919"><div class="ttname"><a href="UnixAPIChecker_8cpp.html#a32b38fe04abbe10e1de6b9af6b2b7919">LazyInitialize</a></div><div class="ttdeci">static void LazyInitialize(const CheckerBase *Checker, std::unique_ptr&lt; BugType &gt; &amp;BT, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="UnixAPIChecker_8cpp_source.html#l00092">UnixAPIChecker.cpp:92</a></div></div>
<div class="ttc" id="aUnixAPIChecker_8cpp_html_a541c929849428f58631407235a1aaac2"><div class="ttname"><a href="UnixAPIChecker_8cpp.html#a541c929849428f58631407235a1aaac2">OpenVariant</a></div><div class="ttdeci">OpenVariant</div><div class="ttdef"><b>Definition:</b> <a href="UnixAPIChecker_8cpp_source.html#l00029">UnixAPIChecker.cpp:29</a></div></div>
<div class="ttc" id="aclassclang_1_1SourceRange_html"><div class="ttname"><a href="classclang_1_1SourceRange.html">clang::SourceRange</a></div><div class="ttdoc">A trivial tuple used to represent a source range.</div><div class="ttdef"><b>Definition:</b> <a href="SourceLocation_8h_source.html#l00210">SourceLocation.h:210</a></div></div>
<div class="ttc" id="aclassclang_1_1DeclContext_html"><div class="ttname"><a href="classclang_1_1DeclContext.html">clang::DeclContext</a></div><div class="ttdoc">DeclContext - This is used only as base class of specific decl types that can act as declaration cont...</div><div class="ttdef"><b>Definition:</b> <a href="DeclBase_8h_source.html#l01355">DeclBase.h:1355</a></div></div>
<div class="ttc" id="aUnixAPIChecker_8cpp_html_a541c929849428f58631407235a1aaac2a95d1d829b95945407cd57e529fa5d98e"><div class="ttname"><a href="UnixAPIChecker_8cpp.html#a541c929849428f58631407235a1aaac2a95d1d829b95945407cd57e529fa5d98e">OpenVariant::OpenAt</a></div><div class="ttdeci">@ OpenAt</div><div class="ttdoc">The variant taking a directory file descriptor and a relative path: int openat(int fd,...</div></div>
<div class="ttc" id="ainclude_2clang_2Basic_2TargetInfo_8h_html"><div class="ttname"><a href="include_2clang_2Basic_2TargetInfo_8h.html">TargetInfo.h</a></div></div>
<div class="ttc" id="aclassclang_1_1Stmt_html_a6844392ee6148b5fe821f211b95e5d1b"><div class="ttname"><a href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">clang::Stmt::getSourceRange</a></div><div class="ttdeci">SourceRange getSourceRange() const LLVM_READONLY</div><div class="ttdoc">SourceLocation tokens are not useful in isolation - they are low level value objects created/interpre...</div><div class="ttdef"><b>Definition:</b> <a href="Stmt_8cpp_source.html#l00324">Stmt.cpp:324</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_a4e45a121820f0d80d8910093dd33a1df"><div class="ttname"><a href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">clang::ento::ProgramStateRef</a></div><div class="ttdeci">IntrusiveRefCntPtr&lt; const ProgramState &gt; ProgramStateRef</div><div class="ttdef"><b>Definition:</b> <a href="ProgramState__Fwd_8h_source.html#l00037">ProgramState_Fwd.h:37</a></div></div>
<div class="ttc" id="aclassclang_1_1QualType_html"><div class="ttname"><a href="classclang_1_1QualType.html">clang::QualType</a></div><div class="ttdoc">A (possibly-)qualified type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00675">Type.h:675</a></div></div>
<div class="ttc" id="anamespaceAttributeLangSupport_html_a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e"><div class="ttname"><a href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">AttributeLangSupport::C</a></div><div class="ttdeci">@ C</div><div class="ttdef"><b>Definition:</b> <a href="SemaDeclAttr_8cpp_source.html#l00054">SemaDeclAttr.cpp:54</a></div></div>
<div class="ttc" id="aUnixAPIChecker_8cpp_html_a541c929849428f58631407235a1aaac2ac3bf447eabe632720a3aa1a7ce401274"><div class="ttname"><a href="UnixAPIChecker_8cpp.html#a541c929849428f58631407235a1aaac2ac3bf447eabe632720a3aa1a7ce401274">OpenVariant::Open</a></div><div class="ttdeci">@ Open</div><div class="ttdoc">The standard open() call: int open(const char *path, int oflag, ...);.</div></div>
<div class="ttc" id="aclassllvm_1_1Optional_html"><div class="ttname"><a href="classllvm_1_1Optional.html">llvm::Optional&lt; uint64_t &gt;</a></div></div>
<div class="ttc" id="aUnixAPIChecker_8cpp_html_ad332217bd6f63a03a7d51c4e7082f682"><div class="ttname"><a href="UnixAPIChecker_8cpp.html#ad332217bd6f63a03a7d51c4e7082f682">REGISTER_CHECKER</a></div><div class="ttdeci">#define REGISTER_CHECKER(CHECKERNAME)</div><div class="ttdef"><b>Definition:</b> <a href="UnixAPIChecker_8cpp_source.html#l00501">UnixAPIChecker.cpp:501</a></div></div>
<div class="ttc" id="aASTContext_8h_html_ab1457e11becd51c5d0c750caab5446c2"><div class="ttname"><a href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a></div><div class="ttdeci">#define V(N, I)</div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8h_source.html#l03167">ASTContext.h:3167</a></div></div>
<div class="ttc" id="aUnixAPIChecker_8cpp_html_a17cae85b3247d20de9bf6c1af4f708e7"><div class="ttname"><a href="UnixAPIChecker_8cpp.html#a17cae85b3247d20de9bf6c1af4f708e7">IsZeroByteAllocation</a></div><div class="ttdeci">static bool IsZeroByteAllocation(ProgramStateRef state, const SVal argVal, ProgramStateRef *trueState, ProgramStateRef *falseState)</div><div class="ttdef"><b>Definition:</b> <a href="UnixAPIChecker_8cpp_source.html#l00323">UnixAPIChecker.cpp:323</a></div></div>
<div class="ttc" id="aBuiltinCheckerRegistration_8h_html"><div class="ttname"><a href="BuiltinCheckerRegistration_8h.html">BuiltinCheckerRegistration.h</a></div></div>
<div class="ttc" id="aclassclang_1_1Decl_html_aedd1ee920162f9a35e8d249a4926d9d5"><div class="ttname"><a href="classclang_1_1Decl.html#aedd1ee920162f9a35e8d249a4926d9d5">clang::Decl::getKind</a></div><div class="ttdeci">Kind getKind() const</div><div class="ttdef"><b>Definition:</b> <a href="DeclBase_8h_source.html#l00427">DeclBase.h:427</a></div></div>
<div class="ttc" id="aclassclang_1_1DeclContext_html_aa838660af381c6967722c6552580c2a2"><div class="ttname"><a href="classclang_1_1DeclContext.html#aa838660af381c6967722c6552580c2a2">clang::DeclContext::getEnclosingNamespaceContext</a></div><div class="ttdeci">DeclContext * getEnclosingNamespaceContext()</div><div class="ttdoc">Retrieve the nearest enclosing namespace context.</div><div class="ttdef"><b>Definition:</b> <a href="DeclBase_8cpp_source.html#l01810">DeclBase.cpp:1810</a></div></div>
<div class="ttc" id="aCheckerManager_8h_html"><div class="ttname"><a href="CheckerManager_8h.html">CheckerManager.h</a></div></div>
<div class="ttc" id="aclassclang_1_1CallExpr_html_aa454d6f1e76623da60451885239f63c6"><div class="ttname"><a href="classclang_1_1CallExpr.html#aa454d6f1e76623da60451885239f63c6">clang::CallExpr::getArg</a></div><div class="ttdeci">Expr * getArg(unsigned Arg)</div><div class="ttdoc">getArg - Return the specified argument.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l03044">Expr.h:3044</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallString_html"><div class="ttname"><a href="classllvm_1_1SmallString.html">llvm::SmallString</a></div><div class="ttdef"><b>Definition:</b> <a href="LLVM_8h_source.html#l00037">LLVM.h:37</a></div></div>
<div class="ttc" id="aStaticAnalyzer_2README_8txt_html_a1a264b3e48bda8ea3bed83698db8dca7"><div class="ttname"><a href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a></div><div class="ttdeci">and static some checkers Checker The latter are built on top of the former via the Checker and CheckerVisitor and attempts to isolate them from much of the gore of the internal analysis the analyzer is basically a source code simulator that traces out possible paths of execution The state of the and the combination of state and program point is a node in an exploded which has the entry program point and initial state</div><div class="ttdef"><b>Definition:</b> <a href="StaticAnalyzer_2README_8txt_source.html#l00030">README.txt:30</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_1_1bugreporter_html_a9f4acbc86c4e8c0a8601b7e7e42814c9"><div class="ttname"><a href="namespaceclang_1_1ento_1_1bugreporter.html#a9f4acbc86c4e8c0a8601b7e7e42814c9">clang::ento::bugreporter::trackExpressionValue</a></div><div class="ttdeci">bool trackExpressionValue(const ExplodedNode *N, const Expr *E, PathSensitiveBugReport &amp;R, TrackingOptions Opts={})</div><div class="ttdoc">Attempts to add visitors to track expression value back to its point of origin.</div></div>
<div class="ttc" id="aBugType_8h_html"><div class="ttname"><a href="BugType_8h.html">BugType.h</a></div></div>
<div class="ttc" id="aclassclang_1_1CallExpr_html_aa439df008533164342c841a8a22dec1f"><div class="ttname"><a href="classclang_1_1CallExpr.html#aa439df008533164342c841a8a22dec1f">clang::CallExpr::getNumArgs</a></div><div class="ttdeci">unsigned getNumArgs() const</div><div class="ttdoc">getNumArgs - Return the number of actual arguments to this call.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l03031">Expr.h:3031</a></div></div>
<div class="ttc" id="aUnwrappedLineFormatter_8cpp_html_a83e9e4ff6cb05dbdf72ab2a01aa289c0"><div class="ttname"><a href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a></div><div class="ttdeci">LineState State</div><div class="ttdef"><b>Definition:</b> <a href="UnwrappedLineFormatter_8cpp_source.html#l01083">UnwrappedLineFormatter.cpp:1083</a></div></div>
<div class="ttc" id="aCheckerContext_8h_html"><div class="ttname"><a href="CheckerContext_8h.html">CheckerContext.h</a></div></div>
<div class="ttc" id="aChecker_8h_html"><div class="ttname"><a href="Checker_8h.html">Checker.h</a></div></div>
<div class="ttc" id="anamespaceclang_html"><div class="ttname"><a href="namespaceclang.html">clang</a></div><div class="ttdef"><b>Definition:</b> <a href="CalledOnceCheck_8h_source.html#l00017">CalledOnceCheck.h:17</a></div></div>
<div class="ttc" id="anamespacestd_html_abc7307bd3d6368059069bfe77bee0439"><div class="ttname"><a href="namespacestd.html#abc7307bd3d6368059069bfe77bee0439">std::arg</a></div><div class="ttdeci">__DEVICE__ _Tp arg(const std::complex&lt; _Tp &gt; &amp;__c)</div><div class="ttdef"><b>Definition:</b> <a href="complex__cmath_8h_source.html#l00040">complex_cmath.h:40</a></div></div>
<div class="ttc" id="aclassclang_1_1Expr_html_ac9bfcc699442f2093723cfcf703d9f47"><div class="ttname"><a href="classclang_1_1Expr.html#ac9bfcc699442f2093723cfcf703d9f47">clang::Expr::getType</a></div><div class="ttdeci">QualType getType() const</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l00141">Expr.h:141</a></div></div>
<div class="ttc" id="aclassclang_1_1Type_html_a3b8d0cdfe0bdd8b98296b84ae9d438c5"><div class="ttname"><a href="classclang_1_1Type.html#a3b8d0cdfe0bdd8b98296b84ae9d438c5">clang::Type::isIntegerType</a></div><div class="ttdeci">bool isIntegerType() const</div><div class="ttdoc">isIntegerType() does not include complex integers (a GCC extension).</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l07089">Type.h:7089</a></div></div>
<div class="ttc" id="aclassclang_1_1Expr_html"><div class="ttname"><a href="classclang_1_1Expr.html">clang::Expr</a></div><div class="ttdoc">This represents one expression.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l00109">Expr.h:109</a></div></div>
<div class="ttc" id="anamespaceclang_1_1transformer_html_afb9ae3f6ff9907205cd12c218f76df7e"><div class="ttname"><a href="namespaceclang_1_1transformer.html#afb9ae3f6ff9907205cd12c218f76df7e">clang::transformer::name</a></div><div class="ttdeci">RangeSelector name(std::string ID)</div><div class="ttdoc">Given a node with a &quot;name&quot;, (like NamedDecl, DeclRefExpr, CxxCtorInitializer, and TypeLoc) selects th...</div><div class="ttdef"><b>Definition:</b> <a href="RangeSelector_8cpp_source.html#l00200">RangeSelector.cpp:200</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_1_1categories_html_a54df5af5f5165c3ce2daf6c8ebdfc64d"><div class="ttname"><a href="namespaceclang_1_1ento_1_1categories.html#a54df5af5f5165c3ce2daf6c8ebdfc64d">clang::ento::categories::UnixAPI</a></div><div class="ttdeci">const char *const UnixAPI</div><div class="ttdef"><b>Definition:</b> <a href="CommonBugCategories_8cpp_source.html#l00021">CommonBugCategories.cpp:21</a></div></div>
<div class="ttc" id="aclassclang_1_1FunctionDecl_html"><div class="ttname"><a href="classclang_1_1FunctionDecl.html">clang::FunctionDecl</a></div><div class="ttdoc">Represents a function declaration or definition.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l01856">Decl.h:1856</a></div></div>
<div class="ttc" id="aclassclang_1_1CallExpr_html"><div class="ttname"><a href="classclang_1_1CallExpr.html">clang::CallExpr</a></div><div class="ttdoc">CallExpr - Represents a function call (C99 6.5.2.2, C++ [expr.call]).</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l02853">Expr.h:2853</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924"><div class="ttname"><a href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">clang::ento::ObjKind::OS</a></div><div class="ttdeci">@ OS</div><div class="ttdoc">Indicates that the tracking object is a descendant of a referenced-counted OSObject,...</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 4 2022 01:35:53 for clang by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
