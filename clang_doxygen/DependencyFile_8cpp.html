<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>clang: lib/Frontend/DependencyFile.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">clang
   &#160;<span id="projectnumber">19.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_852f2fa92acda3856ce29eb983aeba4a.html">Frontend</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">DependencyFile.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="Frontend_2Utils_8h_source.html">clang/Frontend/Utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="FileManager_8h_source.html">clang/Basic/FileManager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="SourceManager_8h_source.html">clang/Basic/SourceManager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="DependencyOutputOptions_8h_source.html">clang/Frontend/DependencyOutputOptions.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="FrontendDiagnostic_8h_source.html">clang/Frontend/FrontendDiagnostic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="DirectoryLookup_8h_source.html">clang/Lex/DirectoryLookup.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ModuleMap_8h_source.html">clang/Lex/ModuleMap.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="PPCallbacks_8h_source.html">clang/Lex/PPCallbacks.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Preprocessor_8h_source.html">clang/Lex/Preprocessor.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ASTReader_8h_source.html">clang/Serialization/ASTReader.h</a>&quot;</code><br />
<code>#include &quot;llvm/ADT/StringSet.h&quot;</code><br />
<code>#include &quot;llvm/Support/FileSystem.h&quot;</code><br />
<code>#include &quot;llvm/Support/Path.h&quot;</code><br />
<code>#include &quot;llvm/Support/raw_ostream.h&quot;</code><br />
<code>#include &lt;optional&gt;</code><br />
</div>
<p><a href="DependencyFile_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab0f45ae39092d13c3708d99ea74f31e1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="stdbool_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="DependencyFile_8cpp.html#ab0f45ae39092d13c3708d99ea74f31e1">isSpecialFilename</a> (StringRef <a class="el" href="ClangSrcLocDump_8cpp.html#a637a6651de5d8f7041e8e604929b1e94">Filename</a>)</td></tr>
<tr class="separator:ab0f45ae39092d13c3708d99ea74f31e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47519a43277e42b114b90fbc8c84d04b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="DependencyFile_8cpp.html#a47519a43277e42b114b90fbc8c84d04b">PrintFilename</a> (raw_ostream &amp;<a class="el" href="Logger_8cpp.html#aa3842cd12d37e04cf1635d916f15ea56">OS</a>, StringRef <a class="el" href="ClangSrcLocDump_8cpp.html#a637a6651de5d8f7041e8e604929b1e94">Filename</a>, <a class="el" href="namespaceclang.html#ab75100cbce74a3f224dbfe8e088c3211">DependencyOutputFormat</a> OutputFormat)</td></tr>
<tr class="memdesc:a47519a43277e42b114b90fbc8c84d04b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the filename, with escaping or quoting that accommodates the three most likely tools that use dependency files: GNU Make, BSD Make, and NMake/Jom.  <a href="DependencyFile_8cpp.html#a47519a43277e42b114b90fbc8c84d04b">More...</a><br /></td></tr>
<tr class="separator:a47519a43277e42b114b90fbc8c84d04b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab0f45ae39092d13c3708d99ea74f31e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0f45ae39092d13c3708d99ea74f31e1">&#9670;&nbsp;</a></span>isSpecialFilename()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="stdbool_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> isSpecialFilename </td>
          <td>(</td>
          <td class="paramtype">StringRef&#160;</td>
          <td class="paramname"><em>Filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="DependencyFile_8cpp_source.html#l00172">172</a> of file <a class="el" href="DependencyFile_8cpp_source.html">DependencyFile.cpp</a>.</p>

<p class="reference">References <a class="el" href="Format_8cpp_source.html#l02972">Filename</a>.</p>

<p class="reference">Referenced by <a class="el" href="DependencyFile_8cpp_source.html#l00176">clang::DependencyCollector::sawDependency()</a>, and <a class="el" href="DependencyFile_8cpp_source.html#l00217">clang::DependencyFileGenerator::sawDependency()</a>.</p>

</div>
</div>
<a id="a47519a43277e42b114b90fbc8c84d04b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47519a43277e42b114b90fbc8c84d04b">&#9670;&nbsp;</a></span>PrintFilename()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void PrintFilename </td>
          <td>(</td>
          <td class="paramtype">raw_ostream &amp;&#160;</td>
          <td class="paramname"><em>OS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StringRef&#160;</td>
          <td class="paramname"><em>Filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceclang.html#ab75100cbce74a3f224dbfe8e088c3211">DependencyOutputFormat</a>&#160;</td>
          <td class="paramname"><em>OutputFormat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Print the filename, with escaping or quoting that accommodates the three most likely tools that use dependency files: GNU Make, BSD Make, and NMake/Jom. </p>
<p>BSD Make is the simplest case: It does no escaping at all. This means characters that are normally delimiters, i.e. space and # (the comment character) simply aren't supported in filenames.</p>
<p>GNU Make does allow space and # in filenames, but to avoid being treated as a delimiter or comment, these must be escaped with a backslash. Because backslash is itself the escape character, if a backslash appears in a filename, it should be escaped as well. (As a special case, $ is escaped as $$, which is the normal Make way to handle the $ character.) For compatibility with BSD Make and historical practice, if GNU Make un-escapes characters in a filename but doesn't find a match, it will retry with the unmodified original string.</p>
<p>GCC tries to accommodate both Make formats by escaping any space or # characters in the original filename, but not escaping backslashes. The apparent intent is so that filenames with backslashes will be handled correctly by BSD Make, and by GNU Make in its fallback mode of using the unmodified original string; filenames with # or space characters aren't supported by BSD Make at all, but will be handled correctly by GNU Make due to the escaping.</p>
<p>A corner case that GCC gets only partly right is when the original filename has a backslash immediately followed by space or #. GNU Make would expect this backslash to be escaped; however GCC escapes the original backslash only when followed by space, not #. It will therefore take a dependency from a directive such as #include "a\ b\#c.h" and emit it as a\\ b\#c.h which GNU Make will interpret as a\ b\ followed by a comment. Failing to find this file, it will fall back to the original string, which probably doesn't exist either; in any case it won't find a\ b#c.h which is the actual filename specified by the include directive.</p>
<p>Clang does what GCC does, rather than what GNU Make expects.</p>
<p>NMake/Jom has a different set of scary characters, but wraps filespecs in double-quotes to avoid misinterpreting them; see <a href="https://msdn.microsoft.com/en-us/library/dd9y37ha.aspx">https://msdn.microsoft.com/en-us/library/dd9y37ha.aspx</a> for NMake info, <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa365247(v=vs.85).aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/aa365247(v=vs.85).aspx</a> for Windows file-naming info. </p>

<p class="definition">Definition at line <a class="el" href="DependencyFile_8cpp_source.html#l00297">297</a> of file <a class="el" href="DependencyFile_8cpp_source.html">DependencyFile.cpp</a>.</p>

<p class="reference">References <a class="el" href="Format_8cpp_source.html#l02972">Filename</a>, <a class="el" href="namespaceclang.html#ab75100cbce74a3f224dbfe8e088c3211a529a05ca6c1263aab080ec4f20754411">clang::Make</a>, and <a class="el" href="namespaceclang.html#ab75100cbce74a3f224dbfe8e088c3211a351632bebf8c206f3e8e06684754798f">clang::NMake</a>.</p>

<p class="reference">Referenced by <a class="el" href="DependencyFile_8cpp_source.html#l00344">clang::DependencyFileGenerator::outputDependencyFile()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 3 2024 01:35:27 for clang by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
