<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>clang: lib/StaticAnalyzer/Checkers/MallocChecker.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">clang
   &#160;<span id="projectnumber">15.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_5323669f7aaa7f9ff43db9a3c9e1bf2d.html">StaticAnalyzer</a></li><li class="navelem"><a class="el" href="dir_98a0d9a5a3820cce728a787f3e823141.html">Checkers</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MallocChecker.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="MallocChecker_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//=== MallocChecker.cpp - A malloc/free checker -------------------*- C++ -*--//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This file defines a variety of memory management related checkers, such as</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// leak, double free, and use-after-free.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// The following checkers are defined here:</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//   * MallocChecker</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//       Despite its name, it models all sorts of memory allocations and</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//       de- or reallocation, including but not limited to malloc, free,</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//       relloc, new, delete. It also reports on a variety of memory misuse</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//       errors.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//       Many other checkers interact very closely with this checker, in fact,</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//       most are merely options to this one. Other checkers may register</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//       MallocChecker, but do not enable MallocChecker&#39;s reports (more details</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//       to follow around its field, ChecksEnabled).</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//       It also has a boolean &quot;Optimistic&quot; checker option, which if set to true</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//       will cause the checker to model user defined memory management related</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//       functions annotated via the attribute ownership_takes, ownership_holds</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//       and ownership_returns.</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//   * NewDeleteChecker</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//       Enables the modeling of new, new[], delete, delete[] in MallocChecker,</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//       and checks for related double-free and use-after-free errors.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//   * NewDeleteLeaksChecker</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//       Checks for leaks related to new, new[], delete, delete[].</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//       Depends on NewDeleteChecker.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//   * MismatchedDeallocatorChecker</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//       Enables checking whether memory is deallocated with the correspending</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//       allocation function in MallocChecker, such as malloc() allocated</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//       regions are only freed by free(), new by delete, new[] by delete[].</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//  InnerPointerChecker interacts very closely with MallocChecker, but unlike</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//  the above checkers, it has it&#39;s own file, hence the many InnerPointerChecker</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//  related headers and non-static functions.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AllocationState_8h.html">AllocationState.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InterCheckerAPI_8h.html">InterCheckerAPI.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Attr_8h.html">clang/AST/Attr.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DeclCXX_8h.html">clang/AST/DeclCXX.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DeclTemplate_8h.html">clang/AST/DeclTemplate.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Expr_8h.html">clang/AST/Expr.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ExprCXX_8h.html">clang/AST/ExprCXX.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ParentMap_8h.html">clang/AST/ParentMap.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ASTMatchFinder_8h.html">clang/ASTMatchers/ASTMatchFinder.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ASTMatchers_8h.html">clang/ASTMatchers/ASTMatchers.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProgramPoint_8h.html">clang/Analysis/ProgramPoint.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LLVM_8h.html">clang/Basic/LLVM.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SourceManager_8h.html">clang/Basic/SourceManager.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="include_2clang_2Basic_2TargetInfo_8h.html">clang/Basic/TargetInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Lexer_8h.html">clang/Lex/Lexer.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BuiltinCheckerRegistration_8h.html">clang/StaticAnalyzer/Checkers/BuiltinCheckerRegistration.h</a>&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BugType_8h.html">clang/StaticAnalyzer/Core/BugReporter/BugType.h</a>&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommonBugCategories_8h.html">clang/StaticAnalyzer/Core/BugReporter/CommonBugCategories.h</a>&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Checker_8h.html">clang/StaticAnalyzer/Core/Checker.h</a>&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CheckerManager_8h.html">clang/StaticAnalyzer/Core/CheckerManager.h</a>&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallDescription_8h.html">clang/StaticAnalyzer/Core/PathSensitive/CallDescription.h</a>&quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallEvent_8h.html">clang/StaticAnalyzer/Core/PathSensitive/CallEvent.h</a>&quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CheckerContext_8h.html">clang/StaticAnalyzer/Core/PathSensitive/CheckerContext.h</a>&quot;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CheckerHelpers_8h.html">clang/StaticAnalyzer/Core/PathSensitive/CheckerHelpers.h</a>&quot;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DynamicExtent_8h.html">clang/StaticAnalyzer/Core/PathSensitive/DynamicExtent.h</a>&quot;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ExplodedGraph_8h.html">clang/StaticAnalyzer/Core/PathSensitive/ExplodedGraph.h</a>&quot;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProgramState_8h.html">clang/StaticAnalyzer/Core/PathSensitive/ProgramState.h</a>&quot;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProgramStateTrait_8h.html">clang/StaticAnalyzer/Core/PathSensitive/ProgramStateTrait.h</a>&quot;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProgramState__Fwd_8h.html">clang/StaticAnalyzer/Core/PathSensitive/ProgramState_Fwd.h</a>&quot;</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SVals_8h.html">clang/StaticAnalyzer/Core/PathSensitive/SVals.h</a>&quot;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StoreRef_8h.html">clang/StaticAnalyzer/Core/PathSensitive/StoreRef.h</a>&quot;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SymbolManager_8h.html">clang/StaticAnalyzer/Core/PathSensitive/SymbolManager.h</a>&quot;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &quot;llvm/ADT/STLExtras.h&quot;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#include &quot;llvm/ADT/SetOperations.h&quot;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#include &quot;llvm/ADT/SmallString.h&quot;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#include &quot;llvm/ADT/StringExtras.h&quot;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &quot;llvm/Support/Casting.h&quot;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &quot;llvm/Support/Compiler.h&quot;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include &quot;llvm/Support/ErrorHandling.h&quot;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#include &quot;llvm/Support/raw_ostream.h&quot;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &lt;climits&gt;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceclang.html">clang</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keyword">using namespace </span>ento;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">using namespace </span>std::placeholders;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">// The types of allocation we&#39;re modeling. This is used to check whether a</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">// dynamically allocated object is deallocated with the correct function, like</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">// not using operator delete on an object created by malloc(), or alloca regions</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">// aren&#39;t ever deallocated manually.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">// Used to check correspondence between allocators and deallocators.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keyword">enum</span> AllocationFamily {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  AF_None,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  AF_Malloc,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  AF_CXXNew,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  AF_CXXNewArray,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  AF_IfNameIndex,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  AF_Alloca,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  AF_InnerBuffer</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;};</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;} <span class="comment">// end of anonymous namespace</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">/// Print names of allocators and deallocators.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">/// \returns true on success.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#ad2cfc698611276d3cd573c5a52a2fd84">printMemFnName</a>(raw_ostream &amp;os, CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *E);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">/// Print expected name of an allocator based on the deallocator&#39;s family</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">/// derived from the DeallocExpr.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="MallocChecker_8cpp.html#a2aaae9c4c3f7405c8d3f21ea8d34722d">printExpectedAllocName</a>(raw_ostream &amp;os, AllocationFamily Family);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">/// Print expected name of a deallocator based on the allocator&#39;s</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">/// family.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="MallocChecker_8cpp.html#aa60484f1d307e45c137f948c0d0976ae">printExpectedDeallocName</a>(raw_ostream &amp;os, AllocationFamily Family);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">// The state of a symbol, in terms of memory management.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keyword">class </span>RefState {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keyword">enum</span> <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// Reference to allocated memory.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    Allocated,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// Reference to zero-allocated memory.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    AllocatedOfSizeZero,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// Reference to released/freed memory.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    Released,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// The responsibility for freeing resources has transferred from</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// this reference. A relinquished symbol should not be freed.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    Relinquished,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// We are no longer guaranteed to have observed all manipulations</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// of this pointer/memory. For example, it could have been</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// passed as a parameter to an opaque function.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    Escaped</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  };</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *S;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> K;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  AllocationFamily Family;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  RefState(<a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> k, <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *<a class="code" href="____clang__hip__libdevice__declares_8h.html#aeec2d21816235dac201bf39185a3e86f">s</a>, AllocationFamily family)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      : S(<a class="code" href="____clang__hip__libdevice__declares_8h.html#aeec2d21816235dac201bf39185a3e86f">s</a>), K(k), Family(family) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    assert(family != AF_None);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordtype">bool</span> isAllocated()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> K == Allocated; }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordtype">bool</span> isAllocatedOfSizeZero()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> K == AllocatedOfSizeZero; }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#a2a7903a04bcc80b227a601bafdf4d128">isReleased</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> K == Released; }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordtype">bool</span> isRelinquished()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> K == Relinquished; }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordtype">bool</span> isEscaped()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> K == Escaped; }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  AllocationFamily getAllocationFamily()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Family; }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *getStmt()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> S; }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespaceclang.html#a4a57f21b55a81cefae4379e09a3be0c3">operator==</a>(<span class="keyword">const</span> RefState &amp;<a class="code" href="namespaceclang_1_1tooling.html#a4ffee664435dba78b2225a5457619b53">X</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">return</span> K == <a class="code" href="namespaceclang_1_1tooling.html#a4ffee664435dba78b2225a5457619b53">X</a>.K &amp;&amp; S == <a class="code" href="namespaceclang_1_1tooling.html#a4ffee664435dba78b2225a5457619b53">X</a>.S &amp;&amp; Family == <a class="code" href="namespaceclang_1_1tooling.html#a4ffee664435dba78b2225a5457619b53">X</a>.Family;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keyword">static</span> RefState getAllocated(AllocationFamily family, <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *<a class="code" href="____clang__hip__libdevice__declares_8h.html#aeec2d21816235dac201bf39185a3e86f">s</a>) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">return</span> RefState(Allocated, <a class="code" href="____clang__hip__libdevice__declares_8h.html#aeec2d21816235dac201bf39185a3e86f">s</a>, family);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keyword">static</span> RefState getAllocatedOfSizeZero(<span class="keyword">const</span> RefState *RS) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> RefState(AllocatedOfSizeZero, RS-&gt;getStmt(),</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    RS-&gt;getAllocationFamily());</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keyword">static</span> RefState getReleased(AllocationFamily family, <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *<a class="code" href="____clang__hip__libdevice__declares_8h.html#aeec2d21816235dac201bf39185a3e86f">s</a>) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">return</span> RefState(Released, <a class="code" href="____clang__hip__libdevice__declares_8h.html#aeec2d21816235dac201bf39185a3e86f">s</a>, family);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keyword">static</span> RefState getRelinquished(AllocationFamily family, <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *<a class="code" href="____clang__hip__libdevice__declares_8h.html#aeec2d21816235dac201bf39185a3e86f">s</a>) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">return</span> RefState(Relinquished, <a class="code" href="____clang__hip__libdevice__declares_8h.html#aeec2d21816235dac201bf39185a3e86f">s</a>, family);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keyword">static</span> RefState getEscaped(<span class="keyword">const</span> RefState *RS) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">return</span> RefState(Escaped, RS-&gt;getStmt(), RS-&gt;getAllocationFamily());</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordtype">void</span> Profile(llvm::FoldingSetNodeID &amp;<a class="code" href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">ID</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">ID</a>.AddInteger(K);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">ID</a>.AddPointer(S);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">ID</a>.AddInteger(Family);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  LLVM_DUMP_METHOD <span class="keywordtype">void</span> <a class="code" href="CoverageMappingGen_8cpp.html#aac83d992338dc387528380660998fb50">dump</a>(raw_ostream &amp;OS)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">switch</span> (K) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">#define CASE(ID) case ID: OS &lt;&lt; #ID; break;</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="MallocChecker_8cpp.html#a905832cd068cea677d3bad102375a557">CASE</a>(Allocated)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="MallocChecker_8cpp.html#a905832cd068cea677d3bad102375a557">CASE</a>(AllocatedOfSizeZero)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="MallocChecker_8cpp.html#a905832cd068cea677d3bad102375a557">CASE</a>(Released)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="MallocChecker_8cpp.html#a905832cd068cea677d3bad102375a557">CASE</a>(Relinquished)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="MallocChecker_8cpp.html#a905832cd068cea677d3bad102375a557">CASE</a>(Escaped)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  LLVM_DUMP_METHOD <span class="keywordtype">void</span> <a class="code" href="CoverageMappingGen_8cpp.html#aac83d992338dc387528380660998fb50">dump</a>()<span class="keyword"> const </span>{ <a class="code" href="CoverageMappingGen_8cpp.html#aac83d992338dc387528380660998fb50">dump</a>(llvm::errs()); }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;};</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;} <span class="comment">// end of anonymous namespace</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<a class="code" href="ProgramStateTrait_8h.html#a6d1893bb8c18543337b6c363c1319fcf">REGISTER_MAP_WITH_PROGRAMSTATE</a>(RegionState, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a>, RefState)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">/// Check if the memory associated with this symbol was released.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#a2a7903a04bcc80b227a601bafdf4d128">isReleased</a>(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, CheckerContext &amp;C);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">/// Update the RefState to reflect the new memory allocation.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">/// The optional \p RetVal parameter specifies the newly allocated pointer</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">/// value; if unspecified, the value of expression \p E is used.</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="MallocChecker_8cpp.html#a923124dcac9f30d5c9d80541135f5d1e">MallocUpdateRefState</a>(CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *E,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                            <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                            AllocationFamily Family,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                            <a class="code" href="classllvm_1_1Optional.html">Optional&lt;SVal&gt;</a> RetVal = None);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">// The modeling of memory reallocation.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">// The terminology &#39;toPtr&#39; and &#39;fromPtr&#39; will be used:</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">//   toPtr = realloc(fromPtr, 20);</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<a class="code" href="ProgramStateTrait_8h.html#ad90f9387b94b344eaaf499afec05f4d1">REGISTER_SET_WITH_PROGRAMSTATE</a>(ReallocSizeZeroSymbols, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a>)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">/// The state of &#39;fromPtr&#39; after reallocation is known to have failed.</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span><span class="keyword">enum</span> OwnershipAfterReallocKind {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// The symbol needs to be freed (e.g.: realloc)</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  OAR_ToBeFreedAfterFailure,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">// The symbol has been freed (e.g.: reallocf)</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  OAR_FreeOnFailure,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// The symbol doesn&#39;t have to freed (e.g.: we aren&#39;t sure if, how and where</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// &#39;fromPtr&#39; was allocated:</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="comment">//    void Haha(int *ptr) {</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">//      ptr = realloc(ptr, 67);</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">//      // ...</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">//    }</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// ).</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  OAR_DoNotTrackAfterFailure</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;};</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">/// Stores information about the &#39;fromPtr&#39; symbol after reallocation.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">/// This is important because realloc may fail, and that needs special modeling.</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">/// Whether reallocation failed or not will not be known until later, so we&#39;ll</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">/// store whether upon failure &#39;fromPtr&#39; will be freed, or needs to be freed</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">/// later, etc.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span><span class="keyword">struct </span>ReallocPair {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">// The &#39;fromPtr&#39;.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> ReallocatedSym;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  OwnershipAfterReallocKind <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  ReallocPair(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> S, OwnershipAfterReallocKind K)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      : ReallocatedSym(S), <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>(K) {}</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordtype">void</span> Profile(llvm::FoldingSetNodeID &amp;<a class="code" href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">ID</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">ID</a>.AddInteger(<a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">ID</a>.AddPointer(ReallocatedSym);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespaceclang.html#a4a57f21b55a81cefae4379e09a3be0c3">operator==</a>(<span class="keyword">const</span> ReallocPair &amp;<a class="code" href="namespaceclang_1_1tooling.html#a4ffee664435dba78b2225a5457619b53">X</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">return</span> ReallocatedSym == <a class="code" href="namespaceclang_1_1tooling.html#a4ffee664435dba78b2225a5457619b53">X</a>.ReallocatedSym &amp;&amp;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;           <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> == <a class="code" href="namespaceclang_1_1tooling.html#a4ffee664435dba78b2225a5457619b53">X</a>.Kind;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;};</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;} <span class="comment">// end of anonymous namespace</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<a class="code" href="ProgramStateTrait_8h.html#a6d1893bb8c18543337b6c363c1319fcf">REGISTER_MAP_WITH_PROGRAMSTATE</a>(ReallocPairs, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a>, ReallocPair)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">/// Tells if the callee is one of the builtin new/delete operators, including</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"></span><span class="comment">/// placement operators and other standard overloads.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#ae6533c7f9026cf098295dadb134506d7">isStandardNewDelete</a>(<span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *FD);</div>
<div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#a1696bc402fc9ff2dd1215990260c12ea">  286</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#ae6533c7f9026cf098295dadb134506d7">isStandardNewDelete</a>(<span class="keyword">const</span> CallEvent &amp;Call) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">if</span> (!Call.getDecl() || !isa&lt;FunctionDecl&gt;(Call.getDecl()))</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="MallocChecker_8cpp.html#ae6533c7f9026cf098295dadb134506d7">isStandardNewDelete</a>(cast&lt;FunctionDecl&gt;(Call.getDecl()));</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">// Definition of the MallocChecker class.</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keyword">class </span>MallocChecker</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    : <span class="keyword">public</span> Checker&lt;check::DeadSymbols, check::PointerEscape,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                     check::ConstPointerEscape, check::PreStmt&lt;ReturnStmt&gt;,</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                     check::EndFunction, check::PreCall, check::PostCall,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                     check::NewAllocator, check::PostStmt&lt;BlockExpr&gt;,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                     check::PostObjCMessage, check::Location, eval::Assume&gt; {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">  /// In pessimistic mode, the checker assumes that it does not know which</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">  /// functions might free the memory.</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">  /// In optimistic mode, the checker assumes that all user-defined functions</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">  /// which might free a pointer are annotated.</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"></span>  DefaultBool ShouldIncludeOwnershipAnnotatedFunctions;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  DefaultBool ShouldRegisterNoOwnershipChangeVisitor;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">  /// Many checkers are essentially built into this one, so enabling them will</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">  /// make MallocChecker perform additional modeling and reporting.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span>  <span class="keyword">enum</span> CheckKind {<span class="comment"></span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">    /// When a subchecker is enabled but MallocChecker isn&#39;t, model memory</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">    /// management but do not emit warnings emitted with MallocChecker only</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">    /// enabled.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span>    CK_MallocChecker,</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    CK_NewDeleteChecker,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    CK_NewDeleteLeaksChecker,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    CK_MismatchedDeallocatorChecker,</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    CK_InnerPointerChecker,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    CK_NumCheckKinds</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  };</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keyword">using</span> LeakInfo = std::pair&lt;const ExplodedNode *, const MemRegion *&gt;;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  DefaultBool ChecksEnabled[CK_NumCheckKinds];</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  CheckerNameRef CheckNames[CK_NumCheckKinds];</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordtype">void</span> checkPreCall(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordtype">void</span> checkPostCall(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordtype">void</span> checkNewAllocator(<span class="keyword">const</span> CXXAllocatorCall &amp;Call, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordtype">void</span> checkPostObjCMessage(<span class="keyword">const</span> ObjCMethodCall &amp;Call, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordtype">void</span> checkPostStmt(<span class="keyword">const</span> <a class="code" href="classclang_1_1BlockExpr.html">BlockExpr</a> *BE, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordtype">void</span> checkDeadSymbols(SymbolReaper &amp;SymReaper, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordtype">void</span> checkPreStmt(<span class="keyword">const</span> <a class="code" href="classclang_1_1ReturnStmt.html">ReturnStmt</a> *S, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordtype">void</span> checkEndFunction(<span class="keyword">const</span> <a class="code" href="classclang_1_1ReturnStmt.html">ReturnStmt</a> *S, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> evalAssume(<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>, SVal Cond,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                            <span class="keywordtype">bool</span> Assumption) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordtype">void</span> checkLocation(SVal l, <span class="keywordtype">bool</span> isLoad, <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *S,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                     CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> checkPointerEscape(<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="namespaceclang_1_1ento.html#ab2743eb22efec4f33d5138cfb12366d6">InvalidatedSymbols</a> &amp;Escaped,</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                    <span class="keyword">const</span> CallEvent *Call,</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                    <a class="code" href="namespaceclang_1_1ento.html#a1f45158b71c9d04bfd6094ee29a38e59">PointerEscapeKind</a> <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> checkConstPointerEscape(<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="namespaceclang_1_1ento.html#ab2743eb22efec4f33d5138cfb12366d6">InvalidatedSymbols</a> &amp;Escaped,</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                          <span class="keyword">const</span> CallEvent *Call,</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                          <a class="code" href="namespaceclang_1_1ento.html#a1f45158b71c9d04bfd6094ee29a38e59">PointerEscapeKind</a> <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordtype">void</span> printState(raw_ostream &amp;Out, <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">char</span> *NL, <span class="keyword">const</span> <span class="keywordtype">char</span> *Sep) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;BugType&gt; BT_DoubleFree[CK_NumCheckKinds];</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;BugType&gt; BT_DoubleDelete;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;BugType&gt; BT_Leak[CK_NumCheckKinds];</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;BugType&gt; BT_UseFree[CK_NumCheckKinds];</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;BugType&gt; BT_BadFree[CK_NumCheckKinds];</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;BugType&gt; BT_FreeAlloca[CK_NumCheckKinds];</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;BugType&gt; BT_MismatchedDealloc;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;BugType&gt; BT_OffsetFree[CK_NumCheckKinds];</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;BugType&gt; BT_UseZerroAllocated[CK_NumCheckKinds];</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">  368</a></span>&#160;<span class="preprocessor">#define CHECK_FN(NAME)                                                         \</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">  void NAME(const CallEvent &amp;Call, CheckerContext &amp;C) const;</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkFree)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkIfNameIndex)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkBasicAlloc)</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkKernelMalloc)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkCalloc)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkAlloca)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkStrdup)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkIfFreeNameIndex)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkCXXNewOrCXXDelete)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkGMalloc0)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkGMemdup)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkGMallocN)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkGMallocN0)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkReallocN)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <a class="code" href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a>(checkOwnershipAttr)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordtype">void</span> checkRealloc(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C,</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    <span class="keywordtype">bool</span> ShouldFreeOnFail) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keyword">using</span> CheckFn = std::function&lt;void(<span class="keyword">const</span> MallocChecker *,</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                     <span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C)&gt;;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keyword">const</span> CallDescriptionMap&lt;CheckFn&gt; FreeingMemFnMap{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      {{<span class="stringliteral">&quot;free&quot;</span>, 1}, &amp;MallocChecker::checkFree},</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      {{<span class="stringliteral">&quot;if_freenameindex&quot;</span>, 1}, &amp;MallocChecker::checkIfFreeNameIndex},</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      {{<span class="stringliteral">&quot;kfree&quot;</span>, 1}, &amp;MallocChecker::checkFree},</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      {{<span class="stringliteral">&quot;g_free&quot;</span>, 1}, &amp;MallocChecker::checkFree},</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  };</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordtype">bool</span> isFreeingCall(<span class="keyword">const</span> CallEvent &amp;Call) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> isFreeingOwnershipAttrCall(<span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *Func);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span>NoOwnershipChangeVisitor;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  CallDescriptionMap&lt;CheckFn&gt; AllocatingMemFnMap{</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      {{<span class="stringliteral">&quot;alloca&quot;</span>, 1}, &amp;MallocChecker::checkAlloca},</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      {{<span class="stringliteral">&quot;_alloca&quot;</span>, 1}, &amp;MallocChecker::checkAlloca},</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      {{<span class="stringliteral">&quot;malloc&quot;</span>, 1}, &amp;MallocChecker::checkBasicAlloc},</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      {{<span class="stringliteral">&quot;malloc&quot;</span>, 3}, &amp;MallocChecker::checkKernelMalloc},</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      {{<span class="stringliteral">&quot;calloc&quot;</span>, 2}, &amp;MallocChecker::checkCalloc},</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      {{<span class="stringliteral">&quot;valloc&quot;</span>, 1}, &amp;MallocChecker::checkBasicAlloc},</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      {{<a class="code" href="namespaceclang_1_1ento.html#a14c7933795584298e9a477c08343e283a1cd1ee7f015a094299bae7dba5c27f7b">CDF_MaybeBuiltin</a>, <span class="stringliteral">&quot;strndup&quot;</span>, 2}, &amp;MallocChecker::checkStrdup},</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      {{<a class="code" href="namespaceclang_1_1ento.html#a14c7933795584298e9a477c08343e283a1cd1ee7f015a094299bae7dba5c27f7b">CDF_MaybeBuiltin</a>, <span class="stringliteral">&quot;strdup&quot;</span>, 1}, &amp;MallocChecker::checkStrdup},</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      {{<span class="stringliteral">&quot;_strdup&quot;</span>, 1}, &amp;MallocChecker::checkStrdup},</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      {{<span class="stringliteral">&quot;kmalloc&quot;</span>, 2}, &amp;MallocChecker::checkKernelMalloc},</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      {{<span class="stringliteral">&quot;if_nameindex&quot;</span>, 1}, &amp;MallocChecker::checkIfNameIndex},</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      {{<a class="code" href="namespaceclang_1_1ento.html#a14c7933795584298e9a477c08343e283a1cd1ee7f015a094299bae7dba5c27f7b">CDF_MaybeBuiltin</a>, <span class="stringliteral">&quot;wcsdup&quot;</span>, 1}, &amp;MallocChecker::checkStrdup},</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      {{<a class="code" href="namespaceclang_1_1ento.html#a14c7933795584298e9a477c08343e283a1cd1ee7f015a094299bae7dba5c27f7b">CDF_MaybeBuiltin</a>, <span class="stringliteral">&quot;_wcsdup&quot;</span>, 1}, &amp;MallocChecker::checkStrdup},</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      {{<span class="stringliteral">&quot;g_malloc&quot;</span>, 1}, &amp;MallocChecker::checkBasicAlloc},</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      {{<span class="stringliteral">&quot;g_malloc0&quot;</span>, 1}, &amp;MallocChecker::checkGMalloc0},</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      {{<span class="stringliteral">&quot;g_try_malloc&quot;</span>, 1}, &amp;MallocChecker::checkBasicAlloc},</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      {{<span class="stringliteral">&quot;g_try_malloc0&quot;</span>, 1}, &amp;MallocChecker::checkGMalloc0},</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      {{<span class="stringliteral">&quot;g_memdup&quot;</span>, 2}, &amp;MallocChecker::checkGMemdup},</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      {{<span class="stringliteral">&quot;g_malloc_n&quot;</span>, 2}, &amp;MallocChecker::checkGMallocN},</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      {{<span class="stringliteral">&quot;g_malloc0_n&quot;</span>, 2}, &amp;MallocChecker::checkGMallocN0},</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      {{<span class="stringliteral">&quot;g_try_malloc_n&quot;</span>, 2}, &amp;MallocChecker::checkGMallocN},</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      {{<span class="stringliteral">&quot;g_try_malloc0_n&quot;</span>, 2}, &amp;MallocChecker::checkGMallocN0},</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  };</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  CallDescriptionMap&lt;CheckFn&gt; ReallocatingMemFnMap{</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      {{<span class="stringliteral">&quot;realloc&quot;</span>, 2},</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;       std::bind(&amp;MallocChecker::checkRealloc, _1, _2, _3, <span class="keyword">false</span>)},</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      {{<span class="stringliteral">&quot;reallocf&quot;</span>, 2},</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;       std::bind(&amp;MallocChecker::checkRealloc, _1, _2, _3, <span class="keyword">true</span>)},</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      {{<span class="stringliteral">&quot;g_realloc&quot;</span>, 2},</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;       std::bind(&amp;MallocChecker::checkRealloc, _1, _2, _3, <span class="keyword">false</span>)},</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      {{<span class="stringliteral">&quot;g_try_realloc&quot;</span>, 2},</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;       std::bind(&amp;MallocChecker::checkRealloc, _1, _2, _3, <span class="keyword">false</span>)},</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      {{<span class="stringliteral">&quot;g_realloc_n&quot;</span>, 3}, &amp;MallocChecker::checkReallocN},</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      {{<span class="stringliteral">&quot;g_try_realloc_n&quot;</span>, 3}, &amp;MallocChecker::checkReallocN},</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  };</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keywordtype">bool</span> isMemCall(<span class="keyword">const</span> CallEvent &amp;Call) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="comment">// TODO: Remove mutable by moving the initializtaion to the registry function.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keyword">mutable</span> <a class="code" href="classllvm_1_1Optional.html">Optional&lt;uint64_t&gt;</a> KernelZeroFlagVal;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keyword">using</span> KernelZeroSizePtrValueTy = <a class="code" href="classllvm_1_1Optional.html">Optional&lt;int&gt;</a>;<span class="comment"></span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">  /// Store the value of macro called `ZERO_SIZE_PTR`.</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">  /// The value is initialized at first use, before first use the outer</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">  /// Optional is empty, afterwards it contains another Optional that indicates</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">  /// if the macro value could be determined, and if yes the value itself.</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"></span>  <span class="keyword">mutable</span> <a class="code" href="classllvm_1_1Optional.html">Optional&lt;KernelZeroSizePtrValueTy&gt;</a> KernelZeroSizePtrValue;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">  /// Process C++ operator new()&#39;s allocation, which is the part of C++</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">  /// new-expression that goes before the constructor.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"></span>  LLVM_NODISCARD</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> processNewAllocation(<span class="keyword">const</span> CXXAllocatorCall &amp;Call,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                       CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                       AllocationFamily Family) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">  /// Perform a zero-allocation check.</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">  /// \param [in] Call The expression that allocates memory.</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">  /// \param [in] IndexOfSizeArg Index of the argument that specifies the size</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">  ///   of the memory that needs to be allocated. E.g. for malloc, this would be</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">  ///   0.</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">  /// \param [in] RetVal Specifies the newly allocated pointer value;</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">  ///   if unspecified, the value of expression \p E is used.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment"></span>  LLVM_NODISCARD</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keyword">static</span> <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> ProcessZeroAllocCheck(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> IndexOfSizeArg,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                               <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                               <a class="code" href="classllvm_1_1Optional.html">Optional&lt;SVal&gt;</a> RetVal = <a class="code" href="ExprConstant_8cpp.html#ae4a213489715e2de4562b3ae0538648da6adf97f83acf6453d4a6a4b1070f3754">None</a>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">  /// Model functions with the ownership_returns attribute.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">  /// User-defined function may have the ownership_returns attribute, which</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">  /// annotates that the function returns with an object that was allocated on</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">  /// the heap, and passes the ownertship to the callee.</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">  ///   void __attribute((ownership_returns(malloc, 1))) *my_malloc(size_t);</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">  /// It has two parameters:</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">  ///   - first: name of the resource (e.g. &#39;malloc&#39;)</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">  ///   - (OPTIONAL) second: size of the allocated region</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">  /// \param [in] Call The expression that allocates memory.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">  /// \param [in] Att The ownership_returns attribute.</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">  /// \param [in] State The \c ProgramState right before allocation.</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">  /// \returns The ProgramState right after allocation.</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment"></span>  LLVM_NODISCARD</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocMemReturnsAttr(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                       <span class="keyword">const</span> OwnershipAttr *Att,</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                       <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">  /// Models memory allocation.</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">  /// \param [in] Call The expression that allocates memory.</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">  /// \param [in] SizeEx Size of the memory that needs to be allocated.</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">  /// \param [in] Init The value the allocated memory needs to be initialized.</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">  /// with. For example, \c calloc initializes the allocated memory to 0,</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">  /// malloc leaves it undefined.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">  /// \param [in] State The \c ProgramState right before allocation.</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">  /// \returns The ProgramState right after allocation.</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment"></span>  LLVM_NODISCARD</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keyword">static</span> <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocMemAux(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *SizeEx, SVal Init,</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                      <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                      AllocationFamily Family);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">  /// Models memory allocation.</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">  /// \param [in] Call The expression that allocates memory.</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">  /// \param [in] Size Size of the memory that needs to be allocated.</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">  /// \param [in] Init The value the allocated memory needs to be initialized.</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">  /// with. For example, \c calloc initializes the allocated memory to 0,</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">  /// malloc leaves it undefined.</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">  /// \param [in] State The \c ProgramState right before allocation.</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">  /// \returns The ProgramState right after allocation.</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"></span>  LLVM_NODISCARD</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keyword">static</span> <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocMemAux(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                      SVal Size, SVal Init,</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                      <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                      AllocationFamily Family);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// Check if this malloc() for special flags. At present that means M_ZERO or</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="comment">// __GFP_ZERO (in which case, treat it like calloc).</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  LLVM_NODISCARD</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <a class="code" href="classllvm_1_1Optional.html">llvm::Optional&lt;ProgramStateRef&gt;</a></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  performKernelMalloc(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>,</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                      <span class="keyword">const</span> <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> &amp;<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">  /// Model functions with the ownership_takes and ownership_holds attributes.</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">  /// User-defined function may have the ownership_takes and/or ownership_holds</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">  /// attributes, which annotates that the function frees the memory passed as a</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">  /// parameter.</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">  ///   void __attribute((ownership_takes(malloc, 1))) my_free(void *);</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">  ///   void __attribute((ownership_holds(malloc, 1))) my_hold(void *);</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">  /// They have two parameters:</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">  ///   - first: name of the resource (e.g. &#39;malloc&#39;)</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">  ///   - second: index of the parameter the attribute applies to</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">  /// \param [in] Call The expression that frees memory.</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">  /// \param [in] Att The ownership_takes or ownership_holds attribute.</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">  /// \param [in] State The \c ProgramState right before allocation.</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">  /// \returns The ProgramState right after deallocation.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"></span>  LLVM_NODISCARD</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> FreeMemAttr(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                              <span class="keyword">const</span> OwnershipAttr *Att,</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                              <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">  /// Models memory deallocation.</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">  /// \param [in] Call The expression that frees memory.</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">  /// \param [in] State The \c ProgramState right before allocation.</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">  /// \param [in] Num Index of the argument that needs to be freed. This is</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">  ///   normally 0, but for custom free functions it may be different.</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">  /// \param [in] Hold Whether the parameter at \p Index has the ownership_holds</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">  ///   attribute.</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">  /// \param [out] IsKnownToBeAllocated Whether the memory to be freed is known</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">  ///   to have been allocated, or in other words, the symbol to be freed was</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">  ///   registered as allocated by this checker. In the following case, \c ptr</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">  ///   isn&#39;t known to be allocated.</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">  ///      void Haha(int *ptr) {</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">  ///        ptr = realloc(ptr, 67);</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">  ///        // ...</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">  ///      }</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">  /// \param [in] ReturnsNullOnFailure Whether the memory deallocation function</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">  ///   we&#39;re modeling returns with Null on failure.</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">  /// \returns The ProgramState right after deallocation.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment"></span>  LLVM_NODISCARD</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> FreeMemAux(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                             <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, <span class="keywordtype">unsigned</span> Num, <span class="keywordtype">bool</span> Hold,</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                             <span class="keywordtype">bool</span> &amp;IsKnownToBeAllocated,</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                             AllocationFamily Family,</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                             <span class="keywordtype">bool</span> ReturnsNullOnFailure = <span class="keyword">false</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">  /// Models memory deallocation.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">  /// \param [in] ArgExpr The variable who&#39;s pointee needs to be freed.</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">  /// \param [in] Call The expression that frees the memory.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">  /// \param [in] State The \c ProgramState right before allocation.</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">  ///   normally 0, but for custom free functions it may be different.</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">  /// \param [in] Hold Whether the parameter at \p Index has the ownership_holds</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">  ///   attribute.</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">  /// \param [out] IsKnownToBeAllocated Whether the memory to be freed is known</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">  ///   to have been allocated, or in other words, the symbol to be freed was</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">  ///   registered as allocated by this checker. In the following case, \c ptr</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">  ///   isn&#39;t known to be allocated.</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">  ///      void Haha(int *ptr) {</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">  ///        ptr = realloc(ptr, 67);</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">  ///        // ...</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">  ///      }</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">  /// \param [in] ReturnsNullOnFailure Whether the memory deallocation function</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">  ///   we&#39;re modeling returns with Null on failure.</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">  /// \returns The ProgramState right after deallocation.</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment"></span>  LLVM_NODISCARD</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> FreeMemAux(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *ArgExpr,</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                             <span class="keyword">const</span> CallEvent &amp;Call, <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                             <span class="keywordtype">bool</span> Hold, <span class="keywordtype">bool</span> &amp;IsKnownToBeAllocated,</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                             AllocationFamily Family,</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                             <span class="keywordtype">bool</span> ReturnsNullOnFailure = <span class="keyword">false</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="comment">// TODO: Needs some refactoring, as all other deallocation modeling</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="comment">// functions are suffering from out parameters and messy code due to how</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">// realloc is handled.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">  /// Models memory reallocation.</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">  /// \param [in] Call The expression that reallocated memory</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">  /// \param [in] ShouldFreeOnFail Whether if reallocation fails, the supplied</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">  ///   memory should be freed.</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">  /// \param [in] State The \c ProgramState right before reallocation.</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">  /// \param [in] SuffixWithN Whether the reallocation function we&#39;re modeling</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">  ///   has an &#39;_n&#39; suffix, such as g_realloc_n.</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">  /// \returns The ProgramState right after reallocation.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment"></span>  LLVM_NODISCARD</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> ReallocMemAux(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                                <span class="keywordtype">bool</span> ShouldFreeOnFail, <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                                AllocationFamily Family,</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                <span class="keywordtype">bool</span> SuffixWithN = <span class="keyword">false</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">  /// Evaluates the buffer size that needs to be allocated.</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">  /// \param [in] Blocks The amount of blocks that needs to be allocated.</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">  /// \param [in] BlockBytes The size of a block.</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">  /// \returns The symbolic value of \p Blocks * \p BlockBytes.</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment"></span>  LLVM_NODISCARD</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keyword">static</span> SVal evalMulForBufferSize(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *Blocks,</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *BlockBytes);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">  /// Models zero initialized array allocation.</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">  /// \param [in] Call The expression that reallocated memory</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">  /// \param [in] State The \c ProgramState right before reallocation.</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">  /// \returns The ProgramState right after allocation.</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment"></span>  LLVM_NODISCARD</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keyword">static</span> <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> CallocMem(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                                   <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">  /// See if deallocation happens in a suspicious context. If so, escape the</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">  /// pointers that otherwise would have been deallocated and return true.</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> suppressDeallocationsInSuspiciousContexts(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                                 CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">  /// If in \p S  \p Sym is used, check whether \p Sym was already freed.</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> checkUseAfterFree(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *S) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">  /// If in \p S \p Sym is used, check whether \p Sym was allocated as a zero</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">  /// sized memory region.</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> checkUseZeroAllocated(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>,</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *S) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">  /// If in \p S \p Sym is being freed, check whether \p Sym was already freed.</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> checkDoubleDelete(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">  /// Check if the function is known to free memory, or if it is</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">  /// &quot;interesting&quot; and should be modeled explicitly.</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">  /// \param [out] EscapingSymbol A function might not free memory in general,</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">  ///   but could be known to free a particular symbol. In this case, false is</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">  ///   returned and the single escaping symbol is returned through the out</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">  ///   parameter.</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">  /// We assume that pointers do not escape through calls to system functions</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">  /// not handled by this checker.</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> mayFreeAnyEscapedMemoryOrIsModeledExplicitly(<span class="keyword">const</span> CallEvent *Call,</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                   <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                   <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> &amp;EscapingSymbol) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">  /// Implementation of the checkPointerEscape callbacks.</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment"></span>  LLVM_NODISCARD</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> checkPointerEscapeAux(<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                        <span class="keyword">const</span> <a class="code" href="namespaceclang_1_1ento.html#ab2743eb22efec4f33d5138cfb12366d6">InvalidatedSymbols</a> &amp;Escaped,</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                        <span class="keyword">const</span> CallEvent *Call,</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                        <a class="code" href="namespaceclang_1_1ento.html#a1f45158b71c9d04bfd6094ee29a38e59">PointerEscapeKind</a> <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>,</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                        <span class="keywordtype">bool</span> IsConstPointerEscape) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="comment">// Implementation of the checkPreStmt and checkEndFunction callbacks.</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keywordtype">void</span> checkEscapeOnReturn(<span class="keyword">const</span> <a class="code" href="classclang_1_1ReturnStmt.html">ReturnStmt</a> *S, CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">  ///@{</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">  /// Tells if a given family/call/symbol is tracked by the current checker.</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">  /// Sets CheckKind to the kind of the checker responsible for this</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">  /// family/call/symbol.</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Optional.html">Optional&lt;CheckKind&gt;</a> getCheckIfTracked(AllocationFamily Family,</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                        <span class="keywordtype">bool</span> IsALeakCheck = <span class="keyword">false</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <a class="code" href="classllvm_1_1Optional.html">Optional&lt;CheckKind&gt;</a> getCheckIfTracked(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym,</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                        <span class="keywordtype">bool</span> IsALeakCheck = <span class="keyword">false</span>) <span class="keyword">const</span>;<span class="comment"></span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">  ///@}</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">bool</span> SummarizeValue(raw_ostream &amp;os, SVal <a class="code" href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a>);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> SummarizeRegion(raw_ostream &amp;os, <span class="keyword">const</span> MemRegion *MR);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordtype">void</span> HandleNonHeapDealloc(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, SVal ArgVal, <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range,</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *DeallocExpr,</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                            AllocationFamily Family) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordtype">void</span> HandleFreeAlloca(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, SVal ArgVal,</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                        <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="keywordtype">void</span> HandleMismatchedDealloc(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range,</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *DeallocExpr, <span class="keyword">const</span> RefState *RS,</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                               <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, <span class="keywordtype">bool</span> OwnershipTransferred) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordtype">void</span> HandleOffsetFree(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, SVal ArgVal, <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range,</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *DeallocExpr, AllocationFamily Family,</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *AllocExpr = <span class="keyword">nullptr</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordtype">void</span> HandleUseAfterFree(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range,</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                          <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keywordtype">void</span> HandleDoubleFree(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range, <span class="keywordtype">bool</span> Released,</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                        <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> PrevSym) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordtype">void</span> HandleDoubleDelete(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="keywordtype">void</span> HandleUseZeroAlloc(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range,</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                          <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordtype">void</span> HandleFunctionPtrFree(CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>, SVal ArgVal, <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range,</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *FreeExpr,</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                             AllocationFamily Family) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">  /// Find the location of the allocation for Sym on the path leading to the</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">  /// exploded node N.</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> LeakInfo getAllocationSite(<span class="keyword">const</span> ExplodedNode *N, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym,</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                                    CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordtype">void</span> HandleLeak(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, ExplodedNode *N, CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">  /// Test if value in ArgVal equals to value in macro `ZERO_SIZE_PTR`.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isArgZERO_SIZE_PTR(<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, CheckerContext &amp;<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>,</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                          SVal ArgVal) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;};</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">// Definition of NoOwnershipChangeVisitor.</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="keyword">class </span>NoOwnershipChangeVisitor final : <span class="keyword">public</span> NoStateChangeFuncVisitor {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="comment">// The symbol whose (lack of) ownership change we are interested in.</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keyword">const</span> MallocChecker &amp;Checker;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="keyword">using</span> OwnerSet = <a class="code" href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet&lt;const MemRegion *, 8&gt;</a>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="comment">// Collect which entities point to the allocated memory, and could be</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">// responsible for deallocating it.</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keyword">class </span>OwnershipBindingsHandler : <span class="keyword">public</span> StoreManager::BindingsHandler {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    OwnerSet &amp;Owners;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    OwnershipBindingsHandler(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, OwnerSet &amp;Owners)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        : Sym(Sym), Owners(Owners) {}</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordtype">bool</span> HandleBinding(StoreManager &amp;SMgr, <a class="code" href="namespaceclang_1_1ento.html#ae330047447f0de6b80e3301c139764f8">Store</a> <a class="code" href="namespaceclang_1_1ento.html#ae330047447f0de6b80e3301c139764f8">Store</a>, <span class="keyword">const</span> MemRegion *Region,</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                       SVal Val)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <span class="keywordflow">if</span> (Val.getAsSymbol() == Sym)</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        Owners.insert(Region);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    LLVM_DUMP_METHOD <span class="keywordtype">void</span> <a class="code" href="CoverageMappingGen_8cpp.html#aac83d992338dc387528380660998fb50">dump</a>()<span class="keyword"> const </span>{ dumpToStream(llvm::errs()); }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    LLVM_DUMP_METHOD <span class="keywordtype">void</span> dumpToStream(llvm::raw_ostream &amp;out)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      out &lt;&lt; <span class="stringliteral">&quot;Owners: {\n&quot;</span>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> MemRegion *Owner : Owners) {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        out &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        Owner-&gt;dumpToStream(out);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        out &lt;&lt; <span class="stringliteral">&quot;,\n&quot;</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      out &lt;&lt; <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  };</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  OwnerSet getOwnersAtNode(<span class="keyword">const</span> ExplodedNode *N) {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    OwnerSet <a class="code" href="Interp_8cpp.html#a7366213a28ea9f41665f7fd8752f4318">Ret</a>;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = N-&gt;getState();</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    OwnershipBindingsHandler Handler{Sym, <a class="code" href="Interp_8cpp.html#a7366213a28ea9f41665f7fd8752f4318">Ret</a>};</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;getStateManager().getStoreManager().iterBindings(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;getStore(),</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                                            Handler);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="Interp_8cpp.html#a7366213a28ea9f41665f7fd8752f4318">Ret</a>;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  LLVM_DUMP_METHOD <span class="keyword">static</span> <a class="code" href="lib_2Tooling_2CMakeLists_8txt.html#af86de1f06488914e30d948a42f397df5">std::string</a></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  getFunctionName(<span class="keyword">const</span> ExplodedNode *CallEnterN) {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE = llvm::dyn_cast_or_null&lt;CallExpr&gt;(</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            CallEnterN-&gt;getLocationAs&lt;<a class="code" href="classclang_1_1CallEnter.html">CallEnter</a>&gt;()-&gt;<a class="code" href="classclang_1_1CallEnter.html#a081a17f74aa6cdc6e9325326d1a392a9">getCallExpr</a>()))</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *FD = CE-&gt;getDirectCallee())</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordflow">return</span> FD-&gt;getQualifiedNameAsString();</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">  /// Syntactically checks whether the callee is a deallocating function. Since</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">  /// we have no path-sensitive information on this call (we would need a</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">  /// CallEvent instead of a CallExpr for that), its possible that a</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">  /// deallocation function was called indirectly through a function pointer,</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">  /// but we are not able to tell, so this is a best effort analysis.</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">  /// See namespace `memory_passed_to_fn_call_free_through_fn_ptr` in</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">  /// clang/test/Analysis/NewDeleteLeaks.cpp.</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isFreeingCallAsWritten(<span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> &amp;Call)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span> (Checker.FreeingMemFnMap.lookupAsWritten(Call) ||</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        Checker.ReallocatingMemFnMap.lookupAsWritten(Call))</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *Func =</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            llvm::dyn_cast_or_null&lt;FunctionDecl&gt;(<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getCalleeDecl()))</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="keywordflow">return</span> MallocChecker::isFreeingOwnershipAttrCall(Func);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  }</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">  /// Heuristically guess whether the callee intended to free memory. This is</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">  /// done syntactically, because we are trying to argue about alternative</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">  /// paths of execution, and as a consequence we don&#39;t have path-sensitive</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">  /// information.</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> doesFnIntendToHandleOwnership(<span class="keyword">const</span> <a class="code" href="classclang_1_1Decl.html">Decl</a> *Callee, <a class="code" href="classclang_1_1ASTContext.html">ASTContext</a> &amp;ACtx) {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespaceclang_1_1ast__matchers.html">clang::ast_matchers</a>;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *FD = dyn_cast&lt;FunctionDecl&gt;(Callee);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="comment">// Given that the stack frame was entered, the body should always be</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="comment">// theoretically obtainable. In case of body farms, the synthesized body</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="comment">// is not attached to declaration, thus triggering the &#39;!FD-&gt;hasBody()&#39;</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="comment">// branch. That said, would a synthesized body ever intend to handle</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">// ownership? As of today they don&#39;t. And if they did, how would we</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">// put notes inside it, given that it doesn&#39;t match any source locations?</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">if</span> (!FD || !FD-&gt;<a class="code" href="classclang_1_1FunctionDecl.html#ae945682c5190f733b118993e5b1b9c1d">hasBody</a>())</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keyword">auto</span> Matches = <a class="code" href="namespaceclang_1_1ast__matchers.html#a58409ce605d979d1d1e0a600ec417a0a">match</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#a2adc91bda011c0b3ffcc4c315131cfb4">findAll</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#ade2304887c9dd0e9fad2e0ff35320739">stmt</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#ae56a1974283c9a2cb2410008e32fe3f1">anyOf</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#a21c9455ba631c516e4e7818a0f7f8eff">cxxDeleteExpr</a>().bind(<span class="stringliteral">&quot;delete&quot;</span>),</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                                            <a class="code" href="namespaceclang_1_1ast__matchers.html#a460801cda670b9a3ccc3d42f51f3bd5c">callExpr</a>().bind(<span class="stringliteral">&quot;call&quot;</span>)))),</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                         *FD-&gt;<a class="code" href="classclang_1_1FunctionDecl.html#a06987fa159c94bf40f8c716804e1dc27">getBody</a>(), ACtx);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classclang_1_1ast__matchers_1_1BoundNodes.html">BoundNodes</a> Match : Matches) {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="keywordflow">if</span> (Match.getNodeAs&lt;<a class="code" href="classclang_1_1CXXDeleteExpr.html">CXXDeleteExpr</a>&gt;(<span class="stringliteral">&quot;delete&quot;</span>))</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *Call = Match.getNodeAs&lt;<a class="code" href="classclang_1_1CallExpr.html">CallExpr</a>&gt;(<span class="stringliteral">&quot;call&quot;</span>))</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="keywordflow">if</span> (isFreeingCallAsWritten(*Call))</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="comment">// TODO: Ownership might change with an attempt to store the allocated</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">// memory, not only through deallocation. Check for attempted stores as</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">// well.</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  wasModifiedInFunction(<span class="keyword">const</span> ExplodedNode *CallEnterN,</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                        <span class="keyword">const</span> ExplodedNode *CallExitEndN)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">if</span> (!doesFnIntendToHandleOwnership(</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            CallExitEndN-&gt;getFirstPred()-&gt;getLocationContext()-&gt;getDecl(),</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            CallExitEndN-&gt;getState()-&gt;getAnalysisManager().getASTContext()))</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">if</span> (CallEnterN-&gt;getState()-&gt;get&lt;RegionState&gt;(Sym) !=</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        CallExitEndN-&gt;getState()-&gt;get&lt;RegionState&gt;(Sym))</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    OwnerSet CurrOwners = getOwnersAtNode(CallEnterN);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    OwnerSet ExitOwners = getOwnersAtNode(CallExitEndN);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// Owners in the current set may be purged from the analyzer later on.</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">// If a variable is dead (is not referenced directly or indirectly after</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="comment">// some point), it will be removed from the Store before the end of its</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="comment">// actual lifetime.</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">// This means that that if the ownership status didn&#39;t change, CurrOwners</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">// must be a superset of, but not necessarily equal to ExitOwners.</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">return</span> !llvm::set_is_subset(ExitOwners, CurrOwners);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="keyword">static</span> <a class="code" href="namespaceclang_1_1ento.html#af0d0e00a28f39eb324aea94250e58848">PathDiagnosticPieceRef</a> emitNote(<span class="keyword">const</span> ExplodedNode *N) {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    PathDiagnosticLocation L = <a class="code" href="classclang_1_1ento_1_1PathDiagnosticLocation.html#ad5e9747a36878bcaaf1c734e417f7fd6">PathDiagnosticLocation::create</a>(</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        N-&gt;getLocation(),</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        N-&gt;getState()-&gt;getStateManager().getContext().getSourceManager());</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordflow">return</span> std::make_shared&lt;PathDiagnosticEventPiece&gt;(</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        L, <span class="stringliteral">&quot;Returning without deallocating memory or storing the pointer for &quot;</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;           <span class="stringliteral">&quot;later deallocation&quot;</span>);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keyword">virtual</span> <a class="code" href="namespaceclang_1_1ento.html#af0d0e00a28f39eb324aea94250e58848">PathDiagnosticPieceRef</a></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  maybeEmitNoteForObjCSelf(PathSensitiveBugReport &amp;R,</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                           <span class="keyword">const</span> ObjCMethodCall &amp;Call,</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                           <span class="keyword">const</span> ExplodedNode *N)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">// TODO: Implement.</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  }</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keyword">virtual</span> <a class="code" href="namespaceclang_1_1ento.html#af0d0e00a28f39eb324aea94250e58848">PathDiagnosticPieceRef</a></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  maybeEmitNoteForCXXThis(PathSensitiveBugReport &amp;R,</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                          <span class="keyword">const</span> CXXConstructorCall &amp;Call,</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                          <span class="keyword">const</span> ExplodedNode *N)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">// TODO: Implement.</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="keyword">virtual</span> <a class="code" href="namespaceclang_1_1ento.html#af0d0e00a28f39eb324aea94250e58848">PathDiagnosticPieceRef</a></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  maybeEmitNoteForParameters(PathSensitiveBugReport &amp;R, <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                             <span class="keyword">const</span> ExplodedNode *N)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">// TODO: Factor the logic of &quot;what constitutes as an entity being passed</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="comment">// into a function call&quot; out by reusing the code in</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="comment">// NoStoreFuncVisitor::maybeEmitNoteForParameters, maybe by incorporating</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">// the printing technology in UninitializedObject&#39;s FieldChainInfo.</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;ParmVarDecl *&gt;</a> <a class="code" href="namespaceclang_1_1syntax.html#a0d10149d69e32e3c86140b4d325925e5a3225a10b07f1580f10dee4abc3779e6c">Parameters</a> = <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.parameters();</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> I = 0; I &lt; <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getNumArgs() &amp;&amp; I &lt; <a class="code" href="namespaceclang_1_1syntax.html#a0d10149d69e32e3c86140b4d325925e5a3225a10b07f1580f10dee4abc3779e6c">Parameters</a>.size(); ++I) {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      SVal <a class="code" href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a> = <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgSVal(I);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a>.getAsSymbol() == Sym)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordflow">return</span> emitNote(N);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  NoOwnershipChangeVisitor(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, <span class="keyword">const</span> MallocChecker *Checker)</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      : NoStateChangeFuncVisitor(bugreporter::<a class="code" href="namespaceclang_1_1ento_1_1bugreporter.html#af2ca64fac08b6097205ca3f72b002779">TrackingKind</a>::<a class="code" href="namespaceclang_1_1ento_1_1bugreporter.html#af2ca64fac08b6097205ca3f72b002779a010b6767eb31718f372a73e0513e1410">Thorough</a>), Sym(Sym),</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        Checker(*Checker) {}</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="keywordtype">void</span> Profile(llvm::FoldingSetNodeID &amp;<a class="code" href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">ID</a>)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> Tag = 0;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <a class="code" href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">ID</a>.AddPointer(&amp;Tag);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <a class="code" href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">ID</a>.AddPointer(Sym);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="keywordtype">void</span> *getTag()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> Tag = 0;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">void</span> *<span class="keyword">&gt;</span>(&amp;Tag);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;};</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">// Definition of MallocBugVisitor.</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="keyword">namespace </span>{<span class="comment"></span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">/// The bug visitor which allows us to print extra diagnostics along the</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">/// BugReport path. For example, showing the allocation site of the leaked</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">/// region.</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment"></span><span class="keyword">class </span>MallocBugVisitor final : <span class="keyword">public</span> BugReporterVisitor {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keyword">enum</span> NotificationMode { <a class="code" href="namespaceclang.html#a44775134eba0623164027214ea176711a960b44c579bc2f6818d2daaf9e4c16f0">Normal</a>, ReallocationFailed };</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">// The allocated region symbol tracked by the main analysis.</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="comment">// The mode we are in, i.e. what kind of diagnostics will be emitted.</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  NotificationMode Mode;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="comment">// A symbol from when the primary region should have been reallocated.</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> FailedReallocSymbol;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="comment">// A C++ destructor stack frame in which memory was released. Used for</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="comment">// miscellaneous false positive suppression.</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1StackFrameContext.html">StackFrameContext</a> *ReleaseDestructorLC;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keywordtype">bool</span> IsLeak;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  MallocBugVisitor(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> S, <span class="keywordtype">bool</span> isLeak = <span class="keyword">false</span>)</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      : Sym(S), Mode(<a class="code" href="namespaceclang.html#a44775134eba0623164027214ea176711a960b44c579bc2f6818d2daaf9e4c16f0">Normal</a>), FailedReallocSymbol(nullptr),</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        ReleaseDestructorLC(nullptr), IsLeak(isLeak) {}</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> *getTag() {</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> Tag = 0;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordflow">return</span> &amp;Tag;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  }</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordtype">void</span> Profile(llvm::FoldingSetNodeID &amp;<a class="code" href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">ID</a>)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <a class="code" href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">ID</a>.AddPointer(getTag());</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">ID</a>.AddPointer(Sym);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">  /// Did not track -&gt; allocated. Other state (released) -&gt; allocated.</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> isAllocated(<span class="keyword">const</span> RefState *RSCurr, <span class="keyword">const</span> RefState *RSPrev,</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *<a class="code" href="classclang_1_1Stmt.html">Stmt</a>) {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">return</span> (isa_and_nonnull&lt;CallExpr, CXXNewExpr&gt;(<a class="code" href="classclang_1_1Stmt.html">Stmt</a>) &amp;&amp;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            (RSCurr &amp;&amp;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;             (RSCurr-&gt;isAllocated() || RSCurr-&gt;isAllocatedOfSizeZero())) &amp;&amp;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            (!RSPrev ||</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;             !(RSPrev-&gt;isAllocated() || RSPrev-&gt;isAllocatedOfSizeZero())));</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">  /// Did not track -&gt; released. Other state (allocated) -&gt; released.</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">  /// The statement associated with the release might be missing.</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#a2a7903a04bcc80b227a601bafdf4d128">isReleased</a>(<span class="keyword">const</span> RefState *RSCurr, <span class="keyword">const</span> RefState *RSPrev,</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *<a class="code" href="classclang_1_1Stmt.html">Stmt</a>) {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordtype">bool</span> IsReleased =</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        (RSCurr &amp;&amp; RSCurr-&gt;isReleased()) &amp;&amp; (!RSPrev || !RSPrev-&gt;isReleased());</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    assert(!IsReleased || (isa_and_nonnull&lt;CallExpr, CXXDeleteExpr&gt;(<a class="code" href="classclang_1_1Stmt.html">Stmt</a>)) ||</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;           (!<a class="code" href="classclang_1_1Stmt.html">Stmt</a> &amp;&amp; RSCurr-&gt;getAllocationFamily() == AF_InnerBuffer));</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">return</span> IsReleased;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">  /// Did not track -&gt; relinquished. Other state (allocated) -&gt; relinquished.</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> isRelinquished(<span class="keyword">const</span> RefState *RSCurr,</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                    <span class="keyword">const</span> RefState *RSPrev, <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *<a class="code" href="classclang_1_1Stmt.html">Stmt</a>) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keywordflow">return</span> (</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        isa_and_nonnull&lt;CallExpr, ObjCMessageExpr, ObjCPropertyRefExpr&gt;(<a class="code" href="classclang_1_1Stmt.html">Stmt</a>) &amp;&amp;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        (RSCurr &amp;&amp; RSCurr-&gt;isRelinquished()) &amp;&amp;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        (!RSPrev || !RSPrev-&gt;isRelinquished()));</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">  /// If the expression is not a call, and the state change is</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">  /// released -&gt; allocated, it must be the realloc return value</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">  /// check. If we have to handle more cases here, it might be cleaner just</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">  /// to track this extra bit in the state itself.</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> hasReallocFailed(<span class="keyword">const</span> RefState *RSCurr,</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                                      <span class="keyword">const</span> RefState *RSPrev,</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *<a class="code" href="classclang_1_1Stmt.html">Stmt</a>) {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordflow">return</span> ((!isa_and_nonnull&lt;CallExpr&gt;(<a class="code" href="classclang_1_1Stmt.html">Stmt</a>)) &amp;&amp;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            (RSCurr &amp;&amp;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;             (RSCurr-&gt;isAllocated() || RSCurr-&gt;isAllocatedOfSizeZero())) &amp;&amp;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            (RSPrev &amp;&amp;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;             !(RSPrev-&gt;isAllocated() || RSPrev-&gt;isAllocatedOfSizeZero())));</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#af0d0e00a28f39eb324aea94250e58848">PathDiagnosticPieceRef</a> VisitNode(<span class="keyword">const</span> ExplodedNode *N,</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                                   BugReporterContext &amp;BRC,</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                                   PathSensitiveBugReport &amp;BR) <span class="keyword">override</span>;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#af0d0e00a28f39eb324aea94250e58848">PathDiagnosticPieceRef</a> getEndPath(BugReporterContext &amp;BRC,</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                                    <span class="keyword">const</span> ExplodedNode *EndPathNode,</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                                    PathSensitiveBugReport &amp;BR)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordflow">if</span> (!IsLeak)</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    PathDiagnosticLocation L = BR.getLocation();</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">// Do not add the statement itself as a range in case of leak.</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">return</span> std::make_shared&lt;PathDiagnosticEventPiece&gt;(L, BR.getDescription(),</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                                                      <span class="keyword">false</span>);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="keyword">class </span>StackHintGeneratorForReallocationFailed</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      : <span class="keyword">public</span> StackHintGeneratorForSymbol {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    StackHintGeneratorForReallocationFailed(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> S, StringRef M)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        : StackHintGeneratorForSymbol(S, M) {}</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <a class="code" href="lib_2Tooling_2CMakeLists_8txt.html#af86de1f06488914e30d948a42f397df5">std::string</a> getMessageForArg(<span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *ArgE, <span class="keywordtype">unsigned</span> ArgIndex)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="comment">// Printed parameters start at 1, not 0.</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      ++ArgIndex;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;200&gt;</a> buf;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      llvm::raw_svector_ostream os(buf);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Reallocation of &quot;</span> &lt;&lt; ArgIndex &lt;&lt; llvm::getOrdinalSuffix(ArgIndex)</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; parameter failed&quot;</span>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="lib_2Tooling_2CMakeLists_8txt.html#af86de1f06488914e30d948a42f397df5">std::string</a>(os.str());</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <a class="code" href="lib_2Tooling_2CMakeLists_8txt.html#af86de1f06488914e30d948a42f397df5">std::string</a> getMessageForReturn(<span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *<a class="code" href="classclang_1_1CallExpr.html">CallExpr</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Reallocation of returned value failed&quot;</span>;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    }</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  };</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;};</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">// A map from the freed symbol to the symbol representing the return value of</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">// the free function.</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<a class="code" href="ProgramStateTrait_8h.html#a6d1893bb8c18543337b6c363c1319fcf">REGISTER_MAP_WITH_PROGRAMSTATE</a>(FreeReturnValue, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a>, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a>)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="keyword">class </span>StopTrackingCallback final : <span class="keyword">public</span> SymbolVisitor {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  StopTrackingCallback(<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> st) : <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>(<a class="code" href="namespacestd.html">std</a>::move(st)) {}</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> getState()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>; }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordtype">bool</span> VisitSymbol(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> sym)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;remove&lt;RegionState&gt;(sym);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;};</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#ae6533c7f9026cf098295dadb134506d7"> 1087</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#ae6533c7f9026cf098295dadb134506d7">isStandardNewDelete</a>(<span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *FD) {</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="keywordflow">if</span> (!FD)</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <a class="code" href="namespaceclang.html#a0667c189ac152d457c17935303efeb5a">OverloadedOperatorKind</a> <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> = FD-&gt;<a class="code" href="classclang_1_1FunctionDecl.html#ac0027637798e850bd7f6c5f823ca6362">getOverloadedOperator</a>();</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> != OO_New &amp;&amp; <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> != OO_Array_New &amp;&amp; <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> != OO_Delete &amp;&amp;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> != OO_Array_Delete)</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="comment">// This is standard if and only if it&#39;s not defined in a user file.</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <a class="code" href="classclang_1_1SourceLocation.html">SourceLocation</a> L = FD-&gt;<a class="code" href="classclang_1_1Decl.html#a9ac934b2f7ae95704682dc44da1f0867">getLocation</a>();</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="comment">// If the header for operator delete is not included, it&#39;s still defined</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="comment">// in an invalid source location. Check to make sure we don&#39;t crash.</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="keywordflow">return</span> !L.<a class="code" href="classclang_1_1SourceLocation.html#a980da8d6100c0a0c3764991ca80ce6e7">isValid</a>() ||</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;         FD-&gt;<a class="code" href="classclang_1_1Decl.html#a213239e747fb0b3a0cacd86267339af2">getASTContext</a>().<a class="code" href="classclang_1_1ASTContext.html#a091e2575135f7f9f1aeb25ba0090bfde">getSourceManager</a>().<a class="code" href="classclang_1_1SourceManager.html#aa728bad682c5216d9efa45c03404447a">isInSystemHeader</a>(L);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;}</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">// Methods of MallocChecker and MallocBugVisitor.</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="keywordtype">bool</span> MallocChecker::isFreeingOwnershipAttrCall(<span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *Func) {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="keywordflow">if</span> (Func-&gt;<a class="code" href="classclang_1_1Decl.html#a1e0b6223e2547ac65ddbf4802117998b">hasAttrs</a>()) {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *I : Func-&gt;<a class="code" href="classclang_1_1Decl.html#a9c0ac8ddf9155de0b95eeeb18034e50f">specific_attrs</a>&lt;OwnershipAttr&gt;()) {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      OwnershipAttr::OwnershipKind OwnKind = I-&gt;getOwnKind();</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">if</span> (OwnKind == OwnershipAttr::Takes || OwnKind == OwnershipAttr::Holds)</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;}</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="keywordtype">bool</span> MallocChecker::isFreeingCall(<span class="keyword">const</span> CallEvent &amp;Call)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="keywordflow">if</span> (FreeingMemFnMap.lookup(Call) || ReallocatingMemFnMap.lookup(Call))</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *Func = dyn_cast_or_null&lt;FunctionDecl&gt;(<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getDecl()))</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">return</span> isFreeingOwnershipAttrCall(Func);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;}</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="keywordtype">bool</span> MallocChecker::isMemCall(<span class="keyword">const</span> CallEvent &amp;Call)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keywordflow">if</span> (FreeingMemFnMap.lookup(Call) || AllocatingMemFnMap.lookup(Call) ||</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      ReallocatingMemFnMap.lookup(Call))</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="keywordflow">if</span> (!ShouldIncludeOwnershipAnnotatedFunctions)</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> *Func = dyn_cast&lt;FunctionDecl&gt;(<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getDecl());</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keywordflow">return</span> Func &amp;&amp; Func-&gt;<a class="code" href="classclang_1_1Decl.html#ae7a63b99398864d86f53afd8a03c359b">hasAttr</a>&lt;OwnershipAttr&gt;();</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;}</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<a class="code" href="classllvm_1_1Optional.html">llvm::Optional&lt;ProgramStateRef&gt;</a></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;MallocChecker::performKernelMalloc(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C,</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> &amp;<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="comment">// 3-argument malloc(), as commonly used in {Free,Net,Open}BSD Kernels:</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="comment">// void *malloc(unsigned long size, struct malloc_type *mtp, int flags);</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="comment">// One of the possible flags is M_ZERO, which means &#39;give me back an</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="comment">// allocation which is already zeroed&#39;, like calloc.</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="comment">// 2-argument kmalloc(), as used in the Linux kernel:</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="comment">// void *kmalloc(size_t size, gfp_t flags);</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="comment">// Has the similar flag value __GFP_ZERO.</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <span class="comment">// This logic is largely cloned from O_CREAT in UnixAPIChecker, maybe some</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="comment">// code could be shared.</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <a class="code" href="classclang_1_1ASTContext.html">ASTContext</a> &amp;Ctx = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getASTContext();</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  llvm::Triple::OSType <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a> = Ctx.<a class="code" href="classclang_1_1ASTContext.html#ac052b2e7614712bb410e01756f9669e9">getTargetInfo</a>().<a class="code" href="classclang_1_1TargetInfo.html#abbc87af30c26901adb25c948c72e9039">getTriple</a>().getOS();</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keywordflow">if</span> (!KernelZeroFlagVal.hasValue()) {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keywordflow">if</span> (OS == llvm::Triple::FreeBSD)</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      KernelZeroFlagVal = 0x0100;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (OS == llvm::Triple::NetBSD)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      KernelZeroFlagVal = 0x0002;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (OS == llvm::Triple::OpenBSD)</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      KernelZeroFlagVal = 0x0008;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (OS == llvm::Triple::Linux)</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="comment">// __GFP_ZERO</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      KernelZeroFlagVal = 0x8000;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <span class="comment">// FIXME: We need a more general way of getting the M_ZERO value.</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="comment">// See also: O_CREAT in UnixAPIChecker.cpp.</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="comment">// Fall back to normal malloc behavior on platforms where we don&#39;t</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="comment">// know M_ZERO.</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1XRayInstrKind.html#a74957f939e9c2b26d53095846a926c34">None</a>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  }</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="comment">// We treat the last argument as the flags argument, and callers fall-back to</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="comment">// normal malloc on a None return. This works for the FreeBSD kernel malloc</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="comment">// as well as Linux kmalloc.</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getNumArgs() &lt; 2)</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1XRayInstrKind.html#a74957f939e9c2b26d53095846a926c34">None</a>;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *FlagsEx = <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getNumArgs() - 1);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keyword">const</span> SVal <a class="code" href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(FlagsEx);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a>.getAs&lt;NonLoc&gt;()) {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="comment">// The case where &#39;V&#39; can be a location can only be due to a bad header,</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="comment">// so in this case bail out.</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1XRayInstrKind.html#a74957f939e9c2b26d53095846a926c34">None</a>;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  }</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  NonLoc Flags = <a class="code" href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a>.castAs&lt;NonLoc&gt;();</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  NonLoc ZeroFlag = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSValBuilder()</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      .makeIntVal(KernelZeroFlagVal.getValue(), FlagsEx-&gt;<a class="code" href="classclang_1_1Expr.html#ac9bfcc699442f2093723cfcf703d9f47">getType</a>())</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      .castAs&lt;NonLoc&gt;();</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  SVal MaskedFlagsUC = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSValBuilder().evalBinOpNN(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, BO_And,</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                                                      Flags, ZeroFlag,</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                                                      FlagsEx-&gt;<a class="code" href="classclang_1_1Expr.html#ac9bfcc699442f2093723cfcf703d9f47">getType</a>());</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="keywordflow">if</span> (MaskedFlagsUC.isUnknownOrUndef())</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordflow">return</span> None;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  DefinedSVal MaskedFlags = MaskedFlagsUC.castAs&lt;DefinedSVal&gt;();</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="comment">// Check if maskedFlags is non-zero.</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> TrueState, FalseState;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  std::tie(TrueState, FalseState) = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;assume(MaskedFlags);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="comment">// If M_ZERO is set, treat this like calloc (initialized).</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="keywordflow">if</span> (TrueState &amp;&amp; !FalseState) {</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    SVal ZeroVal = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSValBuilder().makeZeroVal(Ctx.<a class="code" href="classclang_1_1ASTContext.html#a80ed5a736a74c76bbbd66b90821d1689">CharTy</a>);</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">return</span> MallocMemAux(C, Call, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(0), ZeroVal, TrueState,</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                        AF_Malloc);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1XRayInstrKind.html#a74957f939e9c2b26d53095846a926c34">None</a>;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;}</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160; </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;SVal MallocChecker::evalMulForBufferSize(CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *Blocks,</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *BlockBytes) {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  SValBuilder &amp;SB = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSValBuilder();</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  SVal BlocksVal = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(Blocks);</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  SVal BlockBytesVal = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(BlockBytes);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  SVal TotalSize = SB.evalBinOp(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, BO_Mul, BlocksVal, BlockBytesVal,</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                SB.getContext().getSizeType());</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  <span class="keywordflow">return</span> TotalSize;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;}</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkBasicAlloc(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                                    CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = MallocMemAux(C, Call, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(0), UndefinedVal(), <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                       AF_Malloc);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 0, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;}</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkKernelMalloc(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                                      CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <a class="code" href="classllvm_1_1Optional.html">llvm::Optional&lt;ProgramStateRef&gt;</a> MaybeState =</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      performKernelMalloc(Call, C, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="keywordflow">if</span> (MaybeState.hasValue())</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = MaybeState.getValue();</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = MallocMemAux(C, Call, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(0), UndefinedVal(), <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                         AF_Malloc);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;}</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; </div>
<div class="line"><a name="l01254"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#aa6a7c10cdb22462332d65e8a53b70f01"> 1254</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#aa6a7c10cdb22462332d65e8a53b70f01">isStandardRealloc</a>(<span class="keyword">const</span> CallEvent &amp;Call) {</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *FD = dyn_cast&lt;FunctionDecl&gt;(Call.getDecl());</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  assert(FD);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <a class="code" href="classclang_1_1ASTContext.html">ASTContext</a> &amp;AC = FD-&gt;<a class="code" href="classclang_1_1Decl.html#a213239e747fb0b3a0cacd86267339af2">getASTContext</a>();</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <span class="keywordflow">if</span> (isa&lt;CXXMethodDecl&gt;(FD))</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="keywordflow">return</span> FD-&gt;<a class="code" href="classclang_1_1FunctionDecl.html#ad303e1b462717d3e43e1ff09e7dedfe5">getDeclaredReturnType</a>().<a class="code" href="classclang_1_1QualType.html#a3d98e87be0c7859cc21c6c158cb91f77">getDesugaredType</a>(AC) == AC.<a class="code" href="classclang_1_1ASTContext.html#a485732164c40553bb323c58f5e8bf7a7">VoidPtrTy</a> &amp;&amp;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;         FD-&gt;<a class="code" href="classclang_1_1FunctionDecl.html#afd761724c0261c3613c187ca98482442">getParamDecl</a>(0)-&gt;<a class="code" href="classclang_1_1ValueDecl.html#a673ae4e2fab42426820de8df166fef5d">getType</a>().<a class="code" href="classclang_1_1QualType.html#a3d98e87be0c7859cc21c6c158cb91f77">getDesugaredType</a>(AC) == AC.<a class="code" href="classclang_1_1ASTContext.html#a485732164c40553bb323c58f5e8bf7a7">VoidPtrTy</a> &amp;&amp;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;         FD-&gt;<a class="code" href="classclang_1_1FunctionDecl.html#afd761724c0261c3613c187ca98482442">getParamDecl</a>(1)-&gt;<a class="code" href="classclang_1_1ValueDecl.html#a673ae4e2fab42426820de8df166fef5d">getType</a>().<a class="code" href="classclang_1_1QualType.html#a3d98e87be0c7859cc21c6c158cb91f77">getDesugaredType</a>(AC) ==</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;             AC.<a class="code" href="classclang_1_1ASTContext.html#a7c89acd533ffea38c5011885d8d029e4">getSizeType</a>();</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;}</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01268"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#a863f125a89c96743e0fc44fc2796ebbc"> 1268</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#a863f125a89c96743e0fc44fc2796ebbc">isGRealloc</a>(<span class="keyword">const</span> CallEvent &amp;Call) {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *FD = dyn_cast&lt;FunctionDecl&gt;(Call.getDecl());</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  assert(FD);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <a class="code" href="classclang_1_1ASTContext.html">ASTContext</a> &amp;AC = FD-&gt;<a class="code" href="classclang_1_1Decl.html#a213239e747fb0b3a0cacd86267339af2">getASTContext</a>();</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160; </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="keywordflow">if</span> (isa&lt;CXXMethodDecl&gt;(FD))</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160; </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <span class="keywordflow">return</span> FD-&gt;<a class="code" href="classclang_1_1FunctionDecl.html#ad303e1b462717d3e43e1ff09e7dedfe5">getDeclaredReturnType</a>().<a class="code" href="classclang_1_1QualType.html#a3d98e87be0c7859cc21c6c158cb91f77">getDesugaredType</a>(AC) == AC.<a class="code" href="classclang_1_1ASTContext.html#a485732164c40553bb323c58f5e8bf7a7">VoidPtrTy</a> &amp;&amp;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;         FD-&gt;<a class="code" href="classclang_1_1FunctionDecl.html#afd761724c0261c3613c187ca98482442">getParamDecl</a>(0)-&gt;<a class="code" href="classclang_1_1ValueDecl.html#a673ae4e2fab42426820de8df166fef5d">getType</a>().<a class="code" href="classclang_1_1QualType.html#a3d98e87be0c7859cc21c6c158cb91f77">getDesugaredType</a>(AC) == AC.<a class="code" href="classclang_1_1ASTContext.html#a485732164c40553bb323c58f5e8bf7a7">VoidPtrTy</a> &amp;&amp;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;         FD-&gt;<a class="code" href="classclang_1_1FunctionDecl.html#afd761724c0261c3613c187ca98482442">getParamDecl</a>(1)-&gt;<a class="code" href="classclang_1_1ValueDecl.html#a673ae4e2fab42426820de8df166fef5d">getType</a>().<a class="code" href="classclang_1_1QualType.html#a3d98e87be0c7859cc21c6c158cb91f77">getDesugaredType</a>(AC) ==</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;             AC.<a class="code" href="classclang_1_1ASTContext.html#a76182acff43ec4d01c06751bb8a2f7bc">UnsignedLongTy</a>;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;}</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkRealloc(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C,</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                 <span class="keywordtype">bool</span> ShouldFreeOnFail)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <span class="comment">// HACK: CallDescription currently recognizes non-standard realloc functions</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="comment">// as standard because it doesn&#39;t check the type, or wether its a non-method</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <span class="comment">// function. This should be solved by making CallDescription smarter.</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <span class="comment">// Mind that this came from a bug report, and all other functions suffer from</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="comment">// this.</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="comment">// https://bugs.llvm.org/show_bug.cgi?id=46253</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="MallocChecker_8cpp.html#aa6a7c10cdb22462332d65e8a53b70f01">isStandardRealloc</a>(Call) &amp;&amp; !<a class="code" href="MallocChecker_8cpp.html#a863f125a89c96743e0fc44fc2796ebbc">isGRealloc</a>(Call))</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ReallocMemAux(C, Call, ShouldFreeOnFail, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, AF_Malloc);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 1, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;}</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160; </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkCalloc(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                                CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = CallocMem(C, Call, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 0, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 1, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;}</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160; </div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkFree(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="keywordtype">bool</span> IsKnownToBeAllocatedMemory = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordflow">if</span> (suppressDeallocationsInSuspiciousContexts(Call, C))</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = FreeMemAux(C, Call, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, 0, <span class="keyword">false</span>, IsKnownToBeAllocatedMemory,</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                     AF_Malloc);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;}</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160; </div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkAlloca(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                                CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = MallocMemAux(C, Call, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(0), UndefinedVal(), <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                       AF_Alloca);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 0, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;}</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160; </div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkStrdup(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                                CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> *CE = dyn_cast_or_null&lt;CallExpr&gt;(<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getOriginExpr());</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <span class="keywordflow">if</span> (!CE)</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="MallocChecker_8cpp.html#a923124dcac9f30d5c9d80541135f5d1e">MallocUpdateRefState</a>(C, CE, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, AF_Malloc);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160; </div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;}</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkIfNameIndex(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                     CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="comment">// Should we model this differently? We can allocate a fixed number of</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <span class="comment">// elements with zeros in the last one.</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> =</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      MallocMemAux(C, Call, UnknownVal(), UnknownVal(), <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, AF_IfNameIndex);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160; </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;}</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkIfFreeNameIndex(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                         CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <span class="keywordtype">bool</span> IsKnownToBeAllocatedMemory = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = FreeMemAux(C, Call, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, 0, <span class="keyword">false</span>, IsKnownToBeAllocatedMemory,</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                     AF_IfNameIndex);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;}</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160; </div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkCXXNewOrCXXDelete(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                                           CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keywordtype">bool</span> IsKnownToBeAllocatedMemory = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> *CE = dyn_cast_or_null&lt;CallExpr&gt;(<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getOriginExpr());</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="keywordflow">if</span> (!CE)</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  assert(<a class="code" href="MallocChecker_8cpp.html#ae6533c7f9026cf098295dadb134506d7">isStandardNewDelete</a>(Call));</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="comment">// Process direct calls to operator new/new[]/delete/delete[] functions</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="comment">// as distinct from new/new[]/delete/delete[] expressions that are</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="comment">// processed by the checkPostStmt callbacks for CXXNewExpr and</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="comment">// CXXDeleteExpr.</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *FD = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getCalleeDecl(CE);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <span class="keywordflow">switch</span> (FD-&gt;<a class="code" href="classclang_1_1FunctionDecl.html#ac0027637798e850bd7f6c5f823ca6362">getOverloadedOperator</a>()) {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="keywordflow">case</span> OO_New:</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> =</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        MallocMemAux(C, Call, CE-&gt;getArg(0), UndefinedVal(), <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, AF_CXXNew);</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 0, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <span class="keywordflow">case</span> OO_Array_New:</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = MallocMemAux(C, Call, CE-&gt;getArg(0), UndefinedVal(), <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                         AF_CXXNewArray);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 0, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="keywordflow">case</span> OO_Delete:</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = FreeMemAux(C, Call, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, 0, <span class="keyword">false</span>, IsKnownToBeAllocatedMemory,</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                       AF_CXXNew);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <span class="keywordflow">case</span> OO_Array_Delete:</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = FreeMemAux(C, Call, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, 0, <span class="keyword">false</span>, IsKnownToBeAllocatedMemory,</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                       AF_CXXNewArray);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    llvm_unreachable(<span class="stringliteral">&quot;not a new/delete operator&quot;</span>);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  }</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160; </div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;}</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkGMalloc0(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                                  CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  SValBuilder &amp;svalBuilder = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSValBuilder();</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  SVal zeroVal = svalBuilder.makeZeroVal(svalBuilder.getContext().CharTy);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = MallocMemAux(C, Call, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(0), zeroVal, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, AF_Malloc);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 0, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;}</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160; </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkGMemdup(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                                 CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = MallocMemAux(C, Call, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(1), UndefinedVal(), <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                       AF_Malloc);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 1, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;}</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkGMallocN(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                                  CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  SVal Init = UndefinedVal();</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  SVal TotalSize = evalMulForBufferSize(C, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(0), <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(1));</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = MallocMemAux(C, Call, TotalSize, Init, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, AF_Malloc);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 0, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 1, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;}</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkGMallocN0(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                                   CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  SValBuilder &amp;SB = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSValBuilder();</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  SVal Init = SB.makeZeroVal(SB.getContext().CharTy);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  SVal TotalSize = evalMulForBufferSize(C, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(0), <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(1));</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = MallocMemAux(C, Call, TotalSize, Init, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, AF_Malloc);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 0, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 1, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;}</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkReallocN(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                                  CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ReallocMemAux(C, Call, <span class="comment">/*ShouldFreeOnFail=*/</span><span class="keyword">false</span>, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, AF_Malloc,</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                        <span class="comment">/*SuffixWithN=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 1, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 2, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;}</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkOwnershipAttr(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                                       CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> *CE = dyn_cast_or_null&lt;CallExpr&gt;(<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getOriginExpr());</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="keywordflow">if</span> (!CE)</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *FD = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getCalleeDecl(CE);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <span class="keywordflow">if</span> (!FD)</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="keywordflow">if</span> (ShouldIncludeOwnershipAnnotatedFunctions ||</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      ChecksEnabled[CK_MismatchedDeallocatorChecker]) {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="comment">// Check all the attributes, if there are any.</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="comment">// There can be multiple of these attributes.</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keywordflow">if</span> (FD-&gt;<a class="code" href="classclang_1_1Decl.html#a1e0b6223e2547ac65ddbf4802117998b">hasAttrs</a>())</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *I : FD-&gt;<a class="code" href="classclang_1_1Decl.html#a9c0ac8ddf9155de0b95eeeb18034e50f">specific_attrs</a>&lt;OwnershipAttr&gt;()) {</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <span class="keywordflow">switch</span> (I-&gt;getOwnKind()) {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="keywordflow">case</span> OwnershipAttr::Returns:</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;          <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = MallocMemReturnsAttr(C, Call, I, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="keywordflow">case</span> OwnershipAttr::Takes:</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <span class="keywordflow">case</span> OwnershipAttr::Holds:</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;          <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = FreeMemAttr(C, Call, I, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        }</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      }</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  }</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;}</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkPostCall(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                                  CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.wasInlined)</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getOriginExpr())</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160; </div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> CheckFn *Callback = FreeingMemFnMap.lookup(Call)) {</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    (*Callback)(<span class="keyword">this</span>, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>, <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>);</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  }</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> CheckFn *Callback = AllocatingMemFnMap.lookup(Call)) {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    (*Callback)(<span class="keyword">this</span>, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>, <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  }</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160; </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> CheckFn *Callback = ReallocatingMemFnMap.lookup(Call)) {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    (*Callback)(<span class="keyword">this</span>, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>, <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>);</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160; </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MallocChecker_8cpp.html#ae6533c7f9026cf098295dadb134506d7">isStandardNewDelete</a>(Call)) {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    checkCXXNewOrCXXDelete(Call, C);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  }</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160; </div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  checkOwnershipAttr(Call, C);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;}</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160; </div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">// Performs a 0-sized allocations check.</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocChecker::ProcessZeroAllocCheck(</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="keyword">const</span> CallEvent &amp;Call, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> IndexOfSizeArg, <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <a class="code" href="classllvm_1_1Optional.html">Optional&lt;SVal&gt;</a> RetVal) {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>)</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <span class="keywordflow">if</span> (!RetVal)</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    RetVal = <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getReturnValue();</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160; </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *Arg = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE = dyn_cast&lt;CallExpr&gt;(<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getOriginExpr())) {</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    Arg = CE-&gt;getArg(IndexOfSizeArg);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1CXXNewExpr.html">CXXNewExpr</a> *<a class="code" href="namespaceclang_1_1interp.html#a4722429e794a3d193b85f859eef008a1">NE</a> =</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                 dyn_cast&lt;CXXNewExpr&gt;(<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getOriginExpr())) {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1interp.html#a4722429e794a3d193b85f859eef008a1">NE</a>-&gt;isArray()) {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      Arg = *<a class="code" href="namespaceclang_1_1interp.html#a4722429e794a3d193b85f859eef008a1">NE</a>-&gt;getArraySize();</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    }</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    llvm_unreachable(<span class="stringliteral">&quot;not a CallExpr or CXXNewExpr&quot;</span>);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160; </div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  assert(Arg);</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="keyword">auto</span> DefArgVal =</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;getSVal(Arg, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getLocationContext()).getAs&lt;DefinedSVal&gt;();</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="keywordflow">if</span> (!DefArgVal)</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160; </div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="comment">// Check if the allocation size is 0.</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> TrueState, FalseState;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  SValBuilder &amp;SvalBuilder = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;getStateManager().getSValBuilder();</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  DefinedSVal <a class="code" href="namespaceclang_1_1interp.html#a7b1ae11a0392cdbd2fc33ba108d4cfd3">Zero</a> =</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      SvalBuilder.makeZeroVal(Arg-&gt;<a class="code" href="classclang_1_1Expr.html#ac9bfcc699442f2093723cfcf703d9f47">getType</a>()).castAs&lt;DefinedSVal&gt;();</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  std::tie(TrueState, FalseState) =</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;assume(SvalBuilder.evalEQ(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, *DefArgVal, <a class="code" href="namespaceclang_1_1interp.html#a7b1ae11a0392cdbd2fc33ba108d4cfd3">Zero</a>));</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="keywordflow">if</span> (TrueState &amp;&amp; !FalseState) {</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym = RetVal-&gt;getAsLocSymbol();</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="keywordflow">if</span> (!Sym)</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <span class="keyword">const</span> RefState *RS = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;get&lt;RegionState&gt;(Sym);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <span class="keywordflow">if</span> (RS) {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      <span class="keywordflow">if</span> (RS-&gt;isAllocated())</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        <span class="keywordflow">return</span> TrueState-&gt;set&lt;RegionState&gt;(Sym,</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                                          RefState::getAllocatedOfSizeZero(RS));</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      <span class="comment">// Case of zero-size realloc. Historically &#39;realloc(ptr, 0)&#39; is treated as</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      <span class="comment">// &#39;free(ptr)&#39; and the returned value from &#39;realloc(ptr, 0)&#39; is not</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      <span class="comment">// tracked. Add zero-reallocated Sym to the state to catch references</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      <span class="comment">// to zero-allocated memory.</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <span class="keywordflow">return</span> TrueState-&gt;add&lt;ReallocSizeZeroSymbols&gt;(Sym);</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    }</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  }</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="comment">// Assume the value is non-zero going forward.</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  assert(FalseState);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="keywordflow">return</span> FalseState;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;}</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#a29f56489e8bb504772dd89c914a7219e"> 1578</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classclang_1_1QualType.html">QualType</a> <a class="code" href="MallocChecker_8cpp.html#a29f56489e8bb504772dd89c914a7219e">getDeepPointeeType</a>(<a class="code" href="classclang_1_1QualType.html">QualType</a> T) {</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <a class="code" href="classclang_1_1QualType.html">QualType</a> Result = T, PointeeType = T-&gt;<a class="code" href="classclang_1_1Type.html#a56c474868f4027b847f181f99b226f47">getPointeeType</a>();</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  <span class="keywordflow">while</span> (!PointeeType.isNull()) {</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    Result = PointeeType;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    PointeeType = PointeeType-&gt;getPointeeType();</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  }</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  <span class="keywordflow">return</span> Result;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;}</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">/// \returns true if the constructor invoked by \p NE has an argument of a</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">/// pointer/reference to a record type.</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#a1ba9eb5ec8a5cdfc494cce155f7c868c"> 1589</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#a1ba9eb5ec8a5cdfc494cce155f7c868c">hasNonTrivialConstructorCall</a>(<span class="keyword">const</span> <a class="code" href="classclang_1_1CXXNewExpr.html">CXXNewExpr</a> *<a class="code" href="namespaceclang_1_1interp.html#a4722429e794a3d193b85f859eef008a1">NE</a>) {</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1CXXConstructExpr.html">CXXConstructExpr</a> *ConstructE = <a class="code" href="namespaceclang_1_1interp.html#a4722429e794a3d193b85f859eef008a1">NE</a>-&gt;getConstructExpr();</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="keywordflow">if</span> (!ConstructE)</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160; </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespaceclang_1_1interp.html#a4722429e794a3d193b85f859eef008a1">NE</a>-&gt;getAllocatedType()-&gt;getAsCXXRecordDecl())</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1CXXConstructorDecl.html">CXXConstructorDecl</a> *CtorD = ConstructE-&gt;<a class="code" href="classclang_1_1CXXConstructExpr.html#adf45575cd1a16e246bdcfb89d5c45d1c">getConstructor</a>();</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160; </div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  <span class="comment">// Iterate over the constructor parameters.</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *CtorParam : CtorD-&gt;<a class="code" href="classclang_1_1FunctionDecl.html#ab95c29a19de7d1c1e967d59cdbac2dcc">parameters</a>()) {</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160; </div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <a class="code" href="classclang_1_1QualType.html">QualType</a> CtorParamPointeeT = CtorParam-&gt;getType()-&gt;<a class="code" href="classclang_1_1Type.html#a56c474868f4027b847f181f99b226f47">getPointeeType</a>();</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="keywordflow">if</span> (CtorParamPointeeT.<a class="code" href="classclang_1_1QualType.html#a54127635d2ca4754e91ee96b594eff74">isNull</a>())</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160; </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    CtorParamPointeeT = <a class="code" href="MallocChecker_8cpp.html#a29f56489e8bb504772dd89c914a7219e">getDeepPointeeType</a>(CtorParamPointeeT);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordflow">if</span> (CtorParamPointeeT-&gt;<a class="code" href="classclang_1_1Type.html#a0506d2fd1e686757c62a2b1aa3f9de8d">getAsCXXRecordDecl</a>())</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  }</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160; </div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;}</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;MallocChecker::processNewAllocation(<span class="keyword">const</span> CXXAllocatorCall &amp;Call,</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                                    CheckerContext &amp;C,</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                                    AllocationFamily Family)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="MallocChecker_8cpp.html#ae6533c7f9026cf098295dadb134506d7">isStandardNewDelete</a>(Call))</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160; </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1CXXNewExpr.html">CXXNewExpr</a> *<a class="code" href="namespaceclang_1_1interp.html#a4722429e794a3d193b85f859eef008a1">NE</a> = <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getOriginExpr();</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1ParentMap.html">ParentMap</a> &amp;PM = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getLocationContext()-&gt;getParentMap();</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160; </div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <span class="comment">// Non-trivial constructors have a chance to escape &#39;this&#39;, but marking all</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="comment">// invocations of trivial constructors as escaped would cause too great of</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <span class="comment">// reduction of true positives, so let&#39;s just do that for constructors that</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <span class="comment">// have an argument of a pointer-to-record type.</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="keywordflow">if</span> (!PM.<a class="code" href="classclang_1_1ParentMap.html#a1019668ec664a33b4d9d51b169493a3a">isConsumedExpr</a>(<a class="code" href="namespaceclang_1_1interp.html#a4722429e794a3d193b85f859eef008a1">NE</a>) &amp;&amp; <a class="code" href="MallocChecker_8cpp.html#a1ba9eb5ec8a5cdfc494cce155f7c868c">hasNonTrivialConstructorCall</a>(<a class="code" href="namespaceclang_1_1interp.html#a4722429e794a3d193b85f859eef008a1">NE</a>))</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  <span class="comment">// The return value from operator new is bound to a specified initialization</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  <span class="comment">// value (if any) and we don&#39;t want to loose this value. So we call</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <span class="comment">// MallocUpdateRefState() instead of MallocMemAux() which breaks the</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  <span class="comment">// existing binding.</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  SVal <a class="code" href="namespaceclang.html#acdf88ec6c845aa781824469fcb0af66cac41a31890959544c6523af684561abe5">Target</a> = <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getObjectUnderConstruction();</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="MallocChecker_8cpp.html#a923124dcac9f30d5c9d80541135f5d1e">MallocUpdateRefState</a>(C, <a class="code" href="namespaceclang_1_1interp.html#a4722429e794a3d193b85f859eef008a1">NE</a>, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, Family, Target);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = ProcessZeroAllocCheck(Call, 0, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, Target);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;}</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160; </div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkNewAllocator(<span class="keyword">const</span> CXXAllocatorCall &amp;Call,</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                                      CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.wasInlined) {</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = processNewAllocation(</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        Call, C,</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        (<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getOriginExpr()-&gt;isArray() ? AF_CXXNewArray : AF_CXXNew));</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  }</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;}</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160; </div>
<div class="line"><a name="l01654"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#ae1e7389f740cf97f5021b0c02a795abd"> 1654</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#ae1e7389f740cf97f5021b0c02a795abd">isKnownDeallocObjCMethodName</a>(<span class="keyword">const</span> ObjCMethodCall &amp;Call) {</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <span class="comment">// If the first selector piece is one of the names below, assume that the</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <span class="comment">// object takes ownership of the memory, promising to eventually deallocate it</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="comment">// with free().</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  <span class="comment">// Ex:  [NSData dataWithBytesNoCopy:bytes length:10];</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;  <span class="comment">// (...unless a &#39;freeWhenDone&#39; parameter is false, but that&#39;s checked later.)</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  StringRef FirstSlot = Call.getSelector().getNameForSlot(0);</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="keywordflow">return</span> FirstSlot == <span class="stringliteral">&quot;dataWithBytesNoCopy&quot;</span> ||</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;         FirstSlot == <span class="stringliteral">&quot;initWithBytesNoCopy&quot;</span> ||</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;         FirstSlot == <span class="stringliteral">&quot;initWithCharactersNoCopy&quot;</span>;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;}</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160; </div>
<div class="line"><a name="l01666"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#abc20428bd6d598274e9deea1e5e0d068"> 1666</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Optional.html">Optional&lt;bool&gt;</a> <a class="code" href="MallocChecker_8cpp.html#abc20428bd6d598274e9deea1e5e0d068">getFreeWhenDoneArg</a>(<span class="keyword">const</span> ObjCMethodCall &amp;Call) {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <a class="code" href="classclang_1_1Selector.html">Selector</a> S = Call.getSelector();</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160; </div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="comment">// FIXME: We should not rely on fully-constrained symbols being folded.</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 1; i &lt; S.getNumArgs(); ++i)</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordflow">if</span> (S.getNameForSlot(i).equals(<span class="stringliteral">&quot;freeWhenDone&quot;</span>))</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;      <span class="keywordflow">return</span> !Call.getArgSVal(i).isZeroConstant();</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160; </div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  <span class="keywordflow">return</span> None;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;}</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160; </div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkPostObjCMessage(<span class="keyword">const</span> ObjCMethodCall &amp;Call,</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                                         CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.wasInlined)</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160; </div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="MallocChecker_8cpp.html#ae1e7389f740cf97f5021b0c02a795abd">isKnownDeallocObjCMethodName</a>(Call))</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160; </div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Optional.html">Optional&lt;bool&gt;</a> FreeWhenDone = <a class="code" href="MallocChecker_8cpp.html#abc20428bd6d598274e9deea1e5e0d068">getFreeWhenDoneArg</a>(Call))</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="keywordflow">if</span> (!*FreeWhenDone)</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; </div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.hasNonZeroCallbackArg())</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160; </div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  <span class="keywordtype">bool</span> IsKnownToBeAllocatedMemory;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> =</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      FreeMemAux(C, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(0), Call, <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState(),</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                 <span class="comment">/*Hold=*/</span><span class="keyword">true</span>, IsKnownToBeAllocatedMemory, AF_Malloc,</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                 <span class="comment">/*ReturnsNullOnFailure=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160; </div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;}</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160; </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;MallocChecker::MallocMemReturnsAttr(CheckerContext &amp;C, <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                                    <span class="keyword">const</span> OwnershipAttr *Att,</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                                    <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>)</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160; </div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <span class="keywordflow">if</span> (Att-&gt;getModule()-&gt;getName() != <span class="stringliteral">&quot;malloc&quot;</span>)</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160; </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  OwnershipAttr::args_iterator I = Att-&gt;args_begin(), E = Att-&gt;args_end();</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="keywordflow">if</span> (I != E) {</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="keywordflow">return</span> MallocMemAux(C, Call, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(I-&gt;getASTIndex()),</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                        UndefinedVal(), <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, AF_Malloc);</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  }</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <span class="keywordflow">return</span> MallocMemAux(C, Call, UnknownVal(), UndefinedVal(), <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, AF_Malloc);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;}</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160; </div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocChecker::MallocMemAux(CheckerContext &amp;C,</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                                            <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *SizeEx, SVal Init,</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                                            <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                                            AllocationFamily Family) {</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>)</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  assert(SizeEx);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <span class="keywordflow">return</span> MallocMemAux(C, Call, <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(SizeEx), Init, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, Family);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;}</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocChecker::MallocMemAux(CheckerContext &amp;C,</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                                            <span class="keyword">const</span> CallEvent &amp;Call, SVal Size,</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                                            SVal Init, <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                                            AllocationFamily Family) {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>)</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *CE = <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getOriginExpr();</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160; </div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <span class="comment">// We expect the malloc functions to return a pointer.</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classclang_1_1ento_1_1Loc.html#ade52f99777d7f54628cdac05e9992878">Loc::isLocType</a>(CE-&gt;<a class="code" href="classclang_1_1Expr.html#ac9bfcc699442f2093723cfcf703d9f47">getType</a>()))</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160; </div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="comment">// Bind the return value to the symbolic value from the heap region.</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="comment">// TODO: We could rewrite post visit to eval call; &#39;malloc&#39; does not have</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <span class="comment">// side effects other than what we model here.</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  <span class="keywordtype">unsigned</span> Count = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.blockCount();</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  SValBuilder &amp;svalBuilder = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSValBuilder();</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1LocationContext.html">LocationContext</a> *LCtx = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getPredecessor()-&gt;getLocationContext();</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  DefinedSVal RetVal = svalBuilder.getConjuredHeapSymbolVal(CE, LCtx, Count)</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      .castAs&lt;DefinedSVal&gt;();</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;BindExpr(CE, <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getLocationContext(), RetVal);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160; </div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="comment">// Fill the region with the initialization value.</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;bindDefaultInitial(RetVal, Init, LCtx);</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160; </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <span class="comment">// Set the region&#39;s extent.</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceclang_1_1ento.html#aec69b4d8a2399220a5c7df7b4f0534c0">setDynamicExtent</a>(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, RetVal.getAsRegion(),</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                           <a class="code" href="namespaceclang_1_1syntax.html#a0d10149d69e32e3c86140b4d325925e5a6f6cb72d544962fa333e2e34ce64f719">Size</a>.castAs&lt;DefinedOrUnknownSVal&gt;(), svalBuilder);</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160; </div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="MallocChecker_8cpp.html#a923124dcac9f30d5c9d80541135f5d1e">MallocUpdateRefState</a>(C, CE, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, Family);</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;}</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160; </div>
<div class="line"><a name="l01764"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#a923124dcac9f30d5c9d80541135f5d1e"> 1764</a></span>&#160;<span class="keyword">static</span> <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="MallocChecker_8cpp.html#a923124dcac9f30d5c9d80541135f5d1e">MallocUpdateRefState</a>(CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *E,</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                                            <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                                            AllocationFamily Family,</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                                            <a class="code" href="classllvm_1_1Optional.html">Optional&lt;SVal&gt;</a> RetVal) {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>)</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160; </div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <span class="comment">// Get the return value.</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="keywordflow">if</span> (!RetVal)</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    RetVal = C.getSVal(E);</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <span class="comment">// We expect the malloc functions to return a pointer.</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  <span class="keywordflow">if</span> (!RetVal-&gt;getAs&lt;Loc&gt;())</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160; </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym = RetVal-&gt;getAsLocSymbol();</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <span class="comment">// This is a return value of a function that was not inlined, such as malloc()</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <span class="comment">// or new(). We&#39;ve checked that in the caller. Therefore, it must be a symbol.</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  assert(Sym);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <span class="comment">// Set the symbol&#39;s state to Allocated.</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;set&lt;RegionState&gt;(Sym, RefState::getAllocated(Family, E));</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;}</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160; </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocChecker::FreeMemAttr(CheckerContext &amp;C,</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                                           <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                                           <span class="keyword">const</span> OwnershipAttr *Att,</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                                           <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>)</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; </div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <span class="keywordflow">if</span> (Att-&gt;getModule()-&gt;getName() != <span class="stringliteral">&quot;malloc&quot;</span>)</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="keywordtype">bool</span> IsKnownToBeAllocated = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;Arg : Att-&gt;args()) {</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> StateI =</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        FreeMemAux(C, Call, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, Arg.getASTIndex(),</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                   Att-&gt;getOwnKind() == OwnershipAttr::Holds,</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                   IsKnownToBeAllocated, AF_Malloc);</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="keywordflow">if</span> (StateI)</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = StateI;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  }</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;}</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160; </div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocChecker::FreeMemAux(CheckerContext &amp;C,</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                                          <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                                          <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, <span class="keywordtype">unsigned</span> Num,</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                                          <span class="keywordtype">bool</span> Hold, <span class="keywordtype">bool</span> &amp;IsKnownToBeAllocated,</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                                          AllocationFamily Family,</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                                          <span class="keywordtype">bool</span> ReturnsNullOnFailure)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>)</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160; </div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getNumArgs() &lt; (Num + 1))</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160; </div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <span class="keywordflow">return</span> FreeMemAux(C, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(Num), Call, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, Hold,</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                    IsKnownToBeAllocated, Family, ReturnsNullOnFailure);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;}</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="comment">/// Checks if the previous call to free on the given symbol failed - if free</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="comment">/// failed, returns true. Also, returns the corresponding return value symbol.</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#abccf363be7226f4596aa265e9d055f56"> 1829</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#abccf363be7226f4596aa265e9d055f56">didPreviousFreeFail</a>(<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                                <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> &amp;RetStatusSymbol) {</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> *<a class="code" href="Interp_8cpp.html#a7366213a28ea9f41665f7fd8752f4318">Ret</a> = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;get&lt;FreeReturnValue&gt;(Sym);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="Interp_8cpp.html#a7366213a28ea9f41665f7fd8752f4318">Ret</a>) {</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    assert(*<a class="code" href="Interp_8cpp.html#a7366213a28ea9f41665f7fd8752f4318">Ret</a> &amp;&amp; <span class="stringliteral">&quot;We should not store the null return symbol&quot;</span>);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    ConstraintManager &amp;CMgr = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;getConstraintManager();</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    ConditionTruthVal FreeFailed = CMgr.isNull(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, *<a class="code" href="Interp_8cpp.html#a7366213a28ea9f41665f7fd8752f4318">Ret</a>);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    RetStatusSymbol = *<a class="code" href="Interp_8cpp.html#a7366213a28ea9f41665f7fd8752f4318">Ret</a>;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="keywordflow">return</span> FreeFailed.isConstrainedTrue();</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  }</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;}</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; </div>
<div class="line"><a name="l01842"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#ad2cfc698611276d3cd573c5a52a2fd84"> 1842</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#ad2cfc698611276d3cd573c5a52a2fd84">printMemFnName</a>(raw_ostream &amp;os, CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *E) {</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE = dyn_cast&lt;CallExpr&gt;(E)) {</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="comment">// FIXME: This doesn&#39;t handle indirect calls.</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *FD = CE-&gt;getDirectCallee();</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="keywordflow">if</span> (!FD)</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160; </div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    os &lt;&lt; *FD;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordflow">if</span> (!FD-&gt;isOverloadedOperator())</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;()&quot;</span>;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160; </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1ObjCMessageExpr.html">ObjCMessageExpr</a> *Msg = dyn_cast&lt;ObjCMessageExpr&gt;(E)) {</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordflow">if</span> (Msg-&gt;isInstanceMessage())</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;+&quot;</span>;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    Msg-&gt;getSelector().<a class="code" href="classclang_1_1Decl.html#ad5bf0172af87a4324b9c8204206270d5">print</a>(os);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1CXXNewExpr.html">CXXNewExpr</a> *<a class="code" href="namespaceclang_1_1interp.html#a4722429e794a3d193b85f859eef008a1">NE</a> = dyn_cast&lt;CXXNewExpr&gt;(E)) {</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;       &lt;&lt; <a class="code" href="namespaceclang.html#ae74346a5140f24995931cd3c4104e202">getOperatorSpelling</a>(<a class="code" href="namespaceclang_1_1interp.html#a4722429e794a3d193b85f859eef008a1">NE</a>-&gt;getOperatorNew()-&gt;getOverloadedOperator())</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160; </div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1CXXDeleteExpr.html">CXXDeleteExpr</a> *DE = dyn_cast&lt;CXXDeleteExpr&gt;(E)) {</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;       &lt;&lt; <a class="code" href="namespaceclang.html#ae74346a5140f24995931cd3c4104e202">getOperatorSpelling</a>(DE-&gt;getOperatorDelete()-&gt;getOverloadedOperator())</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  }</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160; </div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;}</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#a2aaae9c4c3f7405c8d3f21ea8d34722d"> 1881</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="MallocChecker_8cpp.html#a2aaae9c4c3f7405c8d3f21ea8d34722d">printExpectedAllocName</a>(raw_ostream &amp;os, AllocationFamily Family) {</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160; </div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;  <span class="keywordflow">switch</span>(Family) {</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="keywordflow">case</span> AF_Malloc: os &lt;&lt; <span class="stringliteral">&quot;malloc()&quot;</span>; <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="keywordflow">case</span> AF_CXXNew: os &lt;&lt; <span class="stringliteral">&quot;&#39;new&#39;&quot;</span>; <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="keywordflow">case</span> AF_CXXNewArray: os &lt;&lt; <span class="stringliteral">&quot;&#39;new[]&#39;&quot;</span>; <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="keywordflow">case</span> AF_IfNameIndex: os &lt;&lt; <span class="stringliteral">&quot;&#39;if_nameindex()&#39;&quot;</span>; <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="keywordflow">case</span> AF_InnerBuffer: os &lt;&lt; <span class="stringliteral">&quot;container-specific allocator&quot;</span>; <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="keywordflow">case</span> AF_Alloca:</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="keywordflow">case</span> AF_None: llvm_unreachable(<span class="stringliteral">&quot;not a deallocation expression&quot;</span>);</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  }</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;}</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160; </div>
<div class="line"><a name="l01894"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#aa60484f1d307e45c137f948c0d0976ae"> 1894</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="MallocChecker_8cpp.html#aa60484f1d307e45c137f948c0d0976ae">printExpectedDeallocName</a>(raw_ostream &amp;os, AllocationFamily Family) {</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <span class="keywordflow">switch</span>(Family) {</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordflow">case</span> AF_Malloc: os &lt;&lt; <span class="stringliteral">&quot;free()&quot;</span>; <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="keywordflow">case</span> AF_CXXNew: os &lt;&lt; <span class="stringliteral">&quot;&#39;delete&#39;&quot;</span>; <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordflow">case</span> AF_CXXNewArray: os &lt;&lt; <span class="stringliteral">&quot;&#39;delete[]&#39;&quot;</span>; <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordflow">case</span> AF_IfNameIndex: os &lt;&lt; <span class="stringliteral">&quot;&#39;if_freenameindex()&#39;&quot;</span>; <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <span class="keywordflow">case</span> AF_InnerBuffer: os &lt;&lt; <span class="stringliteral">&quot;container-specific deallocator&quot;</span>; <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="keywordflow">case</span> AF_Alloca:</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="keywordflow">case</span> AF_None: llvm_unreachable(<span class="stringliteral">&quot;suspicious argument&quot;</span>);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  }</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;}</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160; </div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocChecker::FreeMemAux(</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    CheckerContext &amp;C, <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *ArgExpr, <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, <span class="keywordtype">bool</span> Hold, <span class="keywordtype">bool</span> &amp;IsKnownToBeAllocated,</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    AllocationFamily Family, <span class="keywordtype">bool</span> ReturnsNullOnFailure)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160; </div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>)</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160; </div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  SVal ArgVal = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(ArgExpr);</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  <span class="keywordflow">if</span> (!ArgVal.getAs&lt;DefinedOrUnknownSVal&gt;())</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  DefinedOrUnknownSVal location = ArgVal.castAs&lt;DefinedOrUnknownSVal&gt;();</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160; </div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  <span class="comment">// Check for null dereferences.</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  <span class="keywordflow">if</span> (!location.getAs&lt;Loc&gt;())</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160; </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;  <span class="comment">// The explicit NULL case, no operation is performed.</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> notNullState, nullState;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  std::tie(notNullState, nullState) = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;assume(location);</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <span class="keywordflow">if</span> (nullState &amp;&amp; !notNullState)</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160; </div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  <span class="comment">// Unknown values could easily be okay</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  <span class="comment">// Undefined values are handled elsewhere</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  <span class="keywordflow">if</span> (ArgVal.isUnknownOrUndef())</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160; </div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <span class="keyword">const</span> MemRegion *R = ArgVal.getAsRegion();</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *ParentExpr = <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getOriginExpr();</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160; </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  <span class="comment">// NOTE: We detected a bug, but the checker under whose name we would emit the</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  <span class="comment">// error could be disabled. Generally speaking, the MallocChecker family is an</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <span class="comment">// integral part of the Static Analyzer, and disabling any part of it should</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  <span class="comment">// only be done under exceptional circumstances, such as frequent false</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="comment">// positives. If this is the case, we can reasonably believe that there are</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <span class="comment">// serious faults in our understanding of the source code, and even if we</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="comment">// don&#39;t emit an warning, we should terminate further analysis with a sink</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  <span class="comment">// node.</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160; </div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  <span class="comment">// Nonlocs can&#39;t be freed, of course.</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <span class="comment">// Non-region locations (labels and fixed addresses) also shouldn&#39;t be freed.</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="keywordflow">if</span> (!R) {</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="comment">// Exception:</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="comment">// If the macro ZERO_SIZE_PTR is defined, this could be a kernel source</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="comment">// code. In that case, the ZERO_SIZE_PTR defines a special value used for a</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="comment">// zero-sized memory block which is allowed to be freed, despite not being a</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="comment">// null pointer.</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="keywordflow">if</span> (Family != AF_Malloc || !isArgZERO_SIZE_PTR(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, C, ArgVal))</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      HandleNonHeapDealloc(C, ArgVal, ArgExpr-&gt;<a class="code" href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">getSourceRange</a>(), ParentExpr,</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                           Family);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  }</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160; </div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  R = R-&gt;StripCasts();</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  <span class="comment">// Blocks might show up as heap data, but should not be free()d</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="keywordflow">if</span> (isa&lt;BlockDataRegion&gt;(R)) {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    HandleNonHeapDealloc(C, ArgVal, ArgExpr-&gt;<a class="code" href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">getSourceRange</a>(), ParentExpr,</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                         Family);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  }</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  <span class="keyword">const</span> MemSpaceRegion *MS = R-&gt;getMemorySpace();</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  <span class="comment">// Parameters, locals, statics, globals, and memory returned by</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  <span class="comment">// __builtin_alloca() shouldn&#39;t be freed.</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;UnknownSpaceRegion, HeapSpaceRegion&gt;(MS)) {</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="comment">// FIXME: at the time this code was written, malloc() regions were</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="comment">// represented by conjured symbols, which are all in UnknownSpaceRegion.</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="comment">// This means that there isn&#39;t actually anything from HeapSpaceRegion</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="comment">// that should be freed, even though we allow it here.</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="comment">// Of course, free() can work on memory allocated outside the current</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="comment">// function, so UnknownSpaceRegion is always a possibility.</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="comment">// False negatives are better than false positives.</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160; </div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="keywordflow">if</span> (isa&lt;AllocaRegion&gt;(R))</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;      HandleFreeAlloca(C, ArgVal, ArgExpr-&gt;<a class="code" href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">getSourceRange</a>());</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      HandleNonHeapDealloc(C, ArgVal, ArgExpr-&gt;<a class="code" href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">getSourceRange</a>(), ParentExpr,</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                           Family);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160; </div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  }</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  <span class="keyword">const</span> SymbolicRegion *SrBase = dyn_cast&lt;SymbolicRegion&gt;(R-&gt;getBaseRegion());</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  <span class="comment">// Various cases could lead to non-symbol values here.</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;  <span class="comment">// For now, ignore them.</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  <span class="keywordflow">if</span> (!SrBase)</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160; </div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> SymBase = SrBase-&gt;getSymbol();</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  <span class="keyword">const</span> RefState *RsBase = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;get&lt;RegionState&gt;(SymBase);</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> PreviousRetStatusSymbol = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  IsKnownToBeAllocated =</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      RsBase &amp;&amp; (RsBase-&gt;isAllocated() || RsBase-&gt;isAllocatedOfSizeZero());</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160; </div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <span class="keywordflow">if</span> (RsBase) {</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160; </div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <span class="comment">// Memory returned by alloca() shouldn&#39;t be freed.</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <span class="keywordflow">if</span> (RsBase-&gt;getAllocationFamily() == AF_Alloca) {</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      HandleFreeAlloca(C, ArgVal, ArgExpr-&gt;<a class="code" href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">getSourceRange</a>());</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160; </div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <span class="comment">// Check for double free first.</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="keywordflow">if</span> ((RsBase-&gt;isReleased() || RsBase-&gt;isRelinquished()) &amp;&amp;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        !<a class="code" href="MallocChecker_8cpp.html#abccf363be7226f4596aa265e9d055f56">didPreviousFreeFail</a>(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, SymBase, PreviousRetStatusSymbol)) {</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      HandleDoubleFree(C, ParentExpr-&gt;<a class="code" href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">getSourceRange</a>(), RsBase-&gt;isReleased(),</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                       SymBase, PreviousRetStatusSymbol);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160; </div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="comment">// If the pointer is allocated or escaped, but we are now trying to free it,</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="comment">// check that the call to free is proper.</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (RsBase-&gt;isAllocated() || RsBase-&gt;isAllocatedOfSizeZero() ||</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;               RsBase-&gt;isEscaped()) {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      <span class="comment">// Check if an expected deallocation function matches the real one.</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      <span class="keywordtype">bool</span> DeallocMatchesAlloc = RsBase-&gt;getAllocationFamily() == Family;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      <span class="keywordflow">if</span> (!DeallocMatchesAlloc) {</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        HandleMismatchedDealloc(C, ArgExpr-&gt;<a class="code" href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">getSourceRange</a>(), ParentExpr,</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                                RsBase, SymBase, Hold);</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;      }</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160; </div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      <span class="comment">// Check if the memory location being freed is the actual location</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      <span class="comment">// allocated, or an offset.</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      RegionOffset <a class="code" href="Format_8cpp.html#a9fcf84dffafb0ea03c0f9b686ddbf2b3">Offset</a> = R-&gt;getAsOffset();</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="Format_8cpp.html#a9fcf84dffafb0ea03c0f9b686ddbf2b3">Offset</a>.isValid() &amp;&amp;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;          !<a class="code" href="Format_8cpp.html#a9fcf84dffafb0ea03c0f9b686ddbf2b3">Offset</a>.hasSymbolicOffset() &amp;&amp;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;          <a class="code" href="Format_8cpp.html#a9fcf84dffafb0ea03c0f9b686ddbf2b3">Offset</a>.getOffset() != 0) {</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *AllocExpr = cast&lt;Expr&gt;(RsBase-&gt;getStmt());</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        HandleOffsetFree(C, ArgVal, ArgExpr-&gt;<a class="code" href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">getSourceRange</a>(), ParentExpr,</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                         Family, AllocExpr);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      }</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    }</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;  }</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160; </div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <span class="keywordflow">if</span> (SymBase-&gt;getType()-&gt;isFunctionPointerType()) {</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    HandleFunctionPtrFree(C, ArgVal, ArgExpr-&gt;<a class="code" href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">getSourceRange</a>(), ParentExpr,</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                          Family);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  }</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; </div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  <span class="comment">// Clean out the info on previous call to free return info.</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;remove&lt;FreeReturnValue&gt;(SymBase);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <span class="comment">// Keep track of the return value. If it is NULL, we will know that free</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <span class="comment">// failed.</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <span class="keywordflow">if</span> (ReturnsNullOnFailure) {</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    SVal RetVal = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(ParentExpr);</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> RetStatusSymbol = RetVal.getAsSymbol();</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="keywordflow">if</span> (RetStatusSymbol) {</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSymbolManager().addSymbolDependency(SymBase, RetStatusSymbol);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;set&lt;FreeReturnValue&gt;(SymBase, RetStatusSymbol);</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  }</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; </div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  <span class="comment">// If we don&#39;t know anything about this symbol, a free on it may be totally</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  <span class="comment">// valid. If this is the case, lets assume that the allocation family of the</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <span class="comment">// freeing function is the same as the symbols allocation family, and go with</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  <span class="comment">// that.</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  assert(!RsBase || (RsBase &amp;&amp; RsBase-&gt;getAllocationFamily() == Family));</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; </div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="comment">// Normal free.</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  <span class="keywordflow">if</span> (Hold)</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;set&lt;RegionState&gt;(SymBase,</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                                   RefState::getRelinquished(Family,</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                                                             ParentExpr));</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;set&lt;RegionState&gt;(SymBase,</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                                 RefState::getReleased(Family, ParentExpr));</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;}</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160; </div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<a class="code" href="classllvm_1_1Optional.html">Optional&lt;MallocChecker::CheckKind&gt;</a></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;MallocChecker::getCheckIfTracked(AllocationFamily Family,</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                                 <span class="keywordtype">bool</span> IsALeakCheck)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="keywordflow">switch</span> (Family) {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  <span class="keywordflow">case</span> AF_Malloc:</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  <span class="keywordflow">case</span> AF_Alloca:</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="keywordflow">case</span> AF_IfNameIndex: {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <span class="keywordflow">if</span> (ChecksEnabled[CK_MallocChecker])</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;      <span class="keywordflow">return</span> CK_MallocChecker;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1XRayInstrKind.html#a74957f939e9c2b26d53095846a926c34">None</a>;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  }</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  <span class="keywordflow">case</span> AF_CXXNew:</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  <span class="keywordflow">case</span> AF_CXXNewArray: {</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="keywordflow">if</span> (IsALeakCheck) {</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      <span class="keywordflow">if</span> (ChecksEnabled[CK_NewDeleteLeaksChecker])</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        <span class="keywordflow">return</span> CK_NewDeleteLeaksChecker;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    }</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;      <span class="keywordflow">if</span> (ChecksEnabled[CK_NewDeleteChecker])</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        <span class="keywordflow">return</span> CK_NewDeleteChecker;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    }</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1XRayInstrKind.html#a74957f939e9c2b26d53095846a926c34">None</a>;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  }</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <span class="keywordflow">case</span> AF_InnerBuffer: {</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="keywordflow">if</span> (ChecksEnabled[CK_InnerPointerChecker])</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;      <span class="keywordflow">return</span> CK_InnerPointerChecker;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1XRayInstrKind.html#a74957f939e9c2b26d53095846a926c34">None</a>;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  }</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  <span class="keywordflow">case</span> AF_None: {</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    llvm_unreachable(<span class="stringliteral">&quot;no family&quot;</span>);</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  }</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  }</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  llvm_unreachable(<span class="stringliteral">&quot;unhandled family&quot;</span>);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;}</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<a class="code" href="classllvm_1_1Optional.html">Optional&lt;MallocChecker::CheckKind&gt;</a></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;MallocChecker::getCheckIfTracked(CheckerContext &amp;C, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym,</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                                 <span class="keywordtype">bool</span> IsALeakCheck)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState()-&gt;contains&lt;ReallocSizeZeroSymbols&gt;(Sym))</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <span class="keywordflow">return</span> CK_MallocChecker;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160; </div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  <span class="keyword">const</span> RefState *RS = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState()-&gt;get&lt;RegionState&gt;(Sym);</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  assert(RS);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  <span class="keywordflow">return</span> getCheckIfTracked(RS-&gt;getAllocationFamily(), IsALeakCheck);</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;}</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160; </div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="keywordtype">bool</span> MallocChecker::SummarizeValue(raw_ostream &amp;os, SVal <a class="code" href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a>) {</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Optional.html">Optional&lt;nonloc::ConcreteInt&gt;</a> IntVal = <a class="code" href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a>.getAs&lt;nonloc::ConcreteInt&gt;())</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;an integer (&quot;</span> &lt;&lt; IntVal-&gt;getValue() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Optional.html">Optional&lt;loc::ConcreteInt&gt;</a> ConstAddr = <a class="code" href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a>.getAs&lt;loc::ConcreteInt&gt;())</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;a constant address (&quot;</span> &lt;&lt; ConstAddr-&gt;getValue() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Optional.html">Optional&lt;loc::GotoLabel&gt;</a> <a class="code" href="UsingDeclarationsSorter_8cpp.html#aec13ba851f7e3aa70f5f3960f5d14324">Label</a> = <a class="code" href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a>.getAs&lt;loc::GotoLabel&gt;())</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;the address of the label &#39;&quot;</span> &lt;&lt; <a class="code" href="UsingDeclarationsSorter_8cpp.html#aec13ba851f7e3aa70f5f3960f5d14324">Label</a>-&gt;getLabel()-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160; </div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;}</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="keywordtype">bool</span> MallocChecker::SummarizeRegion(raw_ostream &amp;os,</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                                    <span class="keyword">const</span> MemRegion *MR) {</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="keywordflow">switch</span> (MR-&gt;getKind()) {</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  <span class="keywordflow">case</span> MemRegion::FunctionCodeRegionKind: {</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <span class="keyword">const</span> <a class="code" href="classclang_1_1NamedDecl.html">NamedDecl</a> *FD = cast&lt;FunctionCodeRegion&gt;(MR)-&gt;getDecl();</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <span class="keywordflow">if</span> (FD)</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;the address of the function &#39;&quot;</span> &lt;&lt; *FD &lt;&lt; <span class="charliteral">&#39;\&#39;&#39;</span>;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;the address of a function&quot;</span>;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  }</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="keywordflow">case</span> MemRegion::BlockCodeRegionKind:</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;block text&quot;</span>;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="keywordflow">case</span> MemRegion::BlockDataRegionKind:</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="comment">// FIXME: where the block came from?</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;a block&quot;</span>;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="keyword">const</span> MemSpaceRegion *MS = MR-&gt;getMemorySpace();</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160; </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="keywordflow">if</span> (isa&lt;StackLocalsSpaceRegion&gt;(MS)) {</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      <span class="keyword">const</span> VarRegion *VR = dyn_cast&lt;VarRegion&gt;(MR);</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      <span class="keyword">const</span> <a class="code" href="classclang_1_1VarDecl.html">VarDecl</a> *VD;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      <span class="keywordflow">if</span> (VR)</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        VD = VR-&gt;getDecl();</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;        VD = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160; </div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <span class="keywordflow">if</span> (VD)</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;the address of the local variable &#39;&quot;</span> &lt;&lt; VD-&gt;<a class="code" href="classclang_1_1NamedDecl.html#a350fd0415d5f387716d5a970b9de4c29">getName</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;the address of a local stack variable&quot;</span>;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    }</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160; </div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="keywordflow">if</span> (isa&lt;StackArgumentsSpaceRegion&gt;(MS)) {</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;      <span class="keyword">const</span> VarRegion *VR = dyn_cast&lt;VarRegion&gt;(MR);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      <span class="keyword">const</span> <a class="code" href="classclang_1_1VarDecl.html">VarDecl</a> *VD;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      <span class="keywordflow">if</span> (VR)</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        VD = VR-&gt;getDecl();</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        VD = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160; </div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;      <span class="keywordflow">if</span> (VD)</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;the address of the parameter &#39;&quot;</span> &lt;&lt; VD-&gt;<a class="code" href="classclang_1_1NamedDecl.html#a350fd0415d5f387716d5a970b9de4c29">getName</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;the address of a parameter&quot;</span>;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    }</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160; </div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="keywordflow">if</span> (isa&lt;GlobalsSpaceRegion&gt;(MS)) {</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;      <span class="keyword">const</span> VarRegion *VR = dyn_cast&lt;VarRegion&gt;(MR);</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;      <span class="keyword">const</span> <a class="code" href="classclang_1_1VarDecl.html">VarDecl</a> *VD;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      <span class="keywordflow">if</span> (VR)</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;        VD = VR-&gt;getDecl();</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        VD = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160; </div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      <span class="keywordflow">if</span> (VD) {</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        <span class="keywordflow">if</span> (VD-&gt;<a class="code" href="classclang_1_1VarDecl.html#a896f5f64bcbbbb005414e1549a61b3b1">isStaticLocal</a>())</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;          os &lt;&lt; <span class="stringliteral">&quot;the address of the static variable &#39;&quot;</span> &lt;&lt; VD-&gt;<a class="code" href="classclang_1_1NamedDecl.html#a350fd0415d5f387716d5a970b9de4c29">getName</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;          os &lt;&lt; <span class="stringliteral">&quot;the address of the global variable &#39;&quot;</span> &lt;&lt; VD-&gt;<a class="code" href="classclang_1_1NamedDecl.html#a350fd0415d5f387716d5a970b9de4c29">getName</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;      } <span class="keywordflow">else</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;the address of a global variable&quot;</span>;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    }</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160; </div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  }</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;}</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;<span class="keywordtype">void</span> MallocChecker::HandleNonHeapDealloc(CheckerContext &amp;C, SVal ArgVal,</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                                         <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range,</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *DeallocExpr,</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                                         AllocationFamily Family)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160; </div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;  <span class="keywordflow">if</span> (!ChecksEnabled[CK_MallocChecker] &amp;&amp; !ChecksEnabled[CK_NewDeleteChecker]) {</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addSink();</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  }</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160; </div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;  <a class="code" href="classllvm_1_1Optional.html">Optional&lt;MallocChecker::CheckKind&gt;</a> CheckKind = getCheckIfTracked(Family);</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;  <span class="keywordflow">if</span> (!CheckKind.hasValue())</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160; </div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  <span class="keywordflow">if</span> (ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateErrorNode()) {</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="keywordflow">if</span> (!BT_BadFree[*CheckKind])</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      BT_BadFree[*CheckKind].reset(<span class="keyword">new</span> BugType(</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;          CheckNames[*CheckKind], <span class="stringliteral">&quot;Bad free&quot;</span>, <a class="code" href="namespaceclang_1_1ento_1_1categories.html#add9507b029ad01a3e38dd5de81803da9">categories::MemoryError</a>));</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160; </div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;100&gt;</a> buf;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    llvm::raw_svector_ostream os(buf);</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160; </div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    <span class="keyword">const</span> MemRegion *MR = ArgVal.getAsRegion();</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">const</span> ElementRegion *ER = dyn_cast_or_null&lt;ElementRegion&gt;(MR))</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      MR = ER-&gt;getSuperRegion();</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160; </div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Argument to &quot;</span>;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MallocChecker_8cpp.html#ad2cfc698611276d3cd573c5a52a2fd84">printMemFnName</a>(os, C, DeallocExpr))</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;deallocator&quot;</span>;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160; </div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot; is &quot;</span>;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <span class="keywordtype">bool</span> Summarized = MR ? SummarizeRegion(os, MR)</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                         : SummarizeValue(os, ArgVal);</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <span class="keywordflow">if</span> (Summarized)</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;, which is not memory allocated by &quot;</span>;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;not memory allocated by &quot;</span>;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160; </div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <a class="code" href="MallocChecker_8cpp.html#a2aaae9c4c3f7405c8d3f21ea8d34722d">printExpectedAllocName</a>(os, Family);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160; </div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keyword">auto</span> R = std::make_unique&lt;PathSensitiveBugReport&gt;(*BT_BadFree[*CheckKind],</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                                                      os.str(), N);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    R-&gt;markInteresting(MR);</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    R-&gt;addRange(Range);</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::move(R));</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  }</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;}</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160; </div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="keywordtype">void</span> MallocChecker::HandleFreeAlloca(CheckerContext &amp;C, SVal ArgVal,</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                                     <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160; </div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;  <a class="code" href="classllvm_1_1Optional.html">Optional&lt;MallocChecker::CheckKind&gt;</a> CheckKind;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160; </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;  <span class="keywordflow">if</span> (ChecksEnabled[CK_MallocChecker])</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    CheckKind = CK_MallocChecker;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ChecksEnabled[CK_MismatchedDeallocatorChecker])</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    CheckKind = CK_MismatchedDeallocatorChecker;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addSink();</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  }</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; </div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;  <span class="keywordflow">if</span> (ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateErrorNode()) {</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <span class="keywordflow">if</span> (!BT_FreeAlloca[*CheckKind])</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;      BT_FreeAlloca[*CheckKind].reset(<span class="keyword">new</span> BugType(</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;          CheckNames[*CheckKind], <span class="stringliteral">&quot;Free alloca()&quot;</span>, <a class="code" href="namespaceclang_1_1ento_1_1categories.html#add9507b029ad01a3e38dd5de81803da9">categories::MemoryError</a>));</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160; </div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="keyword">auto</span> R = std::make_unique&lt;PathSensitiveBugReport&gt;(</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;        *BT_FreeAlloca[*CheckKind],</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        <span class="stringliteral">&quot;Memory allocated by alloca() should not be deallocated&quot;</span>, N);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;    R-&gt;markInteresting(ArgVal.getAsRegion());</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    R-&gt;addRange(Range);</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::move(R));</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  }</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;}</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160; </div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;<span class="keywordtype">void</span> MallocChecker::HandleMismatchedDealloc(CheckerContext &amp;C,</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                                            <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range,</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *DeallocExpr,</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                                            <span class="keyword">const</span> RefState *RS, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym,</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                                            <span class="keywordtype">bool</span> OwnershipTransferred)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160; </div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  <span class="keywordflow">if</span> (!ChecksEnabled[CK_MismatchedDeallocatorChecker]) {</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addSink();</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;  }</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; </div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <span class="keywordflow">if</span> (ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateErrorNode()) {</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <span class="keywordflow">if</span> (!BT_MismatchedDealloc)</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      BT_MismatchedDealloc.reset(</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;          <span class="keyword">new</span> BugType(CheckNames[CK_MismatchedDeallocatorChecker],</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                      <span class="stringliteral">&quot;Bad deallocator&quot;</span>, <a class="code" href="namespaceclang_1_1ento_1_1categories.html#add9507b029ad01a3e38dd5de81803da9">categories::MemoryError</a>));</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;100&gt;</a> buf;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    llvm::raw_svector_ostream os(buf);</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; </div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *AllocExpr = cast&lt;Expr&gt;(RS-&gt;getStmt());</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;20&gt;</a> AllocBuf;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    llvm::raw_svector_ostream AllocOs(AllocBuf);</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;20&gt;</a> DeallocBuf;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    llvm::raw_svector_ostream DeallocOs(DeallocBuf);</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160; </div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="keywordflow">if</span> (OwnershipTransferred) {</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MallocChecker_8cpp.html#ad2cfc698611276d3cd573c5a52a2fd84">printMemFnName</a>(DeallocOs, C, DeallocExpr))</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        os &lt;&lt; DeallocOs.str() &lt;&lt; <span class="stringliteral">&quot; cannot&quot;</span>;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;Cannot&quot;</span>;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160; </div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; take ownership of memory&quot;</span>;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160; </div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MallocChecker_8cpp.html#ad2cfc698611276d3cd573c5a52a2fd84">printMemFnName</a>(AllocOs, C, AllocExpr))</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot; allocated by &quot;</span> &lt;&lt; AllocOs.str();</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Memory&quot;</span>;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MallocChecker_8cpp.html#ad2cfc698611276d3cd573c5a52a2fd84">printMemFnName</a>(AllocOs, C, AllocExpr))</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot; allocated by &quot;</span> &lt;&lt; AllocOs.str();</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160; </div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; should be deallocated by &quot;</span>;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        <a class="code" href="MallocChecker_8cpp.html#aa60484f1d307e45c137f948c0d0976ae">printExpectedDeallocName</a>(os, RS-&gt;getAllocationFamily());</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160; </div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="MallocChecker_8cpp.html#ad2cfc698611276d3cd573c5a52a2fd84">printMemFnName</a>(DeallocOs, C, DeallocExpr))</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;          os &lt;&lt; <span class="stringliteral">&quot;, not &quot;</span> &lt;&lt; DeallocOs.str();</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    }</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160; </div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    <span class="keyword">auto</span> R = std::make_unique&lt;PathSensitiveBugReport&gt;(*BT_MismatchedDealloc,</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;                                                      os.str(), N);</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    R-&gt;markInteresting(Sym);</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    R-&gt;addRange(Range);</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    R-&gt;addVisitor&lt;MallocBugVisitor&gt;(Sym);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::move(R));</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  }</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;}</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160; </div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="keywordtype">void</span> MallocChecker::HandleOffsetFree(CheckerContext &amp;C, SVal ArgVal,</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                                     <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range, <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *DeallocExpr,</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                                     AllocationFamily Family,</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *AllocExpr)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160; </div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  <span class="keywordflow">if</span> (!ChecksEnabled[CK_MallocChecker] &amp;&amp; !ChecksEnabled[CK_NewDeleteChecker]) {</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addSink();</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;  }</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160; </div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;  <a class="code" href="classllvm_1_1Optional.html">Optional&lt;MallocChecker::CheckKind&gt;</a> CheckKind = getCheckIfTracked(Family);</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;  <span class="keywordflow">if</span> (!CheckKind.hasValue())</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160; </div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;  ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateErrorNode();</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;  <span class="keywordflow">if</span> (!N)</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160; </div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;  <span class="keywordflow">if</span> (!BT_OffsetFree[*CheckKind])</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    BT_OffsetFree[*CheckKind].reset(<span class="keyword">new</span> BugType(</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;        CheckNames[*CheckKind], <span class="stringliteral">&quot;Offset free&quot;</span>, <a class="code" href="namespaceclang_1_1ento_1_1categories.html#add9507b029ad01a3e38dd5de81803da9">categories::MemoryError</a>));</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160; </div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;  <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;100&gt;</a> buf;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;  llvm::raw_svector_ostream os(buf);</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;20&gt;</a> AllocNameBuf;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;  llvm::raw_svector_ostream AllocNameOs(AllocNameBuf);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160; </div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  <span class="keyword">const</span> MemRegion *MR = ArgVal.getAsRegion();</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  assert(MR &amp;&amp; <span class="stringliteral">&quot;Only MemRegion based symbols can have offset free errors&quot;</span>);</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160; </div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  RegionOffset <a class="code" href="Format_8cpp.html#a9fcf84dffafb0ea03c0f9b686ddbf2b3">Offset</a> = MR-&gt;getAsOffset();</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  assert((<a class="code" href="Format_8cpp.html#a9fcf84dffafb0ea03c0f9b686ddbf2b3">Offset</a>.isValid() &amp;&amp;</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;          !<a class="code" href="Format_8cpp.html#a9fcf84dffafb0ea03c0f9b686ddbf2b3">Offset</a>.hasSymbolicOffset() &amp;&amp;</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;          <a class="code" href="Format_8cpp.html#a9fcf84dffafb0ea03c0f9b686ddbf2b3">Offset</a>.getOffset() != 0) &amp;&amp;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;         <span class="stringliteral">&quot;Only symbols with a valid offset can have offset free errors&quot;</span>);</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160; </div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <span class="keywordtype">int</span> offsetBytes = <a class="code" href="Format_8cpp.html#a9fcf84dffafb0ea03c0f9b686ddbf2b3">Offset</a>.getOffset() / <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getASTContext().getCharWidth();</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160; </div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Argument to &quot;</span>;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="MallocChecker_8cpp.html#ad2cfc698611276d3cd573c5a52a2fd84">printMemFnName</a>(os, C, DeallocExpr))</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;deallocator&quot;</span>;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; is offset by &quot;</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;     &lt;&lt; offsetBytes</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;     &lt;&lt; ((<a class="code" href="____clang__cuda__cmath_8h.html#ac1b35672b5f9f009e233daf419b34dbb">abs</a>(offsetBytes) &gt; 1) ? <span class="stringliteral">&quot;bytes&quot;</span> : <span class="stringliteral">&quot;byte&quot;</span>)</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; from the start of &quot;</span>;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;  <span class="keywordflow">if</span> (AllocExpr &amp;&amp; <a class="code" href="MallocChecker_8cpp.html#ad2cfc698611276d3cd573c5a52a2fd84">printMemFnName</a>(AllocNameOs, C, AllocExpr))</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;memory allocated by &quot;</span> &lt;&lt; AllocNameOs.str();</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;allocated memory&quot;</span>;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  <span class="keyword">auto</span> R = std::make_unique&lt;PathSensitiveBugReport&gt;(*BT_OffsetFree[*CheckKind],</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;                                                    os.str(), N);</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;  R-&gt;markInteresting(MR-&gt;getBaseRegion());</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;  R-&gt;addRange(Range);</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::move(R));</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;}</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160; </div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="keywordtype">void</span> MallocChecker::HandleUseAfterFree(CheckerContext &amp;C, <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range,</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;                                       <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160; </div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;  <span class="keywordflow">if</span> (!ChecksEnabled[CK_MallocChecker] &amp;&amp; !ChecksEnabled[CK_NewDeleteChecker] &amp;&amp;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;      !ChecksEnabled[CK_InnerPointerChecker]) {</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addSink();</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  }</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160; </div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;  <a class="code" href="classllvm_1_1Optional.html">Optional&lt;MallocChecker::CheckKind&gt;</a> CheckKind = getCheckIfTracked(C, Sym);</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  <span class="keywordflow">if</span> (!CheckKind.hasValue())</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160; </div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  <span class="keywordflow">if</span> (ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateErrorNode()) {</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="keywordflow">if</span> (!BT_UseFree[*CheckKind])</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      BT_UseFree[*CheckKind].reset(<span class="keyword">new</span> BugType(</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;          CheckNames[*CheckKind], <span class="stringliteral">&quot;Use-after-free&quot;</span>, <a class="code" href="namespaceclang_1_1ento_1_1categories.html#add9507b029ad01a3e38dd5de81803da9">categories::MemoryError</a>));</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160; </div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    AllocationFamily AF =</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState()-&gt;get&lt;RegionState&gt;(Sym)-&gt;getAllocationFamily();</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160; </div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    <span class="keyword">auto</span> R = std::make_unique&lt;PathSensitiveBugReport&gt;(</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;        *BT_UseFree[*CheckKind],</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;        AF == AF_InnerBuffer</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;            ? <span class="stringliteral">&quot;Inner pointer of container used after re/deallocation&quot;</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;            : <span class="stringliteral">&quot;Use of memory after it is freed&quot;</span>,</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;        N);</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160; </div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    R-&gt;markInteresting(Sym);</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    R-&gt;addRange(Range);</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    R-&gt;addVisitor&lt;MallocBugVisitor&gt;(Sym);</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160; </div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <span class="keywordflow">if</span> (AF == AF_InnerBuffer)</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      R-&gt;addVisitor(<a class="code" href="namespaceclang_1_1ento_1_1allocation__state.html#a72de691ba75d72a8a1241477fa8a1b78">allocation_state::getInnerPointerBRVisitor</a>(Sym));</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160; </div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::move(R));</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  }</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;}</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160; </div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="keywordtype">void</span> MallocChecker::HandleDoubleFree(CheckerContext &amp;C, <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range,</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                                     <span class="keywordtype">bool</span> Released, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym,</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;                                     <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> PrevSym)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160; </div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;  <span class="keywordflow">if</span> (!ChecksEnabled[CK_MallocChecker] &amp;&amp; !ChecksEnabled[CK_NewDeleteChecker]) {</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addSink();</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  }</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160; </div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  <a class="code" href="classllvm_1_1Optional.html">Optional&lt;MallocChecker::CheckKind&gt;</a> CheckKind = getCheckIfTracked(C, Sym);</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;  <span class="keywordflow">if</span> (!CheckKind.hasValue())</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; </div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;  <span class="keywordflow">if</span> (ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateErrorNode()) {</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    <span class="keywordflow">if</span> (!BT_DoubleFree[*CheckKind])</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      BT_DoubleFree[*CheckKind].reset(<span class="keyword">new</span> BugType(</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;          CheckNames[*CheckKind], <span class="stringliteral">&quot;Double free&quot;</span>, <a class="code" href="namespaceclang_1_1ento_1_1categories.html#add9507b029ad01a3e38dd5de81803da9">categories::MemoryError</a>));</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160; </div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    <span class="keyword">auto</span> R = std::make_unique&lt;PathSensitiveBugReport&gt;(</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;        *BT_DoubleFree[*CheckKind],</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;        (Released ? <span class="stringliteral">&quot;Attempt to free released memory&quot;</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;                  : <span class="stringliteral">&quot;Attempt to free non-owned memory&quot;</span>),</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;        N);</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    R-&gt;addRange(Range);</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    R-&gt;markInteresting(Sym);</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <span class="keywordflow">if</span> (PrevSym)</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;      R-&gt;markInteresting(PrevSym);</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    R-&gt;addVisitor&lt;MallocBugVisitor&gt;(Sym);</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::move(R));</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;  }</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;}</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160; </div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="keywordtype">void</span> MallocChecker::HandleDoubleDelete(CheckerContext &amp;C, <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160; </div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;  <span class="keywordflow">if</span> (!ChecksEnabled[CK_NewDeleteChecker]) {</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addSink();</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;  }</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160; </div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;  <a class="code" href="classllvm_1_1Optional.html">Optional&lt;MallocChecker::CheckKind&gt;</a> CheckKind = getCheckIfTracked(C, Sym);</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;  <span class="keywordflow">if</span> (!CheckKind.hasValue())</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160; </div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;  <span class="keywordflow">if</span> (ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateErrorNode()) {</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    <span class="keywordflow">if</span> (!BT_DoubleDelete)</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      BT_DoubleDelete.reset(<span class="keyword">new</span> BugType(CheckNames[CK_NewDeleteChecker],</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;                                        <span class="stringliteral">&quot;Double delete&quot;</span>,</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                                        <a class="code" href="namespaceclang_1_1ento_1_1categories.html#add9507b029ad01a3e38dd5de81803da9">categories::MemoryError</a>));</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160; </div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <span class="keyword">auto</span> R = std::make_unique&lt;PathSensitiveBugReport&gt;(</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        *BT_DoubleDelete, <span class="stringliteral">&quot;Attempt to delete released memory&quot;</span>, N);</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160; </div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    R-&gt;markInteresting(Sym);</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    R-&gt;addVisitor&lt;MallocBugVisitor&gt;(Sym);</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::move(R));</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;}</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160; </div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="keywordtype">void</span> MallocChecker::HandleUseZeroAlloc(CheckerContext &amp;C, <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range,</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                                       <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160; </div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;  <span class="keywordflow">if</span> (!ChecksEnabled[CK_MallocChecker] &amp;&amp; !ChecksEnabled[CK_NewDeleteChecker]) {</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addSink();</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;  }</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160; </div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;  <a class="code" href="classllvm_1_1Optional.html">Optional&lt;MallocChecker::CheckKind&gt;</a> CheckKind = getCheckIfTracked(C, Sym);</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160; </div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;  <span class="keywordflow">if</span> (!CheckKind.hasValue())</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160; </div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;  <span class="keywordflow">if</span> (ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateErrorNode()) {</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    <span class="keywordflow">if</span> (!BT_UseZerroAllocated[*CheckKind])</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      BT_UseZerroAllocated[*CheckKind].reset(</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;          <span class="keyword">new</span> BugType(CheckNames[*CheckKind], <span class="stringliteral">&quot;Use of zero allocated&quot;</span>,</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                      <a class="code" href="namespaceclang_1_1ento_1_1categories.html#add9507b029ad01a3e38dd5de81803da9">categories::MemoryError</a>));</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160; </div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    <span class="keyword">auto</span> R = std::make_unique&lt;PathSensitiveBugReport&gt;(</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        *BT_UseZerroAllocated[*CheckKind],</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        <span class="stringliteral">&quot;Use of memory allocated with size zero&quot;</span>, N);</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160; </div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    R-&gt;addRange(Range);</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    <span class="keywordflow">if</span> (Sym) {</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;      R-&gt;markInteresting(Sym);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;      R-&gt;addVisitor&lt;MallocBugVisitor&gt;(Sym);</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    }</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::move(R));</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;  }</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;}</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160; </div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="keywordtype">void</span> MallocChecker::HandleFunctionPtrFree(CheckerContext &amp;C, SVal ArgVal,</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;                                          <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a> Range,</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *FreeExpr,</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;                                          AllocationFamily Family)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;  <span class="keywordflow">if</span> (!ChecksEnabled[CK_MallocChecker]) {</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addSink();</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;  }</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160; </div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;  <a class="code" href="classllvm_1_1Optional.html">Optional&lt;MallocChecker::CheckKind&gt;</a> CheckKind = getCheckIfTracked(Family);</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;  <span class="keywordflow">if</span> (!CheckKind.hasValue())</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160; </div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;  <span class="keywordflow">if</span> (ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateErrorNode()) {</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    <span class="keywordflow">if</span> (!BT_BadFree[*CheckKind])</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      BT_BadFree[*CheckKind].reset(<span class="keyword">new</span> BugType(</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;          CheckNames[*CheckKind], <span class="stringliteral">&quot;Bad free&quot;</span>, <a class="code" href="namespaceclang_1_1ento_1_1categories.html#add9507b029ad01a3e38dd5de81803da9">categories::MemoryError</a>));</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160; </div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;100&gt;</a> Buf;</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    llvm::raw_svector_ostream Os(Buf);</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160; </div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="keyword">const</span> MemRegion *MR = ArgVal.getAsRegion();</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">const</span> ElementRegion *ER = dyn_cast_or_null&lt;ElementRegion&gt;(MR))</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      MR = ER-&gt;getSuperRegion();</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160; </div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    Os &lt;&lt; <span class="stringliteral">&quot;Argument to &quot;</span>;</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MallocChecker_8cpp.html#ad2cfc698611276d3cd573c5a52a2fd84">printMemFnName</a>(Os, C, FreeExpr))</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      Os &lt;&lt; <span class="stringliteral">&quot;deallocator&quot;</span>;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160; </div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    Os &lt;&lt; <span class="stringliteral">&quot; is a function pointer&quot;</span>;</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160; </div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <span class="keyword">auto</span> R = std::make_unique&lt;PathSensitiveBugReport&gt;(*BT_BadFree[*CheckKind],</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;                                                      Os.str(), N);</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    R-&gt;markInteresting(MR);</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    R-&gt;addRange(Range);</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::move(R));</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;  }</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;}</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160; </div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;MallocChecker::ReallocMemAux(CheckerContext &amp;C, <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;                             <span class="keywordtype">bool</span> ShouldFreeOnFail, <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;                             AllocationFamily Family, <span class="keywordtype">bool</span> SuffixWithN)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>)</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160; </div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *CE = cast&lt;CallExpr&gt;(<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getOriginExpr());</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160; </div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;  <span class="keywordflow">if</span> (SuffixWithN &amp;&amp; CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa439df008533164342c841a8a22dec1f">getNumArgs</a>() &lt; 3)</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa439df008533164342c841a8a22dec1f">getNumArgs</a>() &lt; 2)</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160; </div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *arg0Expr = CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa454d6f1e76623da60451885239f63c6">getArg</a>(0);</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;  SVal Arg0Val = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(arg0Expr);</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;  <span class="keywordflow">if</span> (!Arg0Val.getAs&lt;DefinedOrUnknownSVal&gt;())</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;  DefinedOrUnknownSVal arg0Val = Arg0Val.castAs&lt;DefinedOrUnknownSVal&gt;();</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160; </div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;  SValBuilder &amp;svalBuilder = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSValBuilder();</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160; </div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;  DefinedOrUnknownSVal PtrEQ = svalBuilder.evalEQ(</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;      <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, arg0Val, svalBuilder.makeNullWithType(arg0Expr-&gt;<a class="code" href="classclang_1_1Expr.html#ac9bfcc699442f2093723cfcf703d9f47">getType</a>()));</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160; </div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;  <span class="comment">// Get the size argument.</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *Arg1 = CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa454d6f1e76623da60451885239f63c6">getArg</a>(1);</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160; </div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;  <span class="comment">// Get the value of the size argument.</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;  SVal TotalSize = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(Arg1);</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;  <span class="keywordflow">if</span> (SuffixWithN)</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    TotalSize = evalMulForBufferSize(C, Arg1, CE-&gt;<a class="code" href="classclang_1_1CallExpr.html#aa454d6f1e76623da60451885239f63c6">getArg</a>(2));</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;  <span class="keywordflow">if</span> (!TotalSize.getAs&lt;DefinedOrUnknownSVal&gt;())</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160; </div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;  <span class="comment">// Compare the size argument to 0.</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;  DefinedOrUnknownSVal SizeZero =</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;      svalBuilder.evalEQ(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, TotalSize.castAs&lt;DefinedOrUnknownSVal&gt;(),</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                         svalBuilder.makeIntValWithWidth(</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                             svalBuilder.getContext().getSizeType(), 0));</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160; </div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> StatePtrIsNull, StatePtrNotNull;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;  std::tie(StatePtrIsNull, StatePtrNotNull) = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;assume(PtrEQ);</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> StateSizeIsZero, StateSizeNotZero;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;  std::tie(StateSizeIsZero, StateSizeNotZero) = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;assume(SizeZero);</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;  <span class="comment">// We only assume exceptional states if they are definitely true; if the</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;  <span class="comment">// state is under-constrained, assume regular realloc behavior.</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;  <span class="keywordtype">bool</span> PrtIsNull = StatePtrIsNull &amp;&amp; !StatePtrNotNull;</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;  <span class="keywordtype">bool</span> SizeIsZero = StateSizeIsZero &amp;&amp; !StateSizeNotZero;</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160; </div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;  <span class="comment">// If the ptr is NULL and the size is not 0, the call is equivalent to</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;  <span class="comment">// malloc(size).</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;  <span class="keywordflow">if</span> (PrtIsNull &amp;&amp; !SizeIsZero) {</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> stateMalloc = MallocMemAux(</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;        C, Call, TotalSize, UndefinedVal(), StatePtrIsNull, Family);</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <span class="keywordflow">return</span> stateMalloc;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;  }</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160; </div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;  <span class="keywordflow">if</span> (PrtIsNull &amp;&amp; SizeIsZero)</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160; </div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;  assert(!PrtIsNull);</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160; </div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;  <span class="keywordtype">bool</span> IsKnownToBeAllocated = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160; </div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  <span class="comment">// If the size is 0, free the memory.</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  <span class="keywordflow">if</span> (SizeIsZero)</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <span class="comment">// The semantics of the return value are:</span></div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    <span class="comment">// If size was equal to 0, either NULL or a pointer suitable to be passed</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    <span class="comment">// to free() is returned. We just free the input pointer and do not add</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    <span class="comment">// any constrains on the output pointer.</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> stateFree = FreeMemAux(</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;            C, Call, StateSizeIsZero, 0, <span class="keyword">false</span>, IsKnownToBeAllocated, Family))</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      <span class="keywordflow">return</span> stateFree;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160; </div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;  <span class="comment">// Default behavior.</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> stateFree =</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;          FreeMemAux(C, Call, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, 0, <span class="keyword">false</span>, IsKnownToBeAllocated, Family)) {</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160; </div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> stateRealloc =</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        MallocMemAux(C, Call, TotalSize, UnknownVal(), stateFree, Family);</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    <span class="keywordflow">if</span> (!stateRealloc)</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160; </div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    OwnershipAfterReallocKind <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> = OAR_ToBeFreedAfterFailure;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    <span class="keywordflow">if</span> (ShouldFreeOnFail)</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;      <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> = OAR_FreeOnFailure;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!IsKnownToBeAllocated)</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;      <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> = OAR_DoNotTrackAfterFailure;</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160; </div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <span class="comment">// Get the from and to pointer symbols as in toPtr = realloc(fromPtr, size).</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> FromPtr = arg0Val.getLocSymbolInBase();</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    SVal RetVal = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(CE);</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> ToPtr = RetVal.getAsSymbol();</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    assert(FromPtr &amp;&amp; ToPtr &amp;&amp;</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;           <span class="stringliteral">&quot;By this point, FreeMemAux and MallocMemAux should have checked &quot;</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;           <span class="stringliteral">&quot;whether the argument or the return value is symbolic!&quot;</span>);</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160; </div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    <span class="comment">// Record the info about the reallocated symbol so that we could properly</span></div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;    <span class="comment">// process failed reallocation.</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    stateRealloc = stateRealloc-&gt;set&lt;ReallocPairs&gt;(ToPtr,</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;                                                   ReallocPair(FromPtr, <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>));</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <span class="comment">// The reallocated symbol should stay alive for as long as the new symbol.</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSymbolManager().addSymbolDependency(ToPtr, FromPtr);</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    <span class="keywordflow">return</span> stateRealloc;</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;  }</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;}</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160; </div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocChecker::CallocMem(CheckerContext &amp;C,</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;                                         <span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;                                         <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>) {</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>)</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160; </div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getNumArgs() &lt; 2)</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160; </div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;  SValBuilder &amp;svalBuilder = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSValBuilder();</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;  SVal zeroVal = svalBuilder.makeZeroVal(svalBuilder.getContext().CharTy);</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  SVal TotalSize =</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      evalMulForBufferSize(C, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(0), <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(1));</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160; </div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;  <span class="keywordflow">return</span> MallocMemAux(C, Call, TotalSize, zeroVal, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, AF_Malloc);</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;}</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160; </div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;MallocChecker::LeakInfo MallocChecker::getAllocationSite(<span class="keyword">const</span> ExplodedNode *N,</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;                                                         <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym,</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;                                                         CheckerContext &amp;C) {</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1LocationContext.html">LocationContext</a> *LeakContext = N-&gt;getLocationContext();</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;  <span class="comment">// Walk the ExplodedGraph backwards and find the first node that referred to</span></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;  <span class="comment">// the tracked symbol.</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;  <span class="keyword">const</span> ExplodedNode *AllocNode = N;</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;  <span class="keyword">const</span> MemRegion *ReferenceRegion = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160; </div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;  <span class="keywordflow">while</span> (N) {</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = N-&gt;getState();</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;get&lt;RegionState&gt;(Sym))</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160; </div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    <span class="comment">// Find the most recent expression bound to the symbol in the current</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    <span class="comment">// context.</span></div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    <span class="keywordflow">if</span> (!ReferenceRegion) {</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> MemRegion *MR = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getLocationRegionIfPostStore(N)) {</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        SVal Val = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;getSVal(MR);</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        <span class="keywordflow">if</span> (Val.getAsLocSymbol() == Sym) {</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;          <span class="keyword">const</span> VarRegion *VR = MR-&gt;getBaseRegion()-&gt;getAs&lt;VarRegion&gt;();</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;          <span class="comment">// Do not show local variables belonging to a function other than</span></div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;          <span class="comment">// where the error is reported.</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;          <span class="keywordflow">if</span> (!VR || (VR-&gt;getStackFrame() == LeakContext-&gt;<a class="code" href="classclang_1_1LocationContext.html#ad83bf782b94f8931c1a28dfcd4b915bf">getStackFrame</a>()))</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            ReferenceRegion = MR;</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;        }</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;      }</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    }</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160; </div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    <span class="comment">// Allocation node, is the last node in the current or parent context in</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    <span class="comment">// which the symbol was tracked.</span></div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    <span class="keyword">const</span> <a class="code" href="classclang_1_1LocationContext.html">LocationContext</a> *NContext = N-&gt;getLocationContext();</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;    <span class="keywordflow">if</span> (NContext == LeakContext ||</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;        NContext-&gt;<a class="code" href="classclang_1_1LocationContext.html#a11efac841bf05dcba26313e753fc52a5">isParentOf</a>(LeakContext))</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;      AllocNode = N;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    N = N-&gt;pred_empty() ? nullptr : *(N-&gt;pred_begin());</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;  }</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160; </div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;  <span class="keywordflow">return</span> LeakInfo(AllocNode, ReferenceRegion);</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;}</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160; </div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="keywordtype">void</span> MallocChecker::HandleLeak(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, ExplodedNode *N,</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                               CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160; </div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;  <span class="keywordflow">if</span> (!ChecksEnabled[CK_MallocChecker] &amp;&amp;</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      !ChecksEnabled[CK_NewDeleteLeaksChecker])</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160; </div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;  <span class="keyword">const</span> RefState *RS = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState()-&gt;get&lt;RegionState&gt;(Sym);</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;  assert(RS &amp;&amp; <span class="stringliteral">&quot;cannot leak an untracked symbol&quot;</span>);</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;  AllocationFamily Family = RS-&gt;getAllocationFamily();</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160; </div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;  <span class="keywordflow">if</span> (Family == AF_Alloca)</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160; </div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;  <a class="code" href="classllvm_1_1Optional.html">Optional&lt;MallocChecker::CheckKind&gt;</a></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;      CheckKind = getCheckIfTracked(Family, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160; </div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;  <span class="keywordflow">if</span> (!CheckKind.hasValue())</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160; </div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;  assert(N);</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;  <span class="keywordflow">if</span> (!BT_Leak[*CheckKind]) {</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    <span class="comment">// Leaks should not be reported if they are post-dominated by a sink:</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    <span class="comment">// (1) Sinks are higher importance bugs.</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    <span class="comment">// (2) NoReturnFunctionChecker uses sink nodes to represent paths ending</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    <span class="comment">//     with __noreturn functions such as assert() or exit(). We choose not</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    <span class="comment">//     to report leaks on such paths.</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    BT_Leak[*CheckKind].reset(<span class="keyword">new</span> BugType(CheckNames[*CheckKind], <span class="stringliteral">&quot;Memory leak&quot;</span>,</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                                          <a class="code" href="namespaceclang_1_1ento_1_1categories.html#add9507b029ad01a3e38dd5de81803da9">categories::MemoryError</a>,</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                                          <span class="comment">/*SuppressOnSink=*/</span><span class="keyword">true</span>));</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;  }</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160; </div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;  <span class="comment">// Most bug reports are cached at the location where they occurred.</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;  <span class="comment">// With leaks, we want to unique them by the location where they were</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;  <span class="comment">// allocated, and only report a single path.</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;  PathDiagnosticLocation LocUsedForUniqueing;</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;  <span class="keyword">const</span> ExplodedNode *AllocNode = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;  <span class="keyword">const</span> MemRegion *Region = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;  std::tie(AllocNode, Region) = getAllocationSite(N, Sym, C);</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160; </div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *AllocationStmt = AllocNode-&gt;getStmtForDiagnostics();</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;  <span class="keywordflow">if</span> (AllocationStmt)</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    LocUsedForUniqueing = <a class="code" href="classclang_1_1ento_1_1PathDiagnosticLocation.html#aa4cb63cfb236b8703eb589ab405b461c">PathDiagnosticLocation::createBegin</a>(AllocationStmt,</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                                              <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSourceManager(),</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;                                              AllocNode-&gt;getLocationContext());</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160; </div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;  <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;200&gt;</a> buf;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;  llvm::raw_svector_ostream os(buf);</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;  <span class="keywordflow">if</span> (Region &amp;&amp; Region-&gt;canPrintPretty()) {</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Potential leak of memory pointed to by &quot;</span>;</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    Region-&gt;printPretty(os);</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Potential memory leak&quot;</span>;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;  }</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160; </div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;  <span class="keyword">auto</span> R = std::make_unique&lt;PathSensitiveBugReport&gt;(</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;      *BT_Leak[*CheckKind], os.str(), N, LocUsedForUniqueing,</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      AllocNode-&gt;getLocationContext()-&gt;getDecl());</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;  R-&gt;markInteresting(Sym);</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;  R-&gt;addVisitor&lt;MallocBugVisitor&gt;(Sym, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;  <span class="keywordflow">if</span> (ShouldRegisterNoOwnershipChangeVisitor)</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    R-&gt;addVisitor&lt;NoOwnershipChangeVisitor&gt;(Sym, <span class="keyword">this</span>);</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::move(R));</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;}</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160; </div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkDeadSymbols(SymbolReaper &amp;SymReaper,</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;                                     CheckerContext &amp;C)<span class="keyword"> const</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;  RegionStateTy OldRS = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;get&lt;RegionState&gt;();</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;  RegionStateTy::Factory &amp;F = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;get_context&lt;RegionState&gt;();</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160; </div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;  RegionStateTy RS = OldRS;</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SymbolRef, 2&gt;</a> Errors;</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;  <span class="keywordflow">for</span> (RegionStateTy::iterator I = RS.begin(), E = RS.end(); I != E; ++I) {</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;    <span class="keywordflow">if</span> (SymReaper.isDead(I-&gt;first)) {</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;      <span class="keywordflow">if</span> (I-&gt;second.isAllocated() || I-&gt;second.isAllocatedOfSizeZero())</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        Errors.push_back(I-&gt;first);</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      <span class="comment">// Remove the dead symbol from the map.</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;      RS = F.remove(RS, I-&gt;first);</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    }</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;  }</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160; </div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;  <span class="keywordflow">if</span> (RS == OldRS) {</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    <span class="comment">// We shouldn&#39;t have touched other maps yet.</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    assert(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;get&lt;ReallocPairs&gt;() ==</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;           <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState()-&gt;get&lt;ReallocPairs&gt;());</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    assert(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;get&lt;FreeReturnValue&gt;() ==</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;           <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState()-&gt;get&lt;FreeReturnValue&gt;());</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;  }</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160; </div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;  <span class="comment">// Cleanup the Realloc Pairs Map.</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;  ReallocPairsTy RP = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;get&lt;ReallocPairs&gt;();</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;  <span class="keywordflow">for</span> (ReallocPairsTy::iterator I = RP.begin(), E = RP.end(); I != E; ++I) {</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="keywordflow">if</span> (SymReaper.isDead(I-&gt;first) ||</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        SymReaper.isDead(I-&gt;second.ReallocatedSym)) {</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;      <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;remove&lt;ReallocPairs&gt;(I-&gt;first);</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    }</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;  }</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160; </div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;  <span class="comment">// Cleanup the FreeReturnValue Map.</span></div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;  FreeReturnValueTy FR = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;get&lt;FreeReturnValue&gt;();</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;  <span class="keywordflow">for</span> (FreeReturnValueTy::iterator I = FR.begin(), E = FR.end(); I != E; ++I) {</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    <span class="keywordflow">if</span> (SymReaper.isDead(I-&gt;first) ||</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        SymReaper.isDead(I-&gt;second)) {</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;      <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;remove&lt;FreeReturnValue&gt;(I-&gt;first);</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    }</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;  }</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160; </div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;  <span class="comment">// Generate leak node.</span></div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;  ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getPredecessor();</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  <span class="keywordflow">if</span> (!Errors.empty()) {</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    <span class="keyword">static</span> CheckerProgramPointTag Tag(<span class="stringliteral">&quot;MallocChecker&quot;</span>, <span class="stringliteral">&quot;DeadSymbolsLeak&quot;</span>);</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateNonFatalErrorNode(<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState(), &amp;Tag);</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;    <span class="keywordflow">if</span> (N) {</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;SymbolRef&gt;::iterator</a></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;           I = Errors.begin(), E = Errors.end(); I != E; ++I) {</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;        HandleLeak(*I, N, C);</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;      }</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;    }</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;  }</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160; </div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;set&lt;RegionState&gt;(RS), N);</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;}</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160; </div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkPreCall(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;                                 CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160; </div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *DC = dyn_cast&lt;CXXDeallocatorCall&gt;(&amp;Call)) {</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <span class="keyword">const</span> <a class="code" href="classclang_1_1CXXDeleteExpr.html">CXXDeleteExpr</a> *DE = DC-&gt;getOriginExpr();</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160; </div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    <span class="keywordflow">if</span> (!ChecksEnabled[CK_NewDeleteChecker])</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(DE-&gt;<a class="code" href="classclang_1_1CXXDeleteExpr.html#a4209bf12d646451c7206292e454c05f9">getArgument</a>()).getAsSymbol())</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;        checkUseAfterFree(Sym, C, DE-&gt;<a class="code" href="classclang_1_1CXXDeleteExpr.html#a4209bf12d646451c7206292e454c05f9">getArgument</a>());</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160; </div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MallocChecker_8cpp.html#ae6533c7f9026cf098295dadb134506d7">isStandardNewDelete</a>(DC-&gt;getDecl()))</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160; </div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    <span class="keywordtype">bool</span> IsKnownToBeAllocated;</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = FreeMemAux(C, DE-&gt;<a class="code" href="classclang_1_1CXXDeleteExpr.html#a4209bf12d646451c7206292e454c05f9">getArgument</a>(), Call, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;                       <span class="comment">/*Hold*/</span> <span class="keyword">false</span>, IsKnownToBeAllocated,</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;                       (DE-&gt;<a class="code" href="classclang_1_1CXXDeleteExpr.html#a43ff28963a2f1cab913725fd4baa9306">isArrayForm</a>() ? AF_CXXNewArray : AF_CXXNew));</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160; </div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;  }</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160; </div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *DC = dyn_cast&lt;CXXDestructorCall&gt;(&amp;Call)) {</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym = DC-&gt;getCXXThisVal().getAsSymbol();</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    <span class="keywordflow">if</span> (!Sym || checkDoubleDelete(Sym, C))</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;  }</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160; </div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  <span class="comment">// We will check for double free in the post visit.</span></div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> AnyFunctionCall *FC = dyn_cast&lt;AnyFunctionCall&gt;(&amp;Call)) {</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;    <span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *FD = FC-&gt;getDecl();</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    <span class="keywordflow">if</span> (!FD)</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160; </div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    <span class="keywordflow">if</span> (ChecksEnabled[CK_MallocChecker] &amp;&amp; isFreeingCall(Call))</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;  }</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160; </div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;  <span class="comment">// Check if the callee of a method is deleted.</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> CXXInstanceCall *CC = dyn_cast&lt;CXXInstanceCall&gt;(&amp;Call)) {</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym = CC-&gt;getCXXThisVal().getAsSymbol();</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <span class="keywordflow">if</span> (!Sym || checkUseAfterFree(Sym, C, CC-&gt;getCXXThisExpr()))</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;  }</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160; </div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;  <span class="comment">// Check arguments for being used after free.</span></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> I = 0, E = <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getNumArgs(); I != E; ++I) {</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    SVal ArgSVal = <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgSVal(I);</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    <span class="keywordflow">if</span> (ArgSVal.getAs&lt;Loc&gt;()) {</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;      <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym = ArgSVal.getAsSymbol();</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;      <span class="keywordflow">if</span> (!Sym)</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      <span class="keywordflow">if</span> (checkUseAfterFree(Sym, C, <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(I)))</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    }</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;  }</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;}</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160; </div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkPreStmt(<span class="keyword">const</span> <a class="code" href="classclang_1_1ReturnStmt.html">ReturnStmt</a> *S,</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;                                 CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;  checkEscapeOnReturn(S, C);</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;}</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160; </div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;<span class="comment">// In the CFG, automatic destructors come after the return statement.</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;<span class="comment">// This callback checks for returning memory that is freed by automatic</span></div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;<span class="comment">// destructors, as those cannot be reached in checkPreStmt().</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkEndFunction(<span class="keyword">const</span> <a class="code" href="classclang_1_1ReturnStmt.html">ReturnStmt</a> *S,</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;                                     CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;  checkEscapeOnReturn(S, C);</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;}</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160; </div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkEscapeOnReturn(<span class="keyword">const</span> <a class="code" href="classclang_1_1ReturnStmt.html">ReturnStmt</a> *S,</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;                                        CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;  <span class="keywordflow">if</span> (!S)</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160; </div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *E = S-&gt;getRetValue();</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;  <span class="keywordflow">if</span> (!E)</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160; </div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;  <span class="comment">// Check if we are returning a symbol.</span></div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;  SVal RetVal = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(E);</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym = RetVal.getAsSymbol();</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;  <span class="keywordflow">if</span> (!Sym)</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    <span class="comment">// If we are returning a field of the allocated struct or an array element,</span></div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;    <span class="comment">// the callee could still free the memory.</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    <span class="comment">// TODO: This logic should be a part of generic symbol escape callback.</span></div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> MemRegion *MR = RetVal.getAsRegion())</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;      <span class="keywordflow">if</span> (isa&lt;FieldRegion, ElementRegion&gt;(MR))</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">const</span> SymbolicRegion *BMR =</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;              dyn_cast&lt;SymbolicRegion&gt;(MR-&gt;getBaseRegion()))</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;          Sym = BMR-&gt;getSymbol();</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160; </div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;  <span class="comment">// Check if we are returning freed memory.</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;  <span class="keywordflow">if</span> (Sym)</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    checkUseAfterFree(Sym, C, E);</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;}</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160; </div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;<span class="comment">// TODO: Blocks should be either inlined or should call invalidate regions</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;<span class="comment">// upon invocation. After that&#39;s in place, special casing here will not be</span></div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;<span class="comment">// needed.</span></div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkPostStmt(<span class="keyword">const</span> <a class="code" href="classclang_1_1BlockExpr.html">BlockExpr</a> *BE,</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;                                  CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160; </div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;  <span class="comment">// Scan the BlockDecRefExprs for any object the retain count checker</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;  <span class="comment">// may be tracking.</span></div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;  <span class="keywordflow">if</span> (!BE-&gt;<a class="code" href="classclang_1_1BlockExpr.html#ab1123558a2bed73c9016a52281912cea">getBlockDecl</a>()-&gt;<a class="code" href="classclang_1_1BlockDecl.html#ac8ab93dffa4a9db6b57b8b85731aa690">hasCaptures</a>())</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160; </div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;  <span class="keyword">const</span> BlockDataRegion *R =</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    cast&lt;BlockDataRegion&gt;(<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(BE).getAsRegion());</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160; </div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;  BlockDataRegion::referenced_vars_iterator I = R-&gt;referenced_vars_begin(),</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                                            E = R-&gt;referenced_vars_end();</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160; </div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;  <span class="keywordflow">if</span> (I == E)</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160; </div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;const MemRegion*, 10&gt;</a> Regions;</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1LocationContext.html">LocationContext</a> *LC = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getLocationContext();</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;  MemRegionManager &amp;MemMgr = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSValBuilder().getRegionManager();</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160; </div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;  <span class="keywordflow">for</span> ( ; I != E; ++I) {</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    <span class="keyword">const</span> VarRegion *VR = I.getCapturedRegion();</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;    <span class="keywordflow">if</span> (VR-&gt;getSuperRegion() == R) {</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      VR = MemMgr.getVarRegion(VR-&gt;getDecl(), LC);</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    }</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;    Regions.push_back(VR);</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;  }</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160; </div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;  <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> =</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;scanReachableSymbols&lt;StopTrackingCallback&gt;(Regions).getState();</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>);</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;}</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160; </div>
<div class="line"><a name="l03005"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#a2a7903a04bcc80b227a601bafdf4d128"> 3005</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#a2a7903a04bcc80b227a601bafdf4d128">isReleased</a>(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, CheckerContext &amp;C) {</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;  assert(Sym);</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;  <span class="keyword">const</span> RefState *RS = C.getState()-&gt;get&lt;RegionState&gt;(Sym);</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;  <span class="keywordflow">return</span> (RS &amp;&amp; RS-&gt;isReleased());</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;}</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160; </div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;<span class="keywordtype">bool</span> MallocChecker::suppressDeallocationsInSuspiciousContexts(</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;    <span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getNumArgs() == 0)</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160; </div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;  StringRef FunctionStr = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *FD = dyn_cast&lt;FunctionDecl&gt;(<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getStackFrame()-&gt;getDecl()))</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *Body = FD-&gt;<a class="code" href="classclang_1_1FunctionDecl.html#a06987fa159c94bf40f8c716804e1dc27">getBody</a>())</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;      <span class="keywordflow">if</span> (Body-&gt;getBeginLoc().isValid())</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;        FunctionStr =</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;            <a class="code" href="classclang_1_1Lexer.html#a013b6a61a2f81044169446ca911a87db">Lexer::getSourceText</a>(<a class="code" href="classclang_1_1CharSourceRange.html#a5763cf308a9499dde63046fab463a61d">CharSourceRange::getTokenRange</a>(</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;                                     {FD-&gt;<a class="code" href="classclang_1_1DeclaratorDecl.html#a73cead379a984c4b4ddb6e0d308725f6">getBeginLoc</a>(), Body-&gt;getBeginLoc()}),</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;                                 <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSourceManager(), <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getLangOpts());</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160; </div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;  <span class="comment">// We do not model the Integer Set Library&#39;s retain-count based allocation.</span></div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;  <span class="keywordflow">if</span> (!FunctionStr.contains(<span class="stringliteral">&quot;__isl_&quot;</span>))</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160; </div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160; </div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *Arg : cast&lt;CallExpr&gt;(<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getOriginExpr())-&gt;arguments())</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(Arg).getAsSymbol())</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> RefState *RS = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;get&lt;RegionState&gt;(Sym))</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;        <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;set&lt;RegionState&gt;(Sym, RefState::getEscaped(RS));</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160; </div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>);</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;}</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160; </div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;<span class="keywordtype">bool</span> MallocChecker::checkUseAfterFree(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, CheckerContext &amp;C,</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *S)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160; </div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MallocChecker_8cpp.html#a2a7903a04bcc80b227a601bafdf4d128">isReleased</a>(Sym, C)) {</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    HandleUseAfterFree(C, S-&gt;getSourceRange(), Sym);</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;  }</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160; </div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;}</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160; </div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkUseZeroAllocated(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, CheckerContext &amp;C,</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *S)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;  assert(Sym);</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160; </div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> RefState *RS = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState()-&gt;get&lt;RegionState&gt;(Sym)) {</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    <span class="keywordflow">if</span> (RS-&gt;isAllocatedOfSizeZero())</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;      HandleUseZeroAlloc(C, RS-&gt;getStmt()-&gt;getSourceRange(), Sym);</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;  }</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState()-&gt;contains&lt;ReallocSizeZeroSymbols&gt;(Sym)) {</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    HandleUseZeroAlloc(C, S-&gt;getSourceRange(), Sym);</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;  }</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;}</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160; </div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="keywordtype">bool</span> MallocChecker::checkDoubleDelete(<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym, CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160; </div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MallocChecker_8cpp.html#a2a7903a04bcc80b227a601bafdf4d128">isReleased</a>(Sym, C)) {</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    HandleDoubleDelete(C, Sym);</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;  }</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;}</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160; </div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="comment">// Check if the location is a freed symbolic region.</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;<span class="keywordtype">void</span> MallocChecker::checkLocation(SVal l, <span class="keywordtype">bool</span> isLoad, <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *S,</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;                                  CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> Sym = l.getLocSymbolInBase();</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;  <span class="keywordflow">if</span> (Sym) {</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    checkUseAfterFree(Sym, C, S);</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;    checkUseZeroAllocated(Sym, C, S);</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;  }</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;}</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160; </div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;<span class="comment">// If a symbolic region is assumed to NULL (or another constant), stop tracking</span></div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;<span class="comment">// it - assuming that allocation failed on this path.</span></div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocChecker::evalAssume(<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>,</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;                                              SVal Cond,</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;                                              <span class="keywordtype">bool</span> Assumption)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;  RegionStateTy RS = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;get&lt;RegionState&gt;();</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;  <span class="keywordflow">for</span> (RegionStateTy::iterator I = RS.begin(), E = RS.end(); I != E; ++I) {</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;    <span class="comment">// If the symbol is assumed to be NULL, remove it from consideration.</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    ConstraintManager &amp;CMgr = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;getConstraintManager();</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;    ConditionTruthVal AllocFailed = CMgr.isNull(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>, I.getKey());</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    <span class="keywordflow">if</span> (AllocFailed.isConstrainedTrue())</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;      <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;remove&lt;RegionState&gt;(I.getKey());</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;  }</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160; </div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  <span class="comment">// Realloc returns 0 when reallocation fails, which means that we should</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;  <span class="comment">// restore the state of the pointer being reallocated.</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;  ReallocPairsTy RP = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;get&lt;ReallocPairs&gt;();</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;  <span class="keywordflow">for</span> (ReallocPairsTy::iterator I = RP.begin(), E = RP.end(); I != E; ++I) {</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    <span class="comment">// If the symbol is assumed to be NULL, remove it from consideration.</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    ConstraintManager &amp;CMgr = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;getConstraintManager();</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    ConditionTruthVal AllocFailed = CMgr.isNull(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>, I.getKey());</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;    <span class="keywordflow">if</span> (!AllocFailed.isConstrainedTrue())</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160; </div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> ReallocSym = I.getData().ReallocatedSym;</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> RefState *RS = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;get&lt;RegionState&gt;(ReallocSym)) {</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;      <span class="keywordflow">if</span> (RS-&gt;isReleased()) {</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;        <span class="keywordflow">switch</span> (I.getData().Kind) {</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;        <span class="keywordflow">case</span> OAR_ToBeFreedAfterFailure:</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;          <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;set&lt;RegionState&gt;(ReallocSym,</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;              RefState::getAllocated(RS-&gt;getAllocationFamily(), RS-&gt;getStmt()));</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;        <span class="keywordflow">case</span> OAR_DoNotTrackAfterFailure:</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;          <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;remove&lt;RegionState&gt;(ReallocSym);</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;          assert(I.getData().Kind == OAR_FreeOnFailure);</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;        }</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;      }</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    }</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;    <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;remove&lt;ReallocPairs&gt;(I.getKey());</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;  }</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160; </div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>;</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;}</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160; </div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;<span class="keywordtype">bool</span> MallocChecker::mayFreeAnyEscapedMemoryOrIsModeledExplicitly(</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;                                              <span class="keyword">const</span> CallEvent *Call,</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;                                              <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;                                              <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> &amp;EscapingSymbol)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;  assert(Call);</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;  EscapingSymbol = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160; </div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;  <span class="comment">// For now, assume that any C++ or block call can free memory.</span></div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;  <span class="comment">// TODO: If we want to be more optimistic here, we&#39;ll need to make sure that</span></div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;  <span class="comment">// regions escape to C++ containers. They seem to do that even now, but for</span></div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;  <span class="comment">// mysterious reasons.</span></div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;SimpleFunctionCall, ObjCMethodCall&gt;(Call))</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160; </div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;  <span class="comment">// Check Objective-C messages by selector name.</span></div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> ObjCMethodCall *Msg = dyn_cast&lt;ObjCMethodCall&gt;(Call)) {</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    <span class="comment">// If it&#39;s not a framework call, or if it takes a callback, assume it</span></div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;    <span class="comment">// can free memory.</span></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>-&gt;isInSystemHeader() || <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>-&gt;argumentsMayEscape())</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160; </div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;    <span class="comment">// If it&#39;s a method we know about, handle it explicitly post-call.</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;    <span class="comment">// This should happen before the &quot;freeWhenDone&quot; check below.</span></div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MallocChecker_8cpp.html#ae1e7389f740cf97f5021b0c02a795abd">isKnownDeallocObjCMethodName</a>(*Msg))</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160; </div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    <span class="comment">// If there&#39;s a &quot;freeWhenDone&quot; parameter, but the method isn&#39;t one we know</span></div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    <span class="comment">// about, we can&#39;t be sure that the object will use free() to deallocate the</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;    <span class="comment">// memory, so we can&#39;t model it explicitly. The best we can do is use it to</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;    <span class="comment">// decide whether the pointer escapes.</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Optional.html">Optional&lt;bool&gt;</a> FreeWhenDone = <a class="code" href="MallocChecker_8cpp.html#abc20428bd6d598274e9deea1e5e0d068">getFreeWhenDoneArg</a>(*Msg))</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;      <span class="keywordflow">return</span> *FreeWhenDone;</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160; </div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;    <span class="comment">// If the first selector piece ends with &quot;NoCopy&quot;, and there is no</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    <span class="comment">// &quot;freeWhenDone&quot; parameter set to zero, we know ownership is being</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;    <span class="comment">// transferred. Again, though, we can&#39;t be sure that the object will use</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    <span class="comment">// free() to deallocate the memory, so we can&#39;t model it explicitly.</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    StringRef FirstSlot = Msg-&gt;getSelector().getNameForSlot(0);</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;    <span class="keywordflow">if</span> (FirstSlot.endswith(<span class="stringliteral">&quot;NoCopy&quot;</span>))</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160; </div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;    <span class="comment">// If the first selector starts with addPointer, insertPointer,</span></div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    <span class="comment">// or replacePointer, assume we are dealing with NSPointerArray or similar.</span></div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    <span class="comment">// This is similar to C++ containers (vector); we still might want to check</span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    <span class="comment">// that the pointers get freed by following the container itself.</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    <span class="keywordflow">if</span> (FirstSlot.startswith(<span class="stringliteral">&quot;addPointer&quot;</span>) ||</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        FirstSlot.startswith(<span class="stringliteral">&quot;insertPointer&quot;</span>) ||</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;        FirstSlot.startswith(<span class="stringliteral">&quot;replacePointer&quot;</span>) ||</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;        FirstSlot.equals(<span class="stringliteral">&quot;valueWithPointer&quot;</span>)) {</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;    }</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160; </div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;    <span class="comment">// We should escape receiver on call to &#39;init&#39;. This is especially relevant</span></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;    <span class="comment">// to the receiver, as the corresponding symbol is usually not referenced</span></div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;    <span class="comment">// after the call.</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    <span class="keywordflow">if</span> (Msg-&gt;getMethodFamily() == <a class="code" href="namespaceclang.html#a5dc786a6640e4d510cd8b68a5a87a140a7749fb8107514089095277752fe75ece">OMF_init</a>) {</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;      EscapingSymbol = Msg-&gt;getReceiverSVal().getAsSymbol();</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    }</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160; </div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    <span class="comment">// Otherwise, assume that the method does not free memory.</span></div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;    <span class="comment">// Most framework methods do not free memory.</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;  }</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160; </div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;  <span class="comment">// At this point the only thing left to handle is straight function calls.</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1FunctionDecl.html">FunctionDecl</a> *FD = cast&lt;SimpleFunctionCall&gt;(Call)-&gt;getDecl();</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;  <span class="keywordflow">if</span> (!FD)</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160; </div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;  <span class="comment">// If it&#39;s one of the allocation functions we can reason about, we model</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;  <span class="comment">// its behavior explicitly.</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;  <span class="keywordflow">if</span> (isMemCall(*Call))</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160; </div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;  <span class="comment">// If it&#39;s not a system call, assume it frees memory.</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>-&gt;isInSystemHeader())</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160; </div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;  <span class="comment">// White list the system functions whose arguments escape.</span></div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1IdentifierInfo.html">IdentifierInfo</a> *II = FD-&gt;<a class="code" href="classclang_1_1NamedDecl.html#a7fab32caa3b7d601128265248260fd37">getIdentifier</a>();</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;  <span class="keywordflow">if</span> (!II)</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;  StringRef FName = II-&gt;<a class="code" href="classclang_1_1IdentifierInfo.html#ae3eae8e88234cfc11812fc54266bd0f1">getName</a>();</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160; </div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;  <span class="comment">// White list the &#39;XXXNoCopy&#39; CoreFoundation functions.</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;  <span class="comment">// We specifically check these before</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;  <span class="keywordflow">if</span> (FName.endswith(<span class="stringliteral">&quot;NoCopy&quot;</span>)) {</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;    <span class="comment">// Look for the deallocator argument. We know that the memory ownership</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;    <span class="comment">// is not transferred only if the deallocator argument is</span></div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    <span class="comment">// &#39;kCFAllocatorNull&#39;.</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 1; i &lt; <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>-&gt;getNumArgs(); ++i) {</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;      <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *ArgE = <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>-&gt;getArgExpr(i)-&gt;IgnoreParenCasts();</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1DeclRefExpr.html">DeclRefExpr</a> *DE = dyn_cast&lt;DeclRefExpr&gt;(ArgE)) {</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;        StringRef DeallocatorName = DE-&gt;getFoundDecl()-&gt;getName();</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;        <span class="keywordflow">if</span> (DeallocatorName == <span class="stringliteral">&quot;kCFAllocatorNull&quot;</span>)</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;      }</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    }</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;  }</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160; </div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;  <span class="comment">// Associating streams with malloced buffers. The pointer can escape if</span></div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;  <span class="comment">// &#39;closefn&#39; is specified (and if that function does free memory),</span></div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;  <span class="comment">// but it will not if closefn is not specified.</span></div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;  <span class="comment">// Currently, we do not inspect the &#39;closefn&#39; function (PR12101).</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;  <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;funopen&quot;</span>)</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>-&gt;getNumArgs() &gt;= 4 &amp;&amp; <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>-&gt;getArgSVal(4).isConstant(0))</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160; </div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;  <span class="comment">// Do not warn on pointers passed to &#39;setbuf&#39; when used with std streams,</span></div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;  <span class="comment">// these leaks might be intentional when setting the buffer for stdio.</span></div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;  <span class="comment">// http://stackoverflow.com/questions/2671151/who-frees-setvbuf-buffer</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;  <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;setbuf&quot;</span> || FName ==<span class="stringliteral">&quot;setbuffer&quot;</span> ||</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;      FName == <span class="stringliteral">&quot;setlinebuf&quot;</span> || FName == <span class="stringliteral">&quot;setvbuf&quot;</span>) {</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>-&gt;getNumArgs() &gt;= 1) {</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;      <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *ArgE = <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>-&gt;getArgExpr(0)-&gt;IgnoreParenCasts();</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1DeclRefExpr.html">DeclRefExpr</a> *ArgDRE = dyn_cast&lt;DeclRefExpr&gt;(ArgE))</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1VarDecl.html">VarDecl</a> *D = dyn_cast&lt;VarDecl&gt;(ArgDRE-&gt;getDecl()))</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;          <span class="keywordflow">if</span> (D-&gt;getCanonicalDecl()-&gt;getName().contains(<span class="stringliteral">&quot;std&quot;</span>))</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;    }</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;  }</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160; </div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;  <span class="comment">// A bunch of other functions which either take ownership of a pointer or</span></div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;  <span class="comment">// wrap the result up in a struct or object, meaning it can be freed later.</span></div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;  <span class="comment">// (See RetainCountChecker.) Not all the parameters here are invalidated,</span></div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;  <span class="comment">// but the Malloc checker cannot differentiate between them. The right way</span></div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;  <span class="comment">// of doing this would be to implement a pointer escapes callback.</span></div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;  <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;CGBitmapContextCreate&quot;</span> ||</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;      FName == <span class="stringliteral">&quot;CGBitmapContextCreateWithData&quot;</span> ||</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;      FName == <span class="stringliteral">&quot;CVPixelBufferCreateWithBytes&quot;</span> ||</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;      FName == <span class="stringliteral">&quot;CVPixelBufferCreateWithPlanarBytes&quot;</span> ||</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;      FName == <span class="stringliteral">&quot;OSAtomicEnqueue&quot;</span>) {</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;  }</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160; </div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;  <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;postEvent&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;      FD-&gt;<a class="code" href="classclang_1_1NamedDecl.html#a944a976b455505507450bc68b56a9b75">getQualifiedNameAsString</a>() == <span class="stringliteral">&quot;QCoreApplication::postEvent&quot;</span>) {</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;  }</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160; </div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;  <span class="keywordflow">if</span> (FName == <span class="stringliteral">&quot;connectImpl&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      FD-&gt;<a class="code" href="classclang_1_1NamedDecl.html#a944a976b455505507450bc68b56a9b75">getQualifiedNameAsString</a>() == <span class="stringliteral">&quot;QObject::connectImpl&quot;</span>) {</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;  }</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160; </div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;  <span class="comment">// Handle cases where we know a buffer&#39;s /address/ can escape.</span></div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;  <span class="comment">// Note that the above checks handle some special cases where we know that</span></div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;  <span class="comment">// even though the address escapes, it&#39;s still our responsibility to free the</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;  <span class="comment">// buffer.</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>-&gt;argumentsMayEscape())</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160; </div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;  <span class="comment">// Otherwise, assume that the function does not free memory.</span></div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;  <span class="comment">// Most system calls do not free the memory.</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;}</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160; </div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocChecker::checkPointerEscape(<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="namespaceclang_1_1ento.html#ab2743eb22efec4f33d5138cfb12366d6">InvalidatedSymbols</a> &amp;Escaped,</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;                                             <span class="keyword">const</span> CallEvent *Call,</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;                                             <a class="code" href="namespaceclang_1_1ento.html#a1f45158b71c9d04bfd6094ee29a38e59">PointerEscapeKind</a> <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;  <span class="keywordflow">return</span> checkPointerEscapeAux(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, Escaped, Call, <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>,</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;                               <span class="comment">/*IsConstPointerEscape*/</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;}</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160; </div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocChecker::checkConstPointerEscape(<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="namespaceclang_1_1ento.html#ab2743eb22efec4f33d5138cfb12366d6">InvalidatedSymbols</a> &amp;Escaped,</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;                                              <span class="keyword">const</span> CallEvent *Call,</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;                                              <a class="code" href="namespaceclang_1_1ento.html#a1f45158b71c9d04bfd6094ee29a38e59">PointerEscapeKind</a> <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;  <span class="comment">// If a const pointer escapes, it may not be freed(), but it could be deleted.</span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;  <span class="keywordflow">return</span> checkPointerEscapeAux(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, Escaped, Call, <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>,</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;                               <span class="comment">/*IsConstPointerEscape*/</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;}</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160; </div>
<div class="line"><a name="l03305"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#af6f31005567fd6e3e00d983e6f9df877"> 3305</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#af6f31005567fd6e3e00d983e6f9df877">checkIfNewOrNewArrayFamily</a>(<span class="keyword">const</span> RefState *RS) {</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;  <span class="keywordflow">return</span> (RS-&gt;getAllocationFamily() == AF_CXXNewArray ||</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;          RS-&gt;getAllocationFamily() == AF_CXXNew);</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;}</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160; </div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> MallocChecker::checkPointerEscapeAux(</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, <span class="keyword">const</span> <a class="code" href="namespaceclang_1_1ento.html#ab2743eb22efec4f33d5138cfb12366d6">InvalidatedSymbols</a> &amp;Escaped,</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    <span class="keyword">const</span> CallEvent *Call, <a class="code" href="namespaceclang_1_1ento.html#a1f45158b71c9d04bfd6094ee29a38e59">PointerEscapeKind</a> <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>,</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;    <span class="keywordtype">bool</span> IsConstPointerEscape)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;  <span class="comment">// If we know that the call does not free memory, or we want to process the</span></div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;  <span class="comment">// call later, keep tracking the top level arguments.</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> EscapingSymbol = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> == <a class="code" href="namespaceclang_1_1ento.html#a1f45158b71c9d04bfd6094ee29a38e59a1c38c1cbdb7ff99b102f29a5f8453f4d">PSK_DirectEscapeOnCall</a> &amp;&amp;</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;      !mayFreeAnyEscapedMemoryOrIsModeledExplicitly(Call, <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;                                                    EscapingSymbol) &amp;&amp;</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;      !EscapingSymbol) {</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>;</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;  }</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160; </div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;  <span class="keywordflow">for</span> (InvalidatedSymbols::const_iterator I = Escaped.begin(),</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;       E = Escaped.end();</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;       I != E; ++I) {</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> sym = *I;</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160; </div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;    <span class="keywordflow">if</span> (EscapingSymbol &amp;&amp; EscapingSymbol != sym)</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160; </div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> RefState *RS = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;get&lt;RegionState&gt;(sym))</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;      <span class="keywordflow">if</span> (RS-&gt;isAllocated() || RS-&gt;isAllocatedOfSizeZero())</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;        <span class="keywordflow">if</span> (!IsConstPointerEscape || <a class="code" href="MallocChecker_8cpp.html#af6f31005567fd6e3e00d983e6f9df877">checkIfNewOrNewArrayFamily</a>(RS))</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;          <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a> = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;set&lt;RegionState&gt;(sym, RefState::getEscaped(RS));</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;  }</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>;</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;}</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160; </div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;<span class="keywordtype">bool</span> MallocChecker::isArgZERO_SIZE_PTR(<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, CheckerContext &amp;C,</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;                                       SVal ArgVal)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;  <span class="keywordflow">if</span> (!KernelZeroSizePtrValue)</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;    KernelZeroSizePtrValue =</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;        <a class="code" href="namespaceclang_1_1ento.html#a7bfe6c6274bf85c686611be73363c7f5">tryExpandAsInteger</a>(<span class="stringliteral">&quot;ZERO_SIZE_PTR&quot;</span>, <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getPreprocessor());</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160; </div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;  <span class="keyword">const</span> <a class="code" href="ByteCodeEmitter_8cpp.html#abcdace8b2ec8db6d1a21f45f8a45e6fd">llvm::APSInt</a> *ArgValKnown =</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;      <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSValBuilder().getKnownValue(<a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, ArgVal);</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;  <span class="keywordflow">return</span> ArgValKnown &amp;&amp; *KernelZeroSizePtrValue &amp;&amp;</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;         ArgValKnown-&gt;getSExtValue() == **KernelZeroSizePtrValue;</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;}</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160; </div>
<div class="line"><a name="l03352"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#a7019fa32d4323ea2a05116240724e77f"> 3352</a></span>&#160;<span class="keyword">static</span> <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> <a class="code" href="MallocChecker_8cpp.html#a7019fa32d4323ea2a05116240724e77f">findFailedReallocSymbol</a>(<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> currState,</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;                                         <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> prevState) {</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;  ReallocPairsTy currMap = currState-&gt;get&lt;ReallocPairs&gt;();</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;  ReallocPairsTy prevMap = prevState-&gt;get&lt;ReallocPairs&gt;();</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160; </div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> ReallocPairsTy::value_type &amp;Pair : prevMap) {</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;    <a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> sym = Pair.first;</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    <span class="keywordflow">if</span> (!currMap.lookup(sym))</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;      <span class="keywordflow">return</span> sym;</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;  }</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160; </div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;}</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160; </div>
<div class="line"><a name="l03366"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#a686de38faf1dbbbf84b48c28e6f442b3"> 3366</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MallocChecker_8cpp.html#a686de38faf1dbbbf84b48c28e6f442b3">isReferenceCountingPointerDestructor</a>(<span class="keyword">const</span> <a class="code" href="classclang_1_1CXXDestructorDecl.html">CXXDestructorDecl</a> *DD) {</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1IdentifierInfo.html">IdentifierInfo</a> *II = DD-&gt;<a class="code" href="classclang_1_1CXXMethodDecl.html#a290cbceee004310e1a43bb8cd9ab25de">getParent</a>()-&gt;<a class="code" href="classclang_1_1NamedDecl.html#a7fab32caa3b7d601128265248260fd37">getIdentifier</a>()) {</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;    StringRef N = II-&gt;<a class="code" href="classclang_1_1IdentifierInfo.html#ae3eae8e88234cfc11812fc54266bd0f1">getName</a>();</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    <span class="keywordflow">if</span> (N.contains_insensitive(<span class="stringliteral">&quot;ptr&quot;</span>) || N.contains_insensitive(<span class="stringliteral">&quot;pointer&quot;</span>)) {</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;      <span class="keywordflow">if</span> (N.contains_insensitive(<span class="stringliteral">&quot;ref&quot;</span>) || N.contains_insensitive(<span class="stringliteral">&quot;cnt&quot;</span>) ||</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;          N.contains_insensitive(<span class="stringliteral">&quot;intrusive&quot;</span>) ||</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;          N.contains_insensitive(<span class="stringliteral">&quot;shared&quot;</span>)) {</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;      }</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;    }</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;  }</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;}</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160; </div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#af0d0e00a28f39eb324aea94250e58848">PathDiagnosticPieceRef</a> MallocBugVisitor::VisitNode(<span class="keyword">const</span> ExplodedNode *N,</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;                                                   BugReporterContext &amp;BRC,</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;                                                   PathSensitiveBugReport &amp;BR) {</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = N-&gt;getState();</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> statePrev = N-&gt;getFirstPred()-&gt;getState();</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160; </div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;  <span class="keyword">const</span> RefState *RSCurr = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;get&lt;RegionState&gt;(Sym);</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;  <span class="keyword">const</span> RefState *RSPrev = statePrev-&gt;get&lt;RegionState&gt;(Sym);</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160; </div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *S = N-&gt;getStmtForDiagnostics();</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;  <span class="comment">// When dealing with containers, we sometimes want to give a note</span></div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;  <span class="comment">// even if the statement is missing.</span></div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;  <span class="keywordflow">if</span> (!S &amp;&amp; (!RSCurr || RSCurr-&gt;getAllocationFamily() != AF_InnerBuffer))</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160; </div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1LocationContext.html">LocationContext</a> *CurrentLC = N-&gt;getLocationContext();</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160; </div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;  <span class="comment">// If we find an atomic fetch_add or fetch_sub within the destructor in which</span></div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;  <span class="comment">// the pointer was released (before the release), this is likely a destructor</span></div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;  <span class="comment">// of a shared pointer.</span></div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;  <span class="comment">// Because we don&#39;t model atomics, and also because we don&#39;t know that the</span></div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;  <span class="comment">// original reference count is positive, we should not report use-after-frees</span></div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;  <span class="comment">// on objects deleted in such destructors. This can probably be improved</span></div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;  <span class="comment">// through better shared pointer modeling.</span></div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;  <span class="keywordflow">if</span> (ReleaseDestructorLC) {</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *AE = dyn_cast&lt;AtomicExpr&gt;(S)) {</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;      <a class="code" href="classclang_1_1AtomicExpr.html#aafb2a1534e844508c6c0979397e5261d">AtomicExpr::AtomicOp</a> Op = AE-&gt;getOp();</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;      <span class="keywordflow">if</span> (Op == AtomicExpr::AO__c11_atomic_fetch_add ||</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;          Op == AtomicExpr::AO__c11_atomic_fetch_sub) {</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;        <span class="keywordflow">if</span> (ReleaseDestructorLC == CurrentLC ||</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;            ReleaseDestructorLC-&gt;<a class="code" href="classclang_1_1LocationContext.html#a11efac841bf05dcba26313e753fc52a5">isParentOf</a>(CurrentLC)) {</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;          BR.markInvalid(getTag(), S);</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;        }</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;      }</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;    }</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;  }</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160; </div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;  <span class="comment">// FIXME: We will eventually need to handle non-statement-based events</span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;  <span class="comment">// (__attribute__((cleanup))).</span></div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160; </div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;  <span class="comment">// Find out if this is an interesting point and what is the kind.</span></div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;  StringRef Msg;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;  std::unique_ptr&lt;StackHintGeneratorForSymbol&gt; StackHint = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;  <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;256&gt;</a> Buf;</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;  llvm::raw_svector_ostream <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a>(Buf);</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160; </div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;  <span class="keywordflow">if</span> (Mode == Normal) {</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;    <span class="keywordflow">if</span> (isAllocated(RSCurr, RSPrev, S)) {</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;      Msg = <span class="stringliteral">&quot;Memory is allocated&quot;</span>;</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;      StackHint = std::make_unique&lt;StackHintGeneratorForSymbol&gt;(</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;          Sym, <span class="stringliteral">&quot;Returned allocated memory&quot;</span>);</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="MallocChecker_8cpp.html#a2a7903a04bcc80b227a601bafdf4d128">isReleased</a>(RSCurr, RSPrev, S)) {</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> Family = RSCurr-&gt;getAllocationFamily();</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;      <span class="keywordflow">switch</span> (Family) {</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;        <span class="keywordflow">case</span> AF_Alloca:</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;        <span class="keywordflow">case</span> AF_Malloc:</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;        <span class="keywordflow">case</span> AF_CXXNew:</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;        <span class="keywordflow">case</span> AF_CXXNewArray:</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;        <span class="keywordflow">case</span> AF_IfNameIndex:</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;          Msg = <span class="stringliteral">&quot;Memory is released&quot;</span>;</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;          StackHint = std::make_unique&lt;StackHintGeneratorForSymbol&gt;(</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;              Sym, <span class="stringliteral">&quot;Returning; memory was released&quot;</span>);</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;        <span class="keywordflow">case</span> AF_InnerBuffer: {</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;          <span class="keyword">const</span> MemRegion *ObjRegion =</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;              <a class="code" href="namespaceclang_1_1ento_1_1allocation__state.html#ac1f0c9a29ca565930d37aaf30881300e">allocation_state::getContainerObjRegion</a>(statePrev, Sym);</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> *TypedRegion = cast&lt;TypedValueRegion&gt;(ObjRegion);</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;          <a class="code" href="classclang_1_1QualType.html">QualType</a> ObjTy = TypedRegion-&gt;getValueType();</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;          <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a> &lt;&lt; <span class="stringliteral">&quot;Inner buffer of &#39;&quot;</span> &lt;&lt; ObjTy.<a class="code" href="classclang_1_1QualType.html#ae248b51eebdb65da5c48bfd8694c7e51">getAsString</a>() &lt;&lt; <span class="stringliteral">&quot;&#39; &quot;</span>;</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160; </div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;          <span class="keywordflow">if</span> (N-&gt;getLocation().getKind() == <a class="code" href="classclang_1_1ProgramPoint.html#aa4bd73e248c6fca35aad0b2c1fb7e8c6a34a09ff52d62e8c8a472ed2f948f43ec">ProgramPoint::PostImplicitCallKind</a>) {</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;            <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a> &lt;&lt; <span class="stringliteral">&quot;deallocated by call to destructor&quot;</span>;</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;            StackHint = std::make_unique&lt;StackHintGeneratorForSymbol&gt;(</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;                Sym, <span class="stringliteral">&quot;Returning; inner buffer was deallocated&quot;</span>);</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;            <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a> &lt;&lt; <span class="stringliteral">&quot;reallocated by call to &#39;&quot;</span>;</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;            <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *S = RSCurr-&gt;getStmt();</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *MemCallE = dyn_cast&lt;CXXMemberCallExpr&gt;(S)) {</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;              <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a> &lt;&lt; MemCallE-&gt;getMethodDecl()-&gt;getDeclName();</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *OpCallE = dyn_cast&lt;CXXOperatorCallExpr&gt;(S)) {</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;              <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a> &lt;&lt; OpCallE-&gt;getDirectCallee()-&gt;getDeclName();</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *CallE = dyn_cast&lt;CallExpr&gt;(S)) {</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;              <span class="keyword">auto</span> &amp;CEMgr = BRC.getStateManager().getCallEventManager();</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;              CallEventRef&lt;&gt; <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a> = CEMgr.getSimpleCall(CallE, <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>, CurrentLC);</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;              <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *D = dyn_cast_or_null&lt;NamedDecl&gt;(<a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>-&gt;getDecl()))</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;                <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a> &lt;&lt; D-&gt;getDeclName();</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;                <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a> &lt;&lt; <span class="stringliteral">&quot;unknown&quot;</span>;</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;            }</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;            <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a> &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;            StackHint = std::make_unique&lt;StackHintGeneratorForSymbol&gt;(</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;                Sym, <span class="stringliteral">&quot;Returning; inner buffer was reallocated&quot;</span>);</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;          }</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;          Msg = <a class="code" href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">OS</a>.str();</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;        }</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;        <span class="keywordflow">case</span> AF_None:</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;          llvm_unreachable(<span class="stringliteral">&quot;Unhandled allocation family!&quot;</span>);</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;      }</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160; </div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;      <span class="comment">// See if we&#39;re releasing memory while inlining a destructor</span></div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;      <span class="comment">// (or one of its callees). This turns on various common</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;      <span class="comment">// false positive suppressions.</span></div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;      <span class="keywordtype">bool</span> FoundAnyDestructor = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1LocationContext.html">LocationContext</a> *LC = CurrentLC; LC; LC = LC-&gt;<a class="code" href="classclang_1_1LocationContext.html#a0d95890e7358d8102ae6056a89508bfb">getParent</a>()) {</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *DD = dyn_cast&lt;CXXDestructorDecl&gt;(LC-&gt;<a class="code" href="classclang_1_1LocationContext.html#a5f34d4aa5d22732cbe4500b406312431">getDecl</a>())) {</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="MallocChecker_8cpp.html#a686de38faf1dbbbf84b48c28e6f442b3">isReferenceCountingPointerDestructor</a>(DD)) {</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;            <span class="comment">// This immediately looks like a reference-counting destructor.</span></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;            <span class="comment">// We&#39;re bad at guessing the original reference count of the object,</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;            <span class="comment">// so suppress the report for now.</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;            BR.markInvalid(getTag(), DD);</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!FoundAnyDestructor) {</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;            assert(!ReleaseDestructorLC &amp;&amp;</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;                   <span class="stringliteral">&quot;There can be only one release point!&quot;</span>);</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;            <span class="comment">// Suspect that it&#39;s a reference counting pointer destructor.</span></div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;            <span class="comment">// On one of the next nodes might find out that it has atomic</span></div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;            <span class="comment">// reference counting operations within it (see the code above),</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;            <span class="comment">// and if so, we&#39;d conclude that it likely is a reference counting</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;            <span class="comment">// pointer destructor.</span></div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;            ReleaseDestructorLC = LC-&gt;<a class="code" href="classclang_1_1LocationContext.html#ad83bf782b94f8931c1a28dfcd4b915bf">getStackFrame</a>();</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;            <span class="comment">// It is unlikely that releasing memory is delegated to a destructor</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;            <span class="comment">// inside a destructor of a shared pointer, because it&#39;s fairly hard</span></div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;            <span class="comment">// to pass the information that the pointer indeed needs to be</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;            <span class="comment">// released into it. So we&#39;re only interested in the innermost</span></div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;            <span class="comment">// destructor.</span></div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;            FoundAnyDestructor = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;          }</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;        }</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;      }</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isRelinquished(RSCurr, RSPrev, S)) {</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;      Msg = <span class="stringliteral">&quot;Memory ownership is transferred&quot;</span>;</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;      StackHint = std::make_unique&lt;StackHintGeneratorForSymbol&gt;(Sym, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hasReallocFailed(RSCurr, RSPrev, S)) {</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;      Mode = ReallocationFailed;</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;      Msg = <span class="stringliteral">&quot;Reallocation failed&quot;</span>;</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;      StackHint = std::make_unique&lt;StackHintGeneratorForReallocationFailed&gt;(</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;          Sym, <span class="stringliteral">&quot;Reallocation failed&quot;</span>);</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160; </div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">SymbolRef</a> sym = <a class="code" href="MallocChecker_8cpp.html#a7019fa32d4323ea2a05116240724e77f">findFailedReallocSymbol</a>(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>, statePrev)) {</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;        <span class="comment">// Is it possible to fail two reallocs WITHOUT testing in between?</span></div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;        assert((!FailedReallocSymbol || FailedReallocSymbol == sym) &amp;&amp;</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;          <span class="stringliteral">&quot;We only support one failed realloc at a time.&quot;</span>);</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;        BR.markInteresting(sym);</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;        FailedReallocSymbol = sym;</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;      }</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;    }</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160; </div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;  <span class="comment">// We are in a special mode if a reallocation failed later in the path.</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Mode == ReallocationFailed) {</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;    assert(FailedReallocSymbol &amp;&amp; <span class="stringliteral">&quot;No symbol to look for.&quot;</span>);</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160; </div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;    <span class="comment">// Is this is the first appearance of the reallocated symbol?</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;    <span class="keywordflow">if</span> (!statePrev-&gt;get&lt;RegionState&gt;(FailedReallocSymbol)) {</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;      <span class="comment">// We&#39;re at the reallocation point.</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;      Msg = <span class="stringliteral">&quot;Attempt to reallocate memory&quot;</span>;</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;      StackHint = std::make_unique&lt;StackHintGeneratorForSymbol&gt;(</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;          Sym, <span class="stringliteral">&quot;Returned reallocated memory&quot;</span>);</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;      FailedReallocSymbol = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;      Mode = <a class="code" href="namespaceclang.html#a44775134eba0623164027214ea176711a960b44c579bc2f6818d2daaf9e4c16f0">Normal</a>;</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;    }</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;  }</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160; </div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;  <span class="keywordflow">if</span> (Msg.empty()) {</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    assert(!StackHint);</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;  }</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160; </div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;  assert(StackHint);</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160; </div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;  <span class="comment">// Generate the extra diagnostic.</span></div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;  PathDiagnosticLocation Pos;</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;  <span class="keywordflow">if</span> (!S) {</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    assert(RSCurr-&gt;getAllocationFamily() == AF_InnerBuffer);</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;    <span class="keyword">auto</span> PostImplCall = N-&gt;getLocation().getAs&lt;<a class="code" href="classclang_1_1PostImplicitCall.html">PostImplicitCall</a>&gt;();</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;    <span class="keywordflow">if</span> (!PostImplCall)</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;    Pos = PathDiagnosticLocation(PostImplCall-&gt;getLocation(),</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;                                 BRC.getSourceManager());</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;    Pos = PathDiagnosticLocation(S, BRC.getSourceManager(),</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;                                 N-&gt;getLocationContext());</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;  }</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160; </div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;  <span class="keyword">auto</span> <a class="code" href="ASTMatchersInternal_8cpp.html#a538dc9e683c4153ed65c95352d7ffa40">P</a> = std::make_shared&lt;PathDiagnosticEventPiece&gt;(Pos, Msg, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;  BR.addCallStackHint(<a class="code" href="ASTMatchersInternal_8cpp.html#a538dc9e683c4153ed65c95352d7ffa40">P</a>, std::move(StackHint));</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ASTMatchersInternal_8cpp.html#a538dc9e683c4153ed65c95352d7ffa40">P</a>;</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;}</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160; </div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;<span class="keywordtype">void</span> MallocChecker::printState(raw_ostream &amp;Out, <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>,</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">char</span> *NL, <span class="keyword">const</span> <span class="keywordtype">char</span> *Sep)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160; </div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;  RegionStateTy RS = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;get&lt;RegionState&gt;();</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160; </div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;  <span class="keywordflow">if</span> (!RS.isEmpty()) {</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;    Out &lt;&lt; Sep &lt;&lt; <span class="stringliteral">&quot;MallocChecker :&quot;</span> &lt;&lt; NL;</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    <span class="keywordflow">for</span> (RegionStateTy::iterator I = RS.begin(), E = RS.end(); I != E; ++I) {</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;      <span class="keyword">const</span> RefState *RefS = <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;get&lt;RegionState&gt;(I.getKey());</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;      AllocationFamily Family = RefS-&gt;getAllocationFamily();</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;      <a class="code" href="classllvm_1_1Optional.html">Optional&lt;MallocChecker::CheckKind&gt;</a> CheckKind = getCheckIfTracked(Family);</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;      <span class="keywordflow">if</span> (!CheckKind.hasValue())</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;         CheckKind = getCheckIfTracked(Family, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160; </div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;      I.getKey()-&gt;dumpToStream(Out);</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;      Out &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;      I.getData().dump(Out);</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;      <span class="keywordflow">if</span> (CheckKind.hasValue())</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;        Out &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; CheckNames[*CheckKind].getName() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;      Out &lt;&lt; NL;</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    }</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;  }</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;}</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160; </div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceclang.html">clang</a> {</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;<span class="keyword">namespace </span>ento {</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;<span class="keyword">namespace </span>allocation_state {</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160; </div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;<a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a></div>
<div class="line"><a name="l03597"></a><span class="lineno"><a class="line" href="namespaceclang_1_1ento_1_1allocation__state.html#a29462c918cfe94de7c8fb57c3c13a058"> 3597</a></span>&#160;<a class="code" href="namespaceclang_1_1ento_1_1allocation__state.html#a29462c918cfe94de7c8fb57c3c13a058">markReleased</a>(<a class="code" href="classllvm_1_1IntrusiveRefCntPtr.html">ProgramStateRef</a> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>, <a class="code" href="classclang_1_1ento_1_1SymExpr.html">SymbolRef</a> Sym, <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *Origin) {</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;  AllocationFamily Family = AF_InnerBuffer;</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a>-&gt;set&lt;RegionState&gt;(Sym, RefState::getReleased(Family, Origin));</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;}</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160; </div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;} <span class="comment">// end namespace allocation_state</span></div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;} <span class="comment">// end namespace ento</span></div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;} <span class="comment">// end namespace clang</span></div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160; </div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;<span class="comment">// Intended to be used in InnerPointerChecker to register the part of</span></div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;<span class="comment">// MallocChecker connected to it.</span></div>
<div class="line"><a name="l03608"></a><span class="lineno"><a class="line" href="namespaceclang_1_1ento.html#a9c8aca4f8b927847b5785d84ac0305d6"> 3608</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceclang_1_1ento.html#a9c8aca4f8b927847b5785d84ac0305d6">ento::registerInnerPointerCheckerAux</a>(<a class="code" href="classclang_1_1ento_1_1CheckerManager.html">CheckerManager</a> &amp;mgr) {</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;  MallocChecker *checker = mgr.<a class="code" href="classclang_1_1ento_1_1CheckerManager.html#a34fb2770f967daca02f358ac3095b152">getChecker</a>&lt;MallocChecker&gt;();</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;  checker-&gt;ChecksEnabled[MallocChecker::CK_InnerPointerChecker] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;  checker-&gt;CheckNames[MallocChecker::CK_InnerPointerChecker] =</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;      mgr.<a class="code" href="classclang_1_1ento_1_1CheckerManager.html#ad60686344ab5b998db0740cfc8374a8a">getCurrentCheckerName</a>();</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;}</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160; </div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;<span class="keywordtype">void</span> ento::registerDynamicMemoryModeling(CheckerManager &amp;mgr) {</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;  <span class="keyword">auto</span> *checker = mgr.registerChecker&lt;MallocChecker&gt;();</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;  checker-&gt;ShouldIncludeOwnershipAnnotatedFunctions =</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;      mgr.getAnalyzerOptions().getCheckerBooleanOption(checker, <span class="stringliteral">&quot;Optimistic&quot;</span>);</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;  checker-&gt;ShouldRegisterNoOwnershipChangeVisitor =</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;      mgr.getAnalyzerOptions().getCheckerBooleanOption(</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;          checker, <span class="stringliteral">&quot;AddNoOwnershipChangeNotes&quot;</span>);</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;}</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160; </div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;<span class="keywordtype">bool</span> ento::shouldRegisterDynamicMemoryModeling(<span class="keyword">const</span> CheckerManager &amp;mgr) {</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;}</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160; </div>
<div class="line"><a name="l03628"></a><span class="lineno"><a class="line" href="MallocChecker_8cpp.html#a16bafa3ab22e525da6f943cc02c2bef1"> 3628</a></span>&#160;<span class="preprocessor">#define REGISTER_CHECKER(name)                                                 \</span></div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;<span class="preprocessor">  void ento::register##name(CheckerManager &amp;mgr) {                             \</span></div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;<span class="preprocessor">    MallocChecker *checker = mgr.getChecker&lt;MallocChecker&gt;();                  \</span></div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;<span class="preprocessor">    checker-&gt;ChecksEnabled[MallocChecker::CK_##name] = true;                   \</span></div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;<span class="preprocessor">    checker-&gt;CheckNames[MallocChecker::CK_##name] =                            \</span></div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;<span class="preprocessor">        mgr.getCurrentCheckerName();                                           \</span></div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;<span class="preprocessor">  }                                                                            \</span></div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;<span class="preprocessor">                                                                               \</span></div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;<span class="preprocessor">  bool ento::shouldRegister##name(const CheckerManager &amp;mgr) { return true; }</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160; </div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;<a class="code" href="MallocChecker_8cpp.html#a16bafa3ab22e525da6f943cc02c2bef1">REGISTER_CHECKER</a>(MallocChecker)</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;<a class="code" href="MallocChecker_8cpp.html#a16bafa3ab22e525da6f943cc02c2bef1">REGISTER_CHECKER</a>(NewDeleteChecker)</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;<a class="code" href="MallocChecker_8cpp.html#a16bafa3ab22e525da6f943cc02c2bef1">REGISTER_CHECKER</a>(NewDeleteLeaksChecker)</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;<a class="code" href="MallocChecker_8cpp.html#a16bafa3ab22e525da6f943cc02c2bef1">REGISTER_CHECKER</a>(MismatchedDeallocatorChecker)</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aMallocChecker_8cpp_html_a7019fa32d4323ea2a05116240724e77f"><div class="ttname"><a href="MallocChecker_8cpp.html#a7019fa32d4323ea2a05116240724e77f">findFailedReallocSymbol</a></div><div class="ttdeci">static SymbolRef findFailedReallocSymbol(ProgramStateRef currState, ProgramStateRef prevState)</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l03352">MallocChecker.cpp:3352</a></div></div>
<div class="ttc" id="aclassclang_1_1ento_1_1Loc_html_ade52f99777d7f54628cdac05e9992878"><div class="ttname"><a href="classclang_1_1ento_1_1Loc.html#ade52f99777d7f54628cdac05e9992878">clang::ento::Loc::isLocType</a></div><div class="ttdeci">static bool isLocType(QualType T)</div><div class="ttdef"><b>Definition:</b> <a href="SVals_8h_source.html#l00335">SVals.h:335</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_a1f45158b71c9d04bfd6094ee29a38e59a1c38c1cbdb7ff99b102f29a5f8453f4d"><div class="ttname"><a href="namespaceclang_1_1ento.html#a1f45158b71c9d04bfd6094ee29a38e59a1c38c1cbdb7ff99b102f29a5f8453f4d">clang::ento::PSK_DirectEscapeOnCall</a></div><div class="ttdeci">@ PSK_DirectEscapeOnCall</div><div class="ttdoc">The pointer has been passed to a function call directly.</div><div class="ttdef"><b>Definition:</b> <a href="CheckerManager_8h_source.html#l00084">CheckerManager.h:84</a></div></div>
<div class="ttc" id="aclassclang_1_1Decl_html_a213239e747fb0b3a0cacd86267339af2"><div class="ttname"><a href="classclang_1_1Decl.html#a213239e747fb0b3a0cacd86267339af2">clang::Decl::getASTContext</a></div><div class="ttdeci">ASTContext &amp; getASTContext() const LLVM_READONLY</div><div class="ttdef"><b>Definition:</b> <a href="DeclBase_8cpp_source.html#l00414">DeclBase.cpp:414</a></div></div>
<div class="ttc" id="aclassclang_1_1CXXConstructorDecl_html"><div class="ttname"><a href="classclang_1_1CXXConstructorDecl.html">clang::CXXConstructorDecl</a></div><div class="ttdoc">Represents a C++ constructor within a class.</div><div class="ttdef"><b>Definition:</b> <a href="DeclCXX_8h_source.html#l02421">DeclCXX.h:2421</a></div></div>
<div class="ttc" id="aDynamicExtent_8h_html"><div class="ttname"><a href="DynamicExtent_8h.html">DynamicExtent.h</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_a29f56489e8bb504772dd89c914a7219e"><div class="ttname"><a href="MallocChecker_8cpp.html#a29f56489e8bb504772dd89c914a7219e">getDeepPointeeType</a></div><div class="ttdeci">static QualType getDeepPointeeType(QualType T)</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l01578">MallocChecker.cpp:1578</a></div></div>
<div class="ttc" id="aclassclang_1_1LocationContext_html"><div class="ttname"><a href="classclang_1_1LocationContext.html">clang::LocationContext</a></div><div class="ttdoc">It wraps the AnalysisDeclContext to represent both the call stack with the help of StackFrameContext ...</div><div class="ttdef"><b>Definition:</b> <a href="AnalysisDeclContext_8h_source.html#l00215">AnalysisDeclContext.h:215</a></div></div>
<div class="ttc" id="aCallDescription_8h_html"><div class="ttname"><a href="CallDescription_8h.html">CallDescription.h</a></div></div>
<div class="ttc" id="aclassclang_1_1LocationContext_html_ad83bf782b94f8931c1a28dfcd4b915bf"><div class="ttname"><a href="classclang_1_1LocationContext.html#ad83bf782b94f8931c1a28dfcd4b915bf">clang::LocationContext::getStackFrame</a></div><div class="ttdeci">const StackFrameContext * getStackFrame() const</div><div class="ttdef"><b>Definition:</b> <a href="AnalysisDeclContext_8cpp_source.html#l00463">AnalysisDeclContext.cpp:463</a></div></div>
<div class="ttc" id="aclassclang_1_1DeclaratorDecl_html_a73cead379a984c4b4ddb6e0d308725f6"><div class="ttname"><a href="classclang_1_1DeclaratorDecl.html#a73cead379a984c4b4ddb6e0d308725f6">clang::DeclaratorDecl::getBeginLoc</a></div><div class="ttdeci">SourceLocation getBeginLoc() const LLVM_READONLY</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l00779">Decl.h:779</a></div></div>
<div class="ttc" id="aSVals_8h_html"><div class="ttname"><a href="SVals_8h.html">SVals.h</a></div></div>
<div class="ttc" id="aclassclang_1_1SourceRange_html"><div class="ttname"><a href="classclang_1_1SourceRange.html">clang::SourceRange</a></div><div class="ttdoc">A trivial tuple used to represent a source range.</div><div class="ttdef"><b>Definition:</b> <a href="SourceLocation_8h_source.html#l00210">SourceLocation.h:210</a></div></div>
<div class="ttc" id="alib_2Tooling_2CMakeLists_8txt_html_af86de1f06488914e30d948a42f397df5"><div class="ttname"><a href="lib_2Tooling_2CMakeLists_8txt.html#af86de1f06488914e30d948a42f397df5">string</a></div><div class="ttdeci">string(SUBSTRING ${CMAKE_CURRENT_BINARY_DIR} 0 ${PATH_LIB_START} PATH_HEAD) string(SUBSTRING $</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Tooling_2CMakeLists_8txt_source.html#l00022">CMakeLists.txt:22</a></div></div>
<div class="ttc" id="aInterp_8cpp_html_a7366213a28ea9f41665f7fd8752f4318"><div class="ttname"><a href="Interp_8cpp.html#a7366213a28ea9f41665f7fd8752f4318">Ret</a></div><div class="ttdeci">static bool Ret(InterpState &amp;S, CodePtr &amp;PC, APValue &amp;Result)</div><div class="ttdef"><b>Definition:</b> <a href="Interp_8cpp_source.html#l00034">Interp.cpp:34</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_ade2304887c9dd0e9fad2e0ff35320739"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#ade2304887c9dd0e9fad2e0ff35320739">clang::ast_matchers::stmt</a></div><div class="ttdeci">const internal::VariadicAllOfMatcher&lt; Stmt &gt; stmt</div><div class="ttdoc">Matches statements.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00810">ASTMatchersInternal.cpp:810</a></div></div>
<div class="ttc" id="aclassclang_1_1Decl_html_ae7a63b99398864d86f53afd8a03c359b"><div class="ttname"><a href="classclang_1_1Decl.html#ae7a63b99398864d86f53afd8a03c359b">clang::Decl::hasAttr</a></div><div class="ttdeci">bool hasAttr() const</div><div class="ttdef"><b>Definition:</b> <a href="DeclBase_8h_source.html#l00541">DeclBase.h:541</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_af0d0e00a28f39eb324aea94250e58848"><div class="ttname"><a href="namespaceclang_1_1ento.html#af0d0e00a28f39eb324aea94250e58848">clang::ento::PathDiagnosticPieceRef</a></div><div class="ttdeci">std::shared_ptr&lt; PathDiagnosticPiece &gt; PathDiagnosticPieceRef</div><div class="ttdef"><b>Definition:</b> <a href="PathDiagnostic_8h_source.html#l00492">PathDiagnostic.h:492</a></div></div>
<div class="ttc" id="aclassclang_1_1ento_1_1CheckerManager_html_ad60686344ab5b998db0740cfc8374a8a"><div class="ttname"><a href="classclang_1_1ento_1_1CheckerManager.html#ad60686344ab5b998db0740cfc8374a8a">clang::ento::CheckerManager::getCurrentCheckerName</a></div><div class="ttdeci">CheckerNameRef getCurrentCheckerName() const</div><div class="ttdef"><b>Definition:</b> <a href="CheckerManager_8h_source.html#l00163">CheckerManager.h:163</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_ae56a1974283c9a2cb2410008e32fe3f1"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#ae56a1974283c9a2cb2410008e32fe3f1">clang::ast_matchers::anyOf</a></div><div class="ttdeci">const internal::VariadicOperatorMatcherFunc&lt; 2, std::numeric_limits&lt; unsigned &gt;::max()&gt; anyOf</div><div class="ttdoc">Matches if any of the given matchers matches.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00989">ASTMatchersInternal.cpp:989</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="LLVM_8h_source.html#l00038">LLVM.h:38</a></div></div>
<div class="ttc" id="aclassclang_1_1SourceLocation_html"><div class="ttname"><a href="classclang_1_1SourceLocation.html">clang::SourceLocation</a></div><div class="ttdoc">Encodes a location in the source.</div><div class="ttdef"><b>Definition:</b> <a href="SourceLocation_8h_source.html#l00086">SourceLocation.h:86</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a2adc91bda011c0b3ffcc4c315131cfb4"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a2adc91bda011c0b3ffcc4c315131cfb4">clang::ast_matchers::findAll</a></div><div class="ttdeci">internal::Matcher&lt; T &gt; findAll(const internal::Matcher&lt; T &gt; &amp;Matcher)</div><div class="ttdoc">Matches if the node or any descendant matches.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchers_8h_source.html#l03480">ASTMatchers.h:3480</a></div></div>
<div class="ttc" id="aclassclang_1_1NamedDecl_html"><div class="ttname"><a href="classclang_1_1NamedDecl.html">clang::NamedDecl</a></div><div class="ttdoc">This represents a decl that may have a name.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l00247">Decl.h:247</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_a9c8aca4f8b927847b5785d84ac0305d6"><div class="ttname"><a href="namespaceclang_1_1ento.html#a9c8aca4f8b927847b5785d84ac0305d6">clang::ento::registerInnerPointerCheckerAux</a></div><div class="ttdeci">void registerInnerPointerCheckerAux(CheckerManager &amp;Mgr)</div><div class="ttdoc">Register the part of MallocChecker connected to InnerPointerChecker.</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l03608">MallocChecker.cpp:3608</a></div></div>
<div class="ttc" id="ainclude_2clang_2Basic_2TargetInfo_8h_html"><div class="ttname"><a href="include_2clang_2Basic_2TargetInfo_8h.html">TargetInfo.h</a></div></div>
<div class="ttc" id="anamespaceclang_html_acdf88ec6c845aa781824469fcb0af66cac41a31890959544c6523af684561abe5"><div class="ttname"><a href="namespaceclang.html#acdf88ec6c845aa781824469fcb0af66cac41a31890959544c6523af684561abe5">clang::MultiVersionKind::Target</a></div><div class="ttdeci">@ Target</div></div>
<div class="ttc" id="aclassclang_1_1CXXDeleteExpr_html_a43ff28963a2f1cab913725fd4baa9306"><div class="ttname"><a href="classclang_1_1CXXDeleteExpr.html#a43ff28963a2f1cab913725fd4baa9306">clang::CXXDeleteExpr::isArrayForm</a></div><div class="ttdeci">bool isArrayForm() const</div><div class="ttdef"><b>Definition:</b> <a href="ExprCXX_8h_source.html#l02441">ExprCXX.h:2441</a></div></div>
<div class="ttc" id="aclassclang_1_1Stmt_html_a6844392ee6148b5fe821f211b95e5d1b"><div class="ttname"><a href="classclang_1_1Stmt.html#a6844392ee6148b5fe821f211b95e5d1b">clang::Stmt::getSourceRange</a></div><div class="ttdeci">SourceRange getSourceRange() const LLVM_READONLY</div><div class="ttdoc">SourceLocation tokens are not useful in isolation - they are low level value objects created/interpre...</div><div class="ttdef"><b>Definition:</b> <a href="Stmt_8cpp_source.html#l00324">Stmt.cpp:324</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_a4e45a121820f0d80d8910093dd33a1df"><div class="ttname"><a href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">clang::ento::ProgramStateRef</a></div><div class="ttdeci">IntrusiveRefCntPtr&lt; const ProgramState &gt; ProgramStateRef</div><div class="ttdef"><b>Definition:</b> <a href="ProgramState__Fwd_8h_source.html#l00037">ProgramState_Fwd.h:37</a></div></div>
<div class="ttc" id="aclassclang_1_1QualType_html"><div class="ttname"><a href="classclang_1_1QualType.html">clang::QualType</a></div><div class="ttdoc">A (possibly-)qualified type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00675">Type.h:675</a></div></div>
<div class="ttc" id="aAttr_8h_html"><div class="ttname"><a href="Attr_8h.html">Attr.h</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_aa399cd447f8c1174c25e8c499340a5d9"><div class="ttname"><a href="MallocChecker_8cpp.html#aa399cd447f8c1174c25e8c499340a5d9">CHECK_FN</a></div><div class="ttdeci">#define CHECK_FN(NAME)</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l00368">MallocChecker.cpp:368</a></div></div>
<div class="ttc" id="aclassclang_1_1FunctionDecl_html_afd761724c0261c3613c187ca98482442"><div class="ttname"><a href="classclang_1_1FunctionDecl.html#afd761724c0261c3613c187ca98482442">clang::FunctionDecl::getParamDecl</a></div><div class="ttdeci">const ParmVarDecl * getParamDecl(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l02510">Decl.h:2510</a></div></div>
<div class="ttc" id="anamespaceAttributeLangSupport_html_a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e"><div class="ttname"><a href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">AttributeLangSupport::C</a></div><div class="ttdeci">@ C</div><div class="ttdef"><b>Definition:</b> <a href="SemaDeclAttr_8cpp_source.html#l00054">SemaDeclAttr.cpp:54</a></div></div>
<div class="ttc" id="anamespaceclang_html_a5dc786a6640e4d510cd8b68a5a87a140a7749fb8107514089095277752fe75ece"><div class="ttname"><a href="namespaceclang.html#a5dc786a6640e4d510cd8b68a5a87a140a7749fb8107514089095277752fe75ece">clang::OMF_init</a></div><div class="ttdeci">@ OMF_init</div><div class="ttdef"><b>Definition:</b> <a href="IdentifierTable_8h_source.html#l00700">IdentifierTable.h:700</a></div></div>
<div class="ttc" id="aDeclCXX_8h_html"><div class="ttname"><a href="DeclCXX_8h.html">DeclCXX.h</a></div></div>
<div class="ttc" id="aProgramState__Fwd_8h_html"><div class="ttname"><a href="ProgramState__Fwd_8h.html">ProgramState_Fwd.h</a></div></div>
<div class="ttc" id="aSymbolManager_8h_html"><div class="ttname"><a href="SymbolManager_8h.html">SymbolManager.h</a></div></div>
<div class="ttc" id="aclassclang_1_1CXXNewExpr_html"><div class="ttname"><a href="classclang_1_1CXXNewExpr.html">clang::CXXNewExpr</a></div><div class="ttdoc">Represents a new-expression for memory allocation and constructor calls, e.g: &quot;new CXXNewExpr(foo)&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="ExprCXX_8h_source.html#l02139">ExprCXX.h:2139</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_a7b23a067324d14c5d493837dbc4fd8ca"><div class="ttname"><a href="namespaceclang_1_1ento.html#a7b23a067324d14c5d493837dbc4fd8ca">clang::ento::SymbolRef</a></div><div class="ttdeci">const SymExpr * SymbolRef</div><div class="ttdef"><b>Definition:</b> <a href="SymExpr_8h_source.html#l00110">SymExpr.h:110</a></div></div>
<div class="ttc" id="aclassclang_1_1FunctionDecl_html_ad303e1b462717d3e43e1ff09e7dedfe5"><div class="ttname"><a href="classclang_1_1FunctionDecl.html#ad303e1b462717d3e43e1ff09e7dedfe5">clang::FunctionDecl::getDeclaredReturnType</a></div><div class="ttdeci">QualType getDeclaredReturnType() const</div><div class="ttdoc">Get the declared return type, which may differ from the actual return type if the return type is dedu...</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l02558">Decl.h:2558</a></div></div>
<div class="ttc" id="aclassllvm_1_1Optional_html"><div class="ttname"><a href="classllvm_1_1Optional.html">llvm::Optional</a></div><div class="ttdef"><b>Definition:</b> <a href="LLVM_8h_source.html#l00040">LLVM.h:40</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_1_1bugreporter_html_af2ca64fac08b6097205ca3f72b002779"><div class="ttname"><a href="namespaceclang_1_1ento_1_1bugreporter.html#af2ca64fac08b6097205ca3f72b002779">clang::ento::bugreporter::TrackingKind</a></div><div class="ttdeci">TrackingKind</div><div class="ttdoc">Specifies the type of tracking for an expression.</div><div class="ttdef"><b>Definition:</b> <a href="BugReporterVisitors_8h_source.html#l00095">BugReporterVisitors.h:95</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8h_source.html#l00082">ASTContext.h:82</a></div></div>
<div class="ttc" id="aclassclang_1_1Lexer_html_a013b6a61a2f81044169446ca911a87db"><div class="ttname"><a href="classclang_1_1Lexer.html#a013b6a61a2f81044169446ca911a87db">clang::Lexer::getSourceText</a></div><div class="ttdeci">static StringRef getSourceText(CharSourceRange Range, const SourceManager &amp;SM, const LangOptions &amp;LangOpts, bool *Invalid=nullptr)</div><div class="ttdoc">Returns a string for the source that the range encompasses.</div><div class="ttdef"><b>Definition:</b> <a href="Lexer_8cpp_source.html#l00962">Lexer.cpp:962</a></div></div>
<div class="ttc" id="aclassclang_1_1QualType_html_ae248b51eebdb65da5c48bfd8694c7e51"><div class="ttname"><a href="classclang_1_1QualType.html#ae248b51eebdb65da5c48bfd8694c7e51">clang::QualType::getAsString</a></div><div class="ttdeci">static std::string getAsString(SplitQualType split, const PrintingPolicy &amp;Policy)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l01017">Type.h:1017</a></div></div>
<div class="ttc" id="aclassclang_1_1StackFrameContext_html"><div class="ttname"><a href="classclang_1_1StackFrameContext.html">clang::StackFrameContext</a></div><div class="ttdoc">It represents a stack frame of the call stack (based on CallEvent).</div><div class="ttdef"><b>Definition:</b> <a href="AnalysisDeclContext_8h_source.html#l00295">AnalysisDeclContext.h:295</a></div></div>
<div class="ttc" id="aSourceManager_8h_html"><div class="ttname"><a href="SourceManager_8h.html">SourceManager.h</a></div></div>
<div class="ttc" id="anamespaceclang_1_1tooling_html_a4ffee664435dba78b2225a5457619b53"><div class="ttname"><a href="namespaceclang_1_1tooling.html#a4ffee664435dba78b2225a5457619b53">clang::tooling::X</a></div><div class="ttdeci">static ToolExecutorPluginRegistry::Add&lt; AllTUsToolExecutorPlugin &gt; X(&quot;all-TUs&quot;, &quot;Runs FrontendActions on all TUs in the compilation database. &quot; &quot;Tool results are stored in memory.&quot;)</div></div>
<div class="ttc" id="aASTMatchFinder_8h_html"><div class="ttname"><a href="ASTMatchFinder_8h.html">ASTMatchFinder.h</a></div></div>
<div class="ttc" id="anamespaceclang_1_1index_html_a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e"><div class="ttname"><a href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">clang::index::SymbolRole::Call</a></div><div class="ttdeci">@ Call</div></div>
<div class="ttc" id="aCommonBugCategories_8h_html"><div class="ttname"><a href="CommonBugCategories_8h.html">CommonBugCategories.h</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_ae330047447f0de6b80e3301c139764f8"><div class="ttname"><a href="namespaceclang_1_1ento.html#ae330047447f0de6b80e3301c139764f8">clang::ento::Store</a></div><div class="ttdeci">const void * Store</div><div class="ttdoc">Store - This opaque type encapsulates an immutable mapping from locations to values.</div><div class="ttdef"><b>Definition:</b> <a href="StoreRef_8h_source.html#l00027">StoreRef.h:27</a></div></div>
<div class="ttc" id="aclassclang_1_1ASTContext_html_a091e2575135f7f9f1aeb25ba0090bfde"><div class="ttname"><a href="classclang_1_1ASTContext.html#a091e2575135f7f9f1aeb25ba0090bfde">clang::ASTContext::getSourceManager</a></div><div class="ttdeci">SourceManager &amp; getSourceManager()</div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8h_source.html#l00712">ASTContext.h:712</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_a7bfe6c6274bf85c686611be73363c7f5"><div class="ttname"><a href="namespaceclang_1_1ento.html#a7bfe6c6274bf85c686611be73363c7f5">clang::ento::tryExpandAsInteger</a></div><div class="ttdeci">llvm::Optional&lt; int &gt; tryExpandAsInteger(StringRef Macro, const Preprocessor &amp;PP)</div><div class="ttdoc">Try to parse the value of a defined preprocessor macro.</div><div class="ttdef"><b>Definition:</b> <a href="CheckerHelpers_8cpp_source.html#l00113">CheckerHelpers.cpp:113</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_a2aaae9c4c3f7405c8d3f21ea8d34722d"><div class="ttname"><a href="MallocChecker_8cpp.html#a2aaae9c4c3f7405c8d3f21ea8d34722d">printExpectedAllocName</a></div><div class="ttdeci">static void printExpectedAllocName(raw_ostream &amp;os, AllocationFamily Family)</div><div class="ttdoc">Print expected name of an allocator based on the deallocator's family derived from the DeallocExpr.</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l01881">MallocChecker.cpp:1881</a></div></div>
<div class="ttc" id="aclassclang_1_1PostImplicitCall_html"><div class="ttname"><a href="classclang_1_1PostImplicitCall.html">clang::PostImplicitCall</a></div><div class="ttdoc">Represents a program point just after an implicit call event.</div><div class="ttdef"><b>Definition:</b> <a href="ProgramPoint_8h_source.html#l00599">ProgramPoint.h:599</a></div></div>
<div class="ttc" id="aInterCheckerAPI_8h_html"><div class="ttname"><a href="InterCheckerAPI_8h.html">InterCheckerAPI.h</a></div></div>
<div class="ttc" id="aCallEvent_8h_html"><div class="ttname"><a href="CallEvent_8h.html">CallEvent.h</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a21c9455ba631c516e4e7818a0f7f8eff"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a21c9455ba631c516e4e7818a0f7f8eff">clang::ast_matchers::cxxDeleteExpr</a></div><div class="ttdeci">const internal::VariadicDynCastAllOfMatcher&lt; Stmt, CXXDeleteExpr &gt; cxxDeleteExpr</div><div class="ttdoc">Matches delete expressions.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00879">ASTMatchersInternal.cpp:879</a></div></div>
<div class="ttc" id="aFormat_8cpp_html_a9fcf84dffafb0ea03c0f9b686ddbf2b3"><div class="ttname"><a href="Format_8cpp.html#a9fcf84dffafb0ea03c0f9b686ddbf2b3">Offset</a></div><div class="ttdeci">unsigned Offset</div><div class="ttdef"><b>Definition:</b> <a href="Format_8cpp_source.html#l02552">Format.cpp:2552</a></div></div>
<div class="ttc" id="aProgramStateTrait_8h_html_a6d1893bb8c18543337b6c363c1319fcf"><div class="ttname"><a href="ProgramStateTrait_8h.html#a6d1893bb8c18543337b6c363c1319fcf">REGISTER_MAP_WITH_PROGRAMSTATE</a></div><div class="ttdeci">#define REGISTER_MAP_WITH_PROGRAMSTATE(Name, Key, Value)</div><div class="ttdoc">Declares an immutable map of type NameTy, suitable for placement into the ProgramState.</div><div class="ttdef"><b>Definition:</b> <a href="ProgramStateTrait_8h_source.html#l00084">ProgramStateTrait.h:84</a></div></div>
<div class="ttc" id="aByteCodeEmitter_8cpp_html_abcdace8b2ec8db6d1a21f45f8a45e6fd"><div class="ttname"><a href="ByteCodeEmitter_8cpp.html#abcdace8b2ec8db6d1a21f45f8a45e6fd">APSInt</a></div><div class="ttdeci">llvm::APSInt APSInt</div><div class="ttdef"><b>Definition:</b> <a href="ByteCodeEmitter_8cpp_source.html#l00019">ByteCodeEmitter.cpp:19</a></div></div>
<div class="ttc" id="aAllocationState_8h_html"><div class="ttname"><a href="AllocationState_8h.html">AllocationState.h</a></div></div>
<div class="ttc" id="anamespaceclang_1_1syntax_html_a0d10149d69e32e3c86140b4d325925e5a3225a10b07f1580f10dee4abc3779e6c"><div class="ttname"><a href="namespaceclang_1_1syntax.html#a0d10149d69e32e3c86140b4d325925e5a3225a10b07f1580f10dee4abc3779e6c">clang::syntax::NodeRole::Parameters</a></div><div class="ttdeci">@ Parameters</div></div>
<div class="ttc" id="aASTContext_8h_html_ab1457e11becd51c5d0c750caab5446c2"><div class="ttname"><a href="ASTContext_8h.html#ab1457e11becd51c5d0c750caab5446c2">V</a></div><div class="ttdeci">#define V(N, I)</div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8h_source.html#l03167">ASTContext.h:3167</a></div></div>
<div class="ttc" id="aProgramPoint_8h_html"><div class="ttname"><a href="ProgramPoint_8h.html">ProgramPoint.h</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html">clang::ast_matchers</a></div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchers_8h_source.html#l00098">ASTMatchers.h:98</a></div></div>
<div class="ttc" id="aBuiltinCheckerRegistration_8h_html"><div class="ttname"><a href="BuiltinCheckerRegistration_8h.html">BuiltinCheckerRegistration.h</a></div></div>
<div class="ttc" id="aDeclTemplate_8h_html"><div class="ttname"><a href="DeclTemplate_8h.html">DeclTemplate.h</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_a905832cd068cea677d3bad102375a557"><div class="ttname"><a href="MallocChecker_8cpp.html#a905832cd068cea677d3bad102375a557">CASE</a></div><div class="ttdeci">#define CASE(ID)</div></div>
<div class="ttc" id="aclassclang_1_1Decl_html_a9c0ac8ddf9155de0b95eeeb18034e50f"><div class="ttname"><a href="classclang_1_1Decl.html#a9c0ac8ddf9155de0b95eeeb18034e50f">clang::Decl::specific_attrs</a></div><div class="ttdeci">llvm::iterator_range&lt; specific_attr_iterator&lt; T &gt; &gt; specific_attrs() const</div><div class="ttdef"><b>Definition:</b> <a href="DeclBase_8h_source.html#l00523">DeclBase.h:523</a></div></div>
<div class="ttc" id="aclassclang_1_1VarDecl_html_a896f5f64bcbbbb005414e1549a61b3b1"><div class="ttname"><a href="classclang_1_1VarDecl.html#a896f5f64bcbbbb005414e1549a61b3b1">clang::VarDecl::isStaticLocal</a></div><div class="ttdeci">bool isStaticLocal() const</div><div class="ttdoc">Returns true if a variable with function scope is a static local variable.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l01124">Decl.h:1124</a></div></div>
<div class="ttc" id="aclassclang_1_1ento_1_1PathDiagnosticLocation_html_ad5e9747a36878bcaaf1c734e417f7fd6"><div class="ttname"><a href="classclang_1_1ento_1_1PathDiagnosticLocation.html#ad5e9747a36878bcaaf1c734e417f7fd6">clang::ento::PathDiagnosticLocation::create</a></div><div class="ttdeci">static PathDiagnosticLocation create(const Decl *D, const SourceManager &amp;SM)</div><div class="ttdoc">Create a location corresponding to the given declaration.</div><div class="ttdef"><b>Definition:</b> <a href="PathDiagnostic_8h_source.html#l00248">PathDiagnostic.h:248</a></div></div>
<div class="ttc" id="anamespaceclang_1_1XRayInstrKind_html_a74957f939e9c2b26d53095846a926c34"><div class="ttname"><a href="namespaceclang_1_1XRayInstrKind.html#a74957f939e9c2b26d53095846a926c34">clang::XRayInstrKind::None</a></div><div class="ttdeci">constexpr XRayInstrMask None</div><div class="ttdef"><b>Definition:</b> <a href="XRayInstr_8h_source.html#l00038">XRayInstr.h:38</a></div></div>
<div class="ttc" id="aCheckerManager_8h_html"><div class="ttname"><a href="CheckerManager_8h.html">CheckerManager.h</a></div></div>
<div class="ttc" id="aclassclang_1_1BlockExpr_html_ab1123558a2bed73c9016a52281912cea"><div class="ttname"><a href="classclang_1_1BlockExpr.html#ab1123558a2bed73c9016a52281912cea">clang::BlockExpr::getBlockDecl</a></div><div class="ttdeci">const BlockDecl * getBlockDecl() const</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l06035">Expr.h:6035</a></div></div>
<div class="ttc" id="aclassclang_1_1ASTContext_html"><div class="ttname"><a href="classclang_1_1ASTContext.html">clang::ASTContext</a></div><div class="ttdoc">Holds long-lived AST nodes (such as types and decls) that can be referred to throughout the semantic ...</div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8h_source.html#l00208">ASTContext.h:208</a></div></div>
<div class="ttc" id="aASTMatchers_8h_html"><div class="ttname"><a href="ASTMatchers_8h.html">ASTMatchers.h</a></div></div>
<div class="ttc" id="aclassclang_1_1ASTContext_html_a7c89acd533ffea38c5011885d8d029e4"><div class="ttname"><a href="classclang_1_1ASTContext.html#a7c89acd533ffea38c5011885d8d029e4">clang::ASTContext::getSizeType</a></div><div class="ttdeci">CanQualType getSizeType() const</div><div class="ttdoc">Return the unique type for &quot;size_t&quot; (C99 7.17), defined in &lt;stddef.h&gt;.</div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8cpp_source.html#l05827">ASTContext.cpp:5827</a></div></div>
<div class="ttc" id="aclassclang_1_1ento_1_1SymExpr_html"><div class="ttname"><a href="classclang_1_1ento_1_1SymExpr.html">clang::ento::SymExpr</a></div><div class="ttdoc">Symbolic value.</div><div class="ttdef"><b>Definition:</b> <a href="SymExpr_8h_source.html#l00029">SymExpr.h:29</a></div></div>
<div class="ttc" id="aclassclang_1_1FunctionDecl_html_a06987fa159c94bf40f8c716804e1dc27"><div class="ttname"><a href="classclang_1_1FunctionDecl.html#a06987fa159c94bf40f8c716804e1dc27">clang::FunctionDecl::getBody</a></div><div class="ttdeci">Stmt * getBody(const FunctionDecl *&amp;Definition) const</div><div class="ttdoc">Retrieve the body (definition) of the function.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8cpp_source.html#l03052">Decl.cpp:3052</a></div></div>
<div class="ttc" id="aclassclang_1_1LocationContext_html_a11efac841bf05dcba26313e753fc52a5"><div class="ttname"><a href="classclang_1_1LocationContext.html#a11efac841bf05dcba26313e753fc52a5">clang::LocationContext::isParentOf</a></div><div class="ttdeci">bool isParentOf(const LocationContext *LC) const</div><div class="ttdef"><b>Definition:</b> <a href="AnalysisDeclContext_8cpp_source.html#l00477">AnalysisDeclContext.cpp:477</a></div></div>
<div class="ttc" id="aclassclang_1_1CallExpr_html_aa454d6f1e76623da60451885239f63c6"><div class="ttname"><a href="classclang_1_1CallExpr.html#aa454d6f1e76623da60451885239f63c6">clang::CallExpr::getArg</a></div><div class="ttdeci">Expr * getArg(unsigned Arg)</div><div class="ttdoc">getArg - Return the specified argument.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l03044">Expr.h:3044</a></div></div>
<div class="ttc" id="aclassclang_1_1CXXDestructorDecl_html"><div class="ttname"><a href="classclang_1_1CXXDestructorDecl.html">clang::CXXDestructorDecl</a></div><div class="ttdoc">Represents a C++ destructor within a class.</div><div class="ttdef"><b>Definition:</b> <a href="DeclCXX_8h_source.html#l02688">DeclCXX.h:2688</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_abccf363be7226f4596aa265e9d055f56"><div class="ttname"><a href="MallocChecker_8cpp.html#abccf363be7226f4596aa265e9d055f56">didPreviousFreeFail</a></div><div class="ttdeci">static bool didPreviousFreeFail(ProgramStateRef State, SymbolRef Sym, SymbolRef &amp;RetStatusSymbol)</div><div class="ttdoc">Checks if the previous call to free on the given symbol failed - if free failed, returns true.</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l01829">MallocChecker.cpp:1829</a></div></div>
<div class="ttc" id="aExpr_8h_html"><div class="ttname"><a href="Expr_8h.html">Expr.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallString_html"><div class="ttname"><a href="classllvm_1_1SmallString.html">llvm::SmallString</a></div><div class="ttdef"><b>Definition:</b> <a href="LLVM_8h_source.html#l00037">LLVM.h:37</a></div></div>
<div class="ttc" id="anamespaceclang_1_1interp_html_a7b1ae11a0392cdbd2fc33ba108d4cfd3"><div class="ttname"><a href="namespaceclang_1_1interp.html#a7b1ae11a0392cdbd2fc33ba108d4cfd3">clang::interp::Zero</a></div><div class="ttdeci">bool Zero(InterpState &amp;S, CodePtr OpPC)</div><div class="ttdef"><b>Definition:</b> <a href="Interp_8h_source.html#l00814">Interp.h:814</a></div></div>
<div class="ttc" id="aProgramStateTrait_8h_html_ad90f9387b94b344eaaf499afec05f4d1"><div class="ttname"><a href="ProgramStateTrait_8h.html#ad90f9387b94b344eaaf499afec05f4d1">REGISTER_SET_WITH_PROGRAMSTATE</a></div><div class="ttdeci">#define REGISTER_SET_WITH_PROGRAMSTATE(Name, Elem)</div><div class="ttdoc">Declares an immutable set of type NameTy, suitable for placement into the ProgramState.</div><div class="ttdef"><b>Definition:</b> <a href="ProgramStateTrait_8h_source.html#l00109">ProgramStateTrait.h:109</a></div></div>
<div class="ttc" id="aclassclang_1_1VarDecl_html"><div class="ttname"><a href="classclang_1_1VarDecl.html">clang::VarDecl</a></div><div class="ttdoc">Represents a variable declaration or definition.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l00875">Decl.h:875</a></div></div>
<div class="ttc" id="aclassclang_1_1CallEnter_html_a081a17f74aa6cdc6e9325326d1a392a9"><div class="ttname"><a href="classclang_1_1CallEnter.html#a081a17f74aa6cdc6e9325326d1a392a9">clang::CallEnter::getCallExpr</a></div><div class="ttdeci">const Stmt * getCallExpr() const</div><div class="ttdef"><b>Definition:</b> <a href="ProgramPoint_8h_source.html#l00635">ProgramPoint.h:635</a></div></div>
<div class="ttc" id="aclassclang_1_1Type_html_a56c474868f4027b847f181f99b226f47"><div class="ttname"><a href="classclang_1_1Type.html#a56c474868f4027b847f181f99b226f47">clang::Type::getPointeeType</a></div><div class="ttdeci">QualType getPointeeType() const</div><div class="ttdoc">If this is a pointer, ObjC object pointer, or block pointer, this returns the respective pointee.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00625">Type.cpp:625</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_1_1bugreporter_html_af2ca64fac08b6097205ca3f72b002779a010b6767eb31718f372a73e0513e1410"><div class="ttname"><a href="namespaceclang_1_1ento_1_1bugreporter.html#af2ca64fac08b6097205ca3f72b002779a010b6767eb31718f372a73e0513e1410">clang::ento::bugreporter::TrackingKind::Thorough</a></div><div class="ttdeci">@ Thorough</div><div class="ttdoc">Default tracking kind – specifies that as much information should be gathered about the tracked expre...</div></div>
<div class="ttc" id="aclassclang_1_1CXXConstructExpr_html_adf45575cd1a16e246bdcfb89d5c45d1c"><div class="ttname"><a href="classclang_1_1CXXConstructExpr.html#adf45575cd1a16e246bdcfb89d5c45d1c">clang::CXXConstructExpr::getConstructor</a></div><div class="ttdeci">CXXConstructorDecl * getConstructor() const</div><div class="ttdoc">Get the constructor that this expression will (ultimately) call.</div><div class="ttdef"><b>Definition:</b> <a href="ExprCXX_8h_source.html#l01532">ExprCXX.h:1532</a></div></div>
<div class="ttc" id="aclassclang_1_1Type_html_a0506d2fd1e686757c62a2b1aa3f9de8d"><div class="ttname"><a href="classclang_1_1Type.html#a0506d2fd1e686757c62a2b1aa3f9de8d">clang::Type::getAsCXXRecordDecl</a></div><div class="ttdeci">CXXRecordDecl * getAsCXXRecordDecl() const</div><div class="ttdoc">Retrieves the CXXRecordDecl that this type refers to, either because the type is a RecordType or beca...</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l01760">Type.cpp:1760</a></div></div>
<div class="ttc" id="anamespaceclang_html_ae74346a5140f24995931cd3c4104e202"><div class="ttname"><a href="namespaceclang.html#ae74346a5140f24995931cd3c4104e202">clang::getOperatorSpelling</a></div><div class="ttdeci">const char * getOperatorSpelling(OverloadedOperatorKind Operator)</div><div class="ttdoc">Retrieve the spelling of the given overloaded operator, without the preceding &quot;operator&quot; keyword.</div><div class="ttdef"><b>Definition:</b> <a href="IdentifierTable_8cpp_source.html#l00744">IdentifierTable.cpp:744</a></div></div>
<div class="ttc" id="aExprCXX_8h_html"><div class="ttname"><a href="ExprCXX_8h.html">ExprCXX.h</a></div></div>
<div class="ttc" id="aUsingDeclarationsSorter_8cpp_html_aec13ba851f7e3aa70f5f3960f5d14324"><div class="ttname"><a href="UsingDeclarationsSorter_8cpp.html#aec13ba851f7e3aa70f5f3960f5d14324">Label</a></div><div class="ttdeci">std::string Label</div><div class="ttdef"><b>Definition:</b> <a href="UsingDeclarationsSorter_8cpp_source.html#l00069">UsingDeclarationsSorter.cpp:69</a></div></div>
<div class="ttc" id="aclassclang_1_1FunctionDecl_html_ac0027637798e850bd7f6c5f823ca6362"><div class="ttname"><a href="classclang_1_1FunctionDecl.html#ac0027637798e850bd7f6c5f823ca6362">clang::FunctionDecl::getOverloadedOperator</a></div><div class="ttdeci">OverloadedOperatorKind getOverloadedOperator() const</div><div class="ttdoc">getOverloadedOperator - Which C++ overloaded operator this function represents, if any.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8cpp_source.html#l03675">Decl.cpp:3675</a></div></div>
<div class="ttc" id="aclassclang_1_1AtomicExpr_html_aafb2a1534e844508c6c0979397e5261d"><div class="ttname"><a href="classclang_1_1AtomicExpr.html#aafb2a1534e844508c6c0979397e5261d">clang::AtomicExpr::AtomicOp</a></div><div class="ttdeci">AtomicOp</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l06289">Expr.h:6289</a></div></div>
<div class="ttc" id="aclassclang_1_1ObjCMessageExpr_html"><div class="ttname"><a href="classclang_1_1ObjCMessageExpr.html">clang::ObjCMessageExpr</a></div><div class="ttdoc">An expression that sends a message to the given Objective-C object or class.</div><div class="ttdef"><b>Definition:</b> <a href="ExprObjC_8h_source.html#l00940">ExprObjC.h:940</a></div></div>
<div class="ttc" id="aExplodedGraph_8h_html"><div class="ttname"><a href="ExplodedGraph_8h.html">ExplodedGraph.h</a></div></div>
<div class="ttc" id="anamespaceclang_html_a0667c189ac152d457c17935303efeb5a"><div class="ttname"><a href="namespaceclang.html#a0667c189ac152d457c17935303efeb5a">clang::OverloadedOperatorKind</a></div><div class="ttdeci">OverloadedOperatorKind</div><div class="ttdoc">Enumeration specifying the different kinds of C++ overloaded operators.</div><div class="ttdef"><b>Definition:</b> <a href="OperatorKinds_8h_source.html#l00021">OperatorKinds.h:21</a></div></div>
<div class="ttc" id="aStaticAnalyzer_2README_8txt_html_a1a264b3e48bda8ea3bed83698db8dca7"><div class="ttname"><a href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a></div><div class="ttdeci">and static some checkers Checker The latter are built on top of the former via the Checker and CheckerVisitor and attempts to isolate them from much of the gore of the internal analysis the analyzer is basically a source code simulator that traces out possible paths of execution The state of the and the combination of state and program point is a node in an exploded which has the entry program point and initial state</div><div class="ttdef"><b>Definition:</b> <a href="StaticAnalyzer_2README_8txt_source.html#l00030">README.txt:30</a></div></div>
<div class="ttc" id="aclassclang_1_1FunctionDecl_html_ae945682c5190f733b118993e5b1b9c1d"><div class="ttname"><a href="classclang_1_1FunctionDecl.html#ae945682c5190f733b118993e5b1b9c1d">clang::FunctionDecl::hasBody</a></div><div class="ttdeci">bool hasBody(const FunctionDecl *&amp;Definition) const</div><div class="ttdoc">Returns true if the function has a body.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8cpp_source.html#l02972">Decl.cpp:2972</a></div></div>
<div class="ttc" id="aclassclang_1_1BlockDecl_html_ac8ab93dffa4a9db6b57b8b85731aa690"><div class="ttname"><a href="classclang_1_1BlockDecl.html#ac8ab93dffa4a9db6b57b8b85731aa690">clang::BlockDecl::hasCaptures</a></div><div class="ttdeci">bool hasCaptures() const</div><div class="ttdoc">True if this block (or its nested blocks) captures anything of local storage from its enclosing scope...</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l04298">Decl.h:4298</a></div></div>
<div class="ttc" id="aclassclang_1_1LocationContext_html_a0d95890e7358d8102ae6056a89508bfb"><div class="ttname"><a href="classclang_1_1LocationContext.html#a0d95890e7358d8102ae6056a89508bfb">clang::LocationContext::getParent</a></div><div class="ttdeci">const LocationContext * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="AnalysisDeclContext_8h_source.html#l00243">AnalysisDeclContext.h:243</a></div></div>
<div class="ttc" id="aclassclang_1_1QualType_html_a3d98e87be0c7859cc21c6c158cb91f77"><div class="ttname"><a href="classclang_1_1QualType.html#a3d98e87be0c7859cc21c6c158cb91f77">clang::QualType::getDesugaredType</a></div><div class="ttdeci">QualType getDesugaredType(const ASTContext &amp;Context) const</div><div class="ttdoc">Return the specified type with any &quot;sugar&quot; removed from the type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00981">Type.h:981</a></div></div>
<div class="ttc" id="aclassclang_1_1ento_1_1CheckerManager_html_a34fb2770f967daca02f358ac3095b152"><div class="ttname"><a href="classclang_1_1ento_1_1CheckerManager.html#a34fb2770f967daca02f358ac3095b152">clang::ento::CheckerManager::getChecker</a></div><div class="ttdeci">CHECKER * getChecker()</div><div class="ttdef"><b>Definition:</b> <a href="CheckerManager_8h_source.html#l00218">CheckerManager.h:218</a></div></div>
<div class="ttc" id="aclassclang_1_1TargetInfo_html_abbc87af30c26901adb25c948c72e9039"><div class="ttname"><a href="classclang_1_1TargetInfo.html#abbc87af30c26901adb25c948c72e9039">clang::TargetInfo::getTriple</a></div><div class="ttdeci">const llvm::Triple &amp; getTriple() const</div><div class="ttdoc">Returns the target triple of the primary target.</div><div class="ttdef"><b>Definition:</b> <a href="include_2clang_2Basic_2TargetInfo_8h_source.html#l01160">TargetInfo.h:1160</a></div></div>
<div class="ttc" id="aclassclang_1_1ASTContext_html_a76182acff43ec4d01c06751bb8a2f7bc"><div class="ttname"><a href="classclang_1_1ASTContext.html#a76182acff43ec4d01c06751bb8a2f7bc">clang::ASTContext::UnsignedLongTy</a></div><div class="ttdeci">CanQualType UnsignedLongTy</div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8h_source.html#l01102">ASTContext.h:1102</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_1_1categories_html_add9507b029ad01a3e38dd5de81803da9"><div class="ttname"><a href="namespaceclang_1_1ento_1_1categories.html#add9507b029ad01a3e38dd5de81803da9">clang::ento::categories::MemoryError</a></div><div class="ttdeci">const char *const MemoryError</div><div class="ttdef"><b>Definition:</b> <a href="CommonBugCategories_8cpp_source.html#l00020">CommonBugCategories.cpp:20</a></div></div>
<div class="ttc" id="aclassclang_1_1ParentMap_html"><div class="ttname"><a href="classclang_1_1ParentMap.html">clang::ParentMap</a></div><div class="ttdef"><b>Definition:</b> <a href="ParentMap_8h_source.html#l00020">ParentMap.h:20</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_af6f31005567fd6e3e00d983e6f9df877"><div class="ttname"><a href="MallocChecker_8cpp.html#af6f31005567fd6e3e00d983e6f9df877">checkIfNewOrNewArrayFamily</a></div><div class="ttdeci">static bool checkIfNewOrNewArrayFamily(const RefState *RS)</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l03305">MallocChecker.cpp:3305</a></div></div>
<div class="ttc" id="aASTMatchersInternal_8cpp_html_a538dc9e683c4153ed65c95352d7ffa40"><div class="ttname"><a href="ASTMatchersInternal_8cpp.html#a538dc9e683c4153ed65c95352d7ffa40">P</a></div><div class="ttdeci">StringRef P</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00563">ASTMatchersInternal.cpp:563</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_aa60484f1d307e45c137f948c0d0976ae"><div class="ttname"><a href="MallocChecker_8cpp.html#aa60484f1d307e45c137f948c0d0976ae">printExpectedDeallocName</a></div><div class="ttdeci">static void printExpectedDeallocName(raw_ostream &amp;os, AllocationFamily Family)</div><div class="ttdoc">Print expected name of a deallocator based on the allocator's family.</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l01894">MallocChecker.cpp:1894</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_a686de38faf1dbbbf84b48c28e6f442b3"><div class="ttname"><a href="MallocChecker_8cpp.html#a686de38faf1dbbbf84b48c28e6f442b3">isReferenceCountingPointerDestructor</a></div><div class="ttdeci">static bool isReferenceCountingPointerDestructor(const CXXDestructorDecl *DD)</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l03366">MallocChecker.cpp:3366</a></div></div>
<div class="ttc" id="aclassclang_1_1ASTContext_html_a485732164c40553bb323c58f5e8bf7a7"><div class="ttname"><a href="classclang_1_1ASTContext.html#a485732164c40553bb323c58f5e8bf7a7">clang::ASTContext::VoidPtrTy</a></div><div class="ttdeci">CanQualType VoidPtrTy</div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8h_source.html#l01119">ASTContext.h:1119</a></div></div>
<div class="ttc" id="aclassclang_1_1Decl_html_a1e0b6223e2547ac65ddbf4802117998b"><div class="ttname"><a href="classclang_1_1Decl.html#a1e0b6223e2547ac65ddbf4802117998b">clang::Decl::hasAttrs</a></div><div class="ttdeci">bool hasAttrs() const</div><div class="ttdef"><b>Definition:</b> <a href="DeclBase_8h_source.html#l00483">DeclBase.h:483</a></div></div>
<div class="ttc" id="anamespaceclang_1_1syntax_html_a0d10149d69e32e3c86140b4d325925e5a6f6cb72d544962fa333e2e34ce64f719"><div class="ttname"><a href="namespaceclang_1_1syntax.html#a0d10149d69e32e3c86140b4d325925e5a6f6cb72d544962fa333e2e34ce64f719">clang::syntax::NodeRole::Size</a></div><div class="ttdeci">@ Size</div></div>
<div class="ttc" id="aBugType_8h_html"><div class="ttname"><a href="BugType_8h.html">BugType.h</a></div></div>
<div class="ttc" id="aclassclang_1_1NamedDecl_html_a7fab32caa3b7d601128265248260fd37"><div class="ttname"><a href="classclang_1_1NamedDecl.html#a7fab32caa3b7d601128265248260fd37">clang::NamedDecl::getIdentifier</a></div><div class="ttdeci">IdentifierInfo * getIdentifier() const</div><div class="ttdoc">Get the identifier that names this declaration, if there is one.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l00268">Decl.h:268</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_1_1allocation__state_html_a72de691ba75d72a8a1241477fa8a1b78"><div class="ttname"><a href="namespaceclang_1_1ento_1_1allocation__state.html#a72de691ba75d72a8a1241477fa8a1b78">clang::ento::allocation_state::getInnerPointerBRVisitor</a></div><div class="ttdeci">std::unique_ptr&lt; BugReporterVisitor &gt; getInnerPointerBRVisitor(SymbolRef Sym)</div><div class="ttdoc">This function provides an additional visitor that augments the bug report with information relevant t...</div><div class="ttdef"><b>Definition:</b> <a href="InnerPointerChecker_8cpp_source.html#l00288">InnerPointerChecker.cpp:288</a></div></div>
<div class="ttc" id="aclassclang_1_1ProgramPoint_html_aa4bd73e248c6fca35aad0b2c1fb7e8c6a34a09ff52d62e8c8a472ed2f948f43ec"><div class="ttname"><a href="classclang_1_1ProgramPoint.html#aa4bd73e248c6fca35aad0b2c1fb7e8c6a34a09ff52d62e8c8a472ed2f948f43ec">clang::ProgramPoint::PostImplicitCallKind</a></div><div class="ttdeci">@ PostImplicitCallKind</div><div class="ttdef"><b>Definition:</b> <a href="ProgramPoint_8h_source.html#l00082">ProgramPoint.h:82</a></div></div>
<div class="ttc" id="aCoverageMappingGen_8cpp_html_aac83d992338dc387528380660998fb50"><div class="ttname"><a href="CoverageMappingGen_8cpp.html#aac83d992338dc387528380660998fb50">dump</a></div><div class="ttdeci">static void dump(llvm::raw_ostream &amp;OS, StringRef FunctionName, ArrayRef&lt; CounterExpression &gt; Expressions, ArrayRef&lt; CounterMappingRegion &gt; Regions)</div><div class="ttdef"><b>Definition:</b> <a href="CoverageMappingGen_8cpp_source.html#l01519">CoverageMappingGen.cpp:1519</a></div></div>
<div class="ttc" id="aclassclang_1_1CharSourceRange_html_a5763cf308a9499dde63046fab463a61d"><div class="ttname"><a href="classclang_1_1CharSourceRange.html#a5763cf308a9499dde63046fab463a61d">clang::CharSourceRange::getTokenRange</a></div><div class="ttdeci">static CharSourceRange getTokenRange(SourceRange R)</div><div class="ttdef"><b>Definition:</b> <a href="SourceLocation_8h_source.html#l00261">SourceLocation.h:261</a></div></div>
<div class="ttc" id="aclassclang_1_1CallExpr_html_aa439df008533164342c841a8a22dec1f"><div class="ttname"><a href="classclang_1_1CallExpr.html#aa439df008533164342c841a8a22dec1f">clang::CallExpr::getNumArgs</a></div><div class="ttdeci">unsigned getNumArgs() const</div><div class="ttdoc">getNumArgs - Return the number of actual arguments to this call.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l03031">Expr.h:3031</a></div></div>
<div class="ttc" id="aclassclang_1_1CXXDeleteExpr_html"><div class="ttname"><a href="classclang_1_1CXXDeleteExpr.html">clang::CXXDeleteExpr</a></div><div class="ttdoc">Represents a delete expression for memory deallocation and destructor calls, e.g.</div><div class="ttdef"><b>Definition:</b> <a href="ExprCXX_8h_source.html#l02415">ExprCXX.h:2415</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_a1ba9eb5ec8a5cdfc494cce155f7c868c"><div class="ttname"><a href="MallocChecker_8cpp.html#a1ba9eb5ec8a5cdfc494cce155f7c868c">hasNonTrivialConstructorCall</a></div><div class="ttdeci">static bool hasNonTrivialConstructorCall(const CXXNewExpr *NE)</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l01589">MallocChecker.cpp:1589</a></div></div>
<div class="ttc" id="aclassclang_1_1QualType_html_a54127635d2ca4754e91ee96b594eff74"><div class="ttname"><a href="classclang_1_1QualType.html#a54127635d2ca4754e91ee96b594eff74">clang::QualType::isNull</a></div><div class="ttdeci">bool isNull() const</div><div class="ttdoc">Return true if this QualType doesn't point to a type yet.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00740">Type.h:740</a></div></div>
<div class="ttc" id="aclassclang_1_1BlockExpr_html"><div class="ttname"><a href="classclang_1_1BlockExpr.html">clang::BlockExpr</a></div><div class="ttdoc">BlockExpr - Adaptor class for mixing a BlockDecl with expressions.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l06023">Expr.h:6023</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdef"><b>Definition:</b> <a href="LLVM_8h_source.html#l00034">LLVM.h:34</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_ad2cfc698611276d3cd573c5a52a2fd84"><div class="ttname"><a href="MallocChecker_8cpp.html#ad2cfc698611276d3cd573c5a52a2fd84">printMemFnName</a></div><div class="ttdeci">static bool printMemFnName(raw_ostream &amp;os, CheckerContext &amp;C, const Expr *E)</div><div class="ttdoc">Print names of allocators and deallocators.</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l01842">MallocChecker.cpp:1842</a></div></div>
<div class="ttc" id="aLexer_8h_html"><div class="ttname"><a href="Lexer_8h.html">Lexer.h</a></div></div>
<div class="ttc" id="aclassclang_1_1Decl_html"><div class="ttname"><a href="classclang_1_1Decl.html">clang::Decl</a></div><div class="ttdoc">Decl - This represents one declaration (or definition), e.g.</div><div class="ttdef"><b>Definition:</b> <a href="DeclBase_8h_source.html#l00083">DeclBase.h:83</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_a14c7933795584298e9a477c08343e283a1cd1ee7f015a094299bae7dba5c27f7b"><div class="ttname"><a href="namespaceclang_1_1ento.html#a14c7933795584298e9a477c08343e283a1cd1ee7f015a094299bae7dba5c27f7b">clang::ento::CDF_MaybeBuiltin</a></div><div class="ttdeci">@ CDF_MaybeBuiltin</div><div class="ttdoc">Describes a C standard function that is sometimes implemented as a macro that expands to a compiler b...</div><div class="ttdef"><b>Definition:</b> <a href="CallDescription_8h_source.html#l00038">CallDescription.h:38</a></div></div>
<div class="ttc" id="aLLVM_8h_html"><div class="ttname"><a href="LLVM_8h.html">LLVM.h</a></div></div>
<div class="ttc" id="aclassclang_1_1ASTContext_html_a80ed5a736a74c76bbbd66b90821d1689"><div class="ttname"><a href="classclang_1_1ASTContext.html#a80ed5a736a74c76bbbd66b90821d1689">clang::ASTContext::CharTy</a></div><div class="ttdeci">CanQualType CharTy</div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8h_source.html#l01094">ASTContext.h:1094</a></div></div>
<div class="ttc" id="aUnwrappedLineFormatter_8cpp_html_a83e9e4ff6cb05dbdf72ab2a01aa289c0"><div class="ttname"><a href="UnwrappedLineFormatter_8cpp.html#a83e9e4ff6cb05dbdf72ab2a01aa289c0">State</a></div><div class="ttdeci">LineState State</div><div class="ttdef"><b>Definition:</b> <a href="UnwrappedLineFormatter_8cpp_source.html#l01083">UnwrappedLineFormatter.cpp:1083</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a460801cda670b9a3ccc3d42f51f3bd5c"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a460801cda670b9a3ccc3d42f51f3bd5c">clang::ast_matchers::callExpr</a></div><div class="ttdeci">const internal::VariadicDynCastAllOfMatcher&lt; Stmt, CallExpr &gt; callExpr</div><div class="ttdoc">Matches call expressions.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00817">ASTMatchersInternal.cpp:817</a></div></div>
<div class="ttc" id="aclassclang_1_1IdentifierInfo_html"><div class="ttname"><a href="classclang_1_1IdentifierInfo.html">clang::IdentifierInfo</a></div><div class="ttdoc">One of these records is kept for each identifier that is lexed.</div><div class="ttdef"><b>Definition:</b> <a href="IdentifierTable_8h_source.html#l00084">IdentifierTable.h:84</a></div></div>
<div class="ttc" id="aclassclang_1_1ASTContext_html_ac052b2e7614712bb410e01756f9669e9"><div class="ttname"><a href="classclang_1_1ASTContext.html#ac052b2e7614712bb410e01756f9669e9">clang::ASTContext::getTargetInfo</a></div><div class="ttdeci">const TargetInfo &amp; getTargetInfo() const</div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8h_source.html#l00764">ASTContext.h:764</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_ae6533c7f9026cf098295dadb134506d7"><div class="ttname"><a href="MallocChecker_8cpp.html#ae6533c7f9026cf098295dadb134506d7">isStandardNewDelete</a></div><div class="ttdeci">static bool isStandardNewDelete(const FunctionDecl *FD)</div><div class="ttdoc">Tells if the callee is one of the builtin new/delete operators, including placement operators and oth...</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l01087">MallocChecker.cpp:1087</a></div></div>
<div class="ttc" id="aCheckerContext_8h_html"><div class="ttname"><a href="CheckerContext_8h.html">CheckerContext.h</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_1_1allocation__state_html_ac1f0c9a29ca565930d37aaf30881300e"><div class="ttname"><a href="namespaceclang_1_1ento_1_1allocation__state.html#ac1f0c9a29ca565930d37aaf30881300e">clang::ento::allocation_state::getContainerObjRegion</a></div><div class="ttdeci">const MemRegion * getContainerObjRegion(ProgramStateRef State, SymbolRef Sym)</div><div class="ttdoc">'Sym' represents a pointer to the inner buffer of a container object.</div><div class="ttdef"><b>Definition:</b> <a href="InnerPointerChecker_8cpp_source.html#l00292">InnerPointerChecker.cpp:292</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ObjCPropertyAttribute_html_a5cee046f95725089d626e8e3c42bf60c"><div class="ttname"><a href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">clang::ObjCPropertyAttribute::Kind</a></div><div class="ttdeci">Kind</div><div class="ttdef"><b>Definition:</b> <a href="DeclObjCCommon_8h_source.html#l00022">DeclObjCCommon.h:22</a></div></div>
<div class="ttc" id="aProgramState_8h_html"><div class="ttname"><a href="ProgramState_8h.html">ProgramState.h</a></div></div>
<div class="ttc" id="aChecker_8h_html"><div class="ttname"><a href="Checker_8h.html">Checker.h</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_a923124dcac9f30d5c9d80541135f5d1e"><div class="ttname"><a href="MallocChecker_8cpp.html#a923124dcac9f30d5c9d80541135f5d1e">MallocUpdateRefState</a></div><div class="ttdeci">static ProgramStateRef MallocUpdateRefState(CheckerContext &amp;C, const Expr *E, ProgramStateRef State, AllocationFamily Family, Optional&lt; SVal &gt; RetVal=None)</div><div class="ttdoc">Update the RefState to reflect the new memory allocation.</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l01764">MallocChecker.cpp:1764</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="Format_8h_source.html#l04296">Format.h:4296</a></div></div>
<div class="ttc" id="anamespaceclang_1_1interp_html_a4722429e794a3d193b85f859eef008a1"><div class="ttname"><a href="namespaceclang_1_1interp.html#a4722429e794a3d193b85f859eef008a1">clang::interp::NE</a></div><div class="ttdeci">bool NE(InterpState &amp;S, CodePtr OpPC)</div><div class="ttdef"><b>Definition:</b> <a href="Interp_8h_source.html#l00225">Interp.h:225</a></div></div>
<div class="ttc" id="aParentMap_8h_html"><div class="ttname"><a href="ParentMap_8h.html">ParentMap.h</a></div></div>
<div class="ttc" id="aclassclang_1_1ento_1_1CheckerManager_html"><div class="ttname"><a href="classclang_1_1ento_1_1CheckerManager.html">clang::ento::CheckerManager</a></div><div class="ttdef"><b>Definition:</b> <a href="CheckerManager_8h_source.html#l00126">CheckerManager.h:126</a></div></div>
<div class="ttc" id="aclassclang_1_1IdentifierInfo_html_ae3eae8e88234cfc11812fc54266bd0f1"><div class="ttname"><a href="classclang_1_1IdentifierInfo.html#ae3eae8e88234cfc11812fc54266bd0f1">clang::IdentifierInfo::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return the actual identifier string.</div><div class="ttdef"><b>Definition:</b> <a href="IdentifierTable_8h_source.html#l00195">IdentifierTable.h:195</a></div></div>
<div class="ttc" id="anamespaceclang_1_1Builtin_html_a96281da348e2b70f3a45a66f6e48905c"><div class="ttname"><a href="namespaceclang_1_1Builtin.html#a96281da348e2b70f3a45a66f6e48905c">clang::Builtin::ID</a></div><div class="ttdeci">ID</div><div class="ttdef"><b>Definition:</b> <a href="Builtins_8h_source.html#l00049">Builtins.h:49</a></div></div>
<div class="ttc" id="anamespaceclang_html"><div class="ttname"><a href="namespaceclang.html">clang</a></div><div class="ttdef"><b>Definition:</b> <a href="CalledOnceCheck_8h_source.html#l00017">CalledOnceCheck.h:17</a></div></div>
<div class="ttc" id="aclassclang_1_1Selector_html"><div class="ttname"><a href="classclang_1_1Selector.html">clang::Selector</a></div><div class="ttdoc">Smart pointer class that efficiently represents Objective-C method names.</div><div class="ttdef"><b>Definition:</b> <a href="IdentifierTable_8h_source.html#l00752">IdentifierTable.h:752</a></div></div>
<div class="ttc" id="aclassclang_1_1NamedDecl_html_a944a976b455505507450bc68b56a9b75"><div class="ttname"><a href="classclang_1_1NamedDecl.html#a944a976b455505507450bc68b56a9b75">clang::NamedDecl::getQualifiedNameAsString</a></div><div class="ttdeci">std::string getQualifiedNameAsString(bool WithGlobalNsPrefix=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8cpp_source.html#l01597">Decl.cpp:1597</a></div></div>
<div class="ttc" id="aclassclang_1_1Stmt_html"><div class="ttname"><a href="classclang_1_1Stmt.html">clang::Stmt</a></div><div class="ttdoc">Stmt - This represents one statement.</div><div class="ttdef"><b>Definition:</b> <a href="Stmt_8h_source.html#l00069">Stmt.h:69</a></div></div>
<div class="ttc" id="aclassclang_1_1Decl_html_ad5bf0172af87a4324b9c8204206270d5"><div class="ttname"><a href="classclang_1_1Decl.html#ad5bf0172af87a4324b9c8204206270d5">clang::Decl::print</a></div><div class="ttdeci">void print(raw_ostream &amp;Out, unsigned Indentation=0, bool PrintInstantiation=false) const</div><div class="ttdef"><b>Definition:</b> <a href="DeclPrinter_8cpp_source.html#l00124">DeclPrinter.cpp:124</a></div></div>
<div class="ttc" id="aclassclang_1_1SourceManager_html_aa728bad682c5216d9efa45c03404447a"><div class="ttname"><a href="classclang_1_1SourceManager.html#aa728bad682c5216d9efa45c03404447a">clang::SourceManager::isInSystemHeader</a></div><div class="ttdeci">bool isInSystemHeader(SourceLocation Loc) const</div><div class="ttdoc">Returns if a SourceLocation is in a system header.</div><div class="ttdef"><b>Definition:</b> <a href="SourceManager_8h_source.html#l01488">SourceManager.h:1488</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a58409ce605d979d1d1e0a600ec417a0a"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a58409ce605d979d1d1e0a600ec417a0a">clang::ast_matchers::match</a></div><div class="ttdeci">SmallVector&lt; BoundNodes, 1 &gt; match(MatcherT Matcher, const NodeT &amp;Node, ASTContext &amp;Context)</div><div class="ttdoc">Returns the results of matching Matcher on Node.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchFinder_8h_source.html#l00312">ASTMatchFinder.h:312</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_aa6a7c10cdb22462332d65e8a53b70f01"><div class="ttname"><a href="MallocChecker_8cpp.html#aa6a7c10cdb22462332d65e8a53b70f01">isStandardRealloc</a></div><div class="ttdeci">static bool isStandardRealloc(const CallEvent &amp;Call)</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l01254">MallocChecker.cpp:1254</a></div></div>
<div class="ttc" id="aCheckerHelpers_8h_html"><div class="ttname"><a href="CheckerHelpers_8h.html">CheckerHelpers.h</a></div></div>
<div class="ttc" id="aclassclang_1_1Expr_html_ac9bfcc699442f2093723cfcf703d9f47"><div class="ttname"><a href="classclang_1_1Expr.html#ac9bfcc699442f2093723cfcf703d9f47">clang::Expr::getType</a></div><div class="ttdeci">QualType getType() const</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l00141">Expr.h:141</a></div></div>
<div class="ttc" id="aclassclang_1_1SourceLocation_html_a980da8d6100c0a0c3764991ca80ce6e7"><div class="ttname"><a href="classclang_1_1SourceLocation.html#a980da8d6100c0a0c3764991ca80ce6e7">clang::SourceLocation::isValid</a></div><div class="ttdeci">bool isValid() const</div><div class="ttdoc">Return true if this is a valid SourceLocation object.</div><div class="ttdef"><b>Definition:</b> <a href="SourceLocation_8h_source.html#l00110">SourceLocation.h:110</a></div></div>
<div class="ttc" id="aclassclang_1_1ento_1_1PathDiagnosticLocation_html_aa4cb63cfb236b8703eb589ab405b461c"><div class="ttname"><a href="classclang_1_1ento_1_1PathDiagnosticLocation.html#aa4cb63cfb236b8703eb589ab405b461c">clang::ento::PathDiagnosticLocation::createBegin</a></div><div class="ttdeci">static PathDiagnosticLocation createBegin(const Decl *D, const SourceManager &amp;SM)</div><div class="ttdoc">Create a location for the beginning of the declaration.</div><div class="ttdef"><b>Definition:</b> <a href="PathDiagnostic_8cpp_source.html#l00580">PathDiagnostic.cpp:580</a></div></div>
<div class="ttc" id="anamespaceclang_html_a44775134eba0623164027214ea176711a960b44c579bc2f6818d2daaf9e4c16f0"><div class="ttname"><a href="namespaceclang.html#a44775134eba0623164027214ea176711a960b44c579bc2f6818d2daaf9e4c16f0">clang::OverloadCandidateParamOrder::Normal</a></div><div class="ttdeci">@ Normal</div></div>
<div class="ttc" id="a____clang__hip__libdevice__declares_8h_html_aeec2d21816235dac201bf39185a3e86f"><div class="ttname"><a href="____clang__hip__libdevice__declares_8h.html#aeec2d21816235dac201bf39185a3e86f">s</a></div><div class="ttdeci">__device__ __2f16 float bool s</div><div class="ttdef"><b>Definition:</b> <a href="____clang__hip__libdevice__declares_8h_source.html#l00315">__clang_hip_libdevice_declares.h:315</a></div></div>
<div class="ttc" id="aclassclang_1_1CXXDeleteExpr_html_a4209bf12d646451c7206292e454c05f9"><div class="ttname"><a href="classclang_1_1CXXDeleteExpr.html#a4209bf12d646451c7206292e454c05f9">clang::CXXDeleteExpr::getArgument</a></div><div class="ttdeci">Expr * getArgument()</div><div class="ttdef"><b>Definition:</b> <a href="ExprCXX_8h_source.html#l02456">ExprCXX.h:2456</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_a863f125a89c96743e0fc44fc2796ebbc"><div class="ttname"><a href="MallocChecker_8cpp.html#a863f125a89c96743e0fc44fc2796ebbc">isGRealloc</a></div><div class="ttdeci">static bool isGRealloc(const CallEvent &amp;Call)</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l01268">MallocChecker.cpp:1268</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_a1f45158b71c9d04bfd6094ee29a38e59"><div class="ttname"><a href="namespaceclang_1_1ento.html#a1f45158b71c9d04bfd6094ee29a38e59">clang::ento::PointerEscapeKind</a></div><div class="ttdeci">PointerEscapeKind</div><div class="ttdoc">Describes the different reasons a pointer escapes during analysis.</div><div class="ttdef"><b>Definition:</b> <a href="CheckerManager_8h_source.html#l00078">CheckerManager.h:78</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_a2a7903a04bcc80b227a601bafdf4d128"><div class="ttname"><a href="MallocChecker_8cpp.html#a2a7903a04bcc80b227a601bafdf4d128">isReleased</a></div><div class="ttdeci">static bool isReleased(SymbolRef Sym, CheckerContext &amp;C)</div><div class="ttdoc">Check if the memory associated with this symbol was released.</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l03005">MallocChecker.cpp:3005</a></div></div>
<div class="ttc" id="aclassclang_1_1CallEnter_html"><div class="ttname"><a href="classclang_1_1CallEnter.html">clang::CallEnter</a></div><div class="ttdoc">Represents a point when we begin processing an inlined call.</div><div class="ttdef"><b>Definition:</b> <a href="ProgramPoint_8h_source.html#l00629">ProgramPoint.h:629</a></div></div>
<div class="ttc" id="aclassclang_1_1ast__matchers_1_1BoundNodes_html"><div class="ttname"><a href="classclang_1_1ast__matchers_1_1BoundNodes.html">clang::ast_matchers::BoundNodes</a></div><div class="ttdoc">Maps string IDs to AST nodes matched by parts of a matcher.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchers_8h_source.html#l00107">ASTMatchers.h:107</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_aec69b4d8a2399220a5c7df7b4f0534c0"><div class="ttname"><a href="namespaceclang_1_1ento.html#aec69b4d8a2399220a5c7df7b4f0534c0">clang::ento::setDynamicExtent</a></div><div class="ttdeci">ProgramStateRef setDynamicExtent(ProgramStateRef State, const MemRegion *MR, DefinedOrUnknownSVal Extent, SValBuilder &amp;SVB)</div><div class="ttdoc">Set the dynamic extent Extent of the region MR.</div></div>
<div class="ttc" id="anamespaceclang_1_1ento_1_1allocation__state_html_a29462c918cfe94de7c8fb57c3c13a058"><div class="ttname"><a href="namespaceclang_1_1ento_1_1allocation__state.html#a29462c918cfe94de7c8fb57c3c13a058">clang::ento::allocation_state::markReleased</a></div><div class="ttdeci">ProgramStateRef markReleased(ProgramStateRef State, SymbolRef Sym, const Expr *Origin)</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l03597">MallocChecker.cpp:3597</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_ae1e7389f740cf97f5021b0c02a795abd"><div class="ttname"><a href="MallocChecker_8cpp.html#ae1e7389f740cf97f5021b0c02a795abd">isKnownDeallocObjCMethodName</a></div><div class="ttdeci">static bool isKnownDeallocObjCMethodName(const ObjCMethodCall &amp;Call)</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l01654">MallocChecker.cpp:1654</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="LLVM_8h_source.html#l00039">LLVM.h:39</a></div></div>
<div class="ttc" id="aclassclang_1_1ParentMap_html_a1019668ec664a33b4d9d51b169493a3a"><div class="ttname"><a href="classclang_1_1ParentMap.html#a1019668ec664a33b4d9d51b169493a3a">clang::ParentMap::isConsumedExpr</a></div><div class="ttdeci">bool isConsumedExpr(Expr *E) const</div><div class="ttdef"><b>Definition:</b> <a href="ParentMap_8cpp_source.html#l00170">ParentMap.cpp:170</a></div></div>
<div class="ttc" id="aclassclang_1_1ValueDecl_html_a673ae4e2fab42426820de8df166fef5d"><div class="ttname"><a href="classclang_1_1ValueDecl.html#a673ae4e2fab42426820de8df166fef5d">clang::ValueDecl::getType</a></div><div class="ttdeci">QualType getType() const</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l00686">Decl.h:686</a></div></div>
<div class="ttc" id="aProgramStateTrait_8h_html"><div class="ttname"><a href="ProgramStateTrait_8h.html">ProgramStateTrait.h</a></div></div>
<div class="ttc" id="aclassclang_1_1Expr_html"><div class="ttname"><a href="classclang_1_1Expr.html">clang::Expr</a></div><div class="ttdoc">This represents one expression.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l00109">Expr.h:109</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_ab2743eb22efec4f33d5138cfb12366d6"><div class="ttname"><a href="namespaceclang_1_1ento.html#ab2743eb22efec4f33d5138cfb12366d6">clang::ento::InvalidatedSymbols</a></div><div class="ttdeci">llvm::DenseSet&lt; SymbolRef &gt; InvalidatedSymbols</div><div class="ttdef"><b>Definition:</b> <a href="Store_8h_source.html#l00051">Store.h:51</a></div></div>
<div class="ttc" id="aclassclang_1_1FunctionDecl_html_ab95c29a19de7d1c1e967d59cdbac2dcc"><div class="ttname"><a href="classclang_1_1FunctionDecl.html#ab95c29a19de7d1c1e967d59cdbac2dcc">clang::FunctionDecl::parameters</a></div><div class="ttdeci">ArrayRef&lt; ParmVarDecl * &gt; parameters() const</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l02487">Decl.h:2487</a></div></div>
<div class="ttc" id="aclassclang_1_1Decl_html_a9ac934b2f7ae95704682dc44da1f0867"><div class="ttname"><a href="classclang_1_1Decl.html#a9ac934b2f7ae95704682dc44da1f0867">clang::Decl::getLocation</a></div><div class="ttdeci">SourceLocation getLocation() const</div><div class="ttdef"><b>Definition:</b> <a href="DeclBase_8h_source.html#l00424">DeclBase.h:424</a></div></div>
<div class="ttc" id="aclassclang_1_1DeclRefExpr_html"><div class="ttname"><a href="classclang_1_1DeclRefExpr.html">clang::DeclRefExpr</a></div><div class="ttdoc">A reference to a declared variable, function, enum, etc.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l01223">Expr.h:1223</a></div></div>
<div class="ttc" id="aExprConstant_8cpp_html_ae4a213489715e2de4562b3ae0538648da6adf97f83acf6453d4a6a4b1070f3754"><div class="ttname"><a href="ExprConstant_8cpp.html#ae4a213489715e2de4562b3ae0538648da6adf97f83acf6453d4a6a4b1070f3754">GCCTypeClass::None</a></div><div class="ttdeci">@ None</div></div>
<div class="ttc" id="aclassclang_1_1LocationContext_html_a5f34d4aa5d22732cbe4500b406312431"><div class="ttname"><a href="classclang_1_1LocationContext.html#a5f34d4aa5d22732cbe4500b406312431">clang::LocationContext::getDecl</a></div><div class="ttdeci">const Decl * getDecl() const</div><div class="ttdef"><b>Definition:</b> <a href="AnalysisDeclContext_8h_source.html#l00247">AnalysisDeclContext.h:247</a></div></div>
<div class="ttc" id="aclassclang_1_1FunctionDecl_html"><div class="ttname"><a href="classclang_1_1FunctionDecl.html">clang::FunctionDecl</a></div><div class="ttdoc">Represents a function declaration or definition.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l01856">Decl.h:1856</a></div></div>
<div class="ttc" id="aStoreRef_8h_html"><div class="ttname"><a href="StoreRef_8h.html">StoreRef.h</a></div></div>
<div class="ttc" id="aclassclang_1_1CallExpr_html"><div class="ttname"><a href="classclang_1_1CallExpr.html">clang::CallExpr</a></div><div class="ttdoc">CallExpr - Represents a function call (C99 6.5.2.2, C++ [expr.call]).</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l02853">Expr.h:2853</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_a16bafa3ab22e525da6f943cc02c2bef1"><div class="ttname"><a href="MallocChecker_8cpp.html#a16bafa3ab22e525da6f943cc02c2bef1">REGISTER_CHECKER</a></div><div class="ttdeci">#define REGISTER_CHECKER(name)</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l03628">MallocChecker.cpp:3628</a></div></div>
<div class="ttc" id="aclassclang_1_1CXXConstructExpr_html"><div class="ttname"><a href="classclang_1_1CXXConstructExpr.html">clang::CXXConstructExpr</a></div><div class="ttdoc">Represents a call to a C++ constructor.</div><div class="ttdef"><b>Definition:</b> <a href="ExprCXX_8h_source.html#l01460">ExprCXX.h:1460</a></div></div>
<div class="ttc" id="aMallocChecker_8cpp_html_abc20428bd6d598274e9deea1e5e0d068"><div class="ttname"><a href="MallocChecker_8cpp.html#abc20428bd6d598274e9deea1e5e0d068">getFreeWhenDoneArg</a></div><div class="ttdeci">static Optional&lt; bool &gt; getFreeWhenDoneArg(const ObjCMethodCall &amp;Call)</div><div class="ttdef"><b>Definition:</b> <a href="MallocChecker_8cpp_source.html#l01666">MallocChecker.cpp:1666</a></div></div>
<div class="ttc" id="anamespaceclang_html_a4a57f21b55a81cefae4379e09a3be0c3"><div class="ttname"><a href="namespaceclang.html#a4a57f21b55a81cefae4379e09a3be0c3">clang::operator==</a></div><div class="ttdeci">bool operator==(const CallGraphNode::CallRecord &amp;LHS, const CallGraphNode::CallRecord &amp;RHS)</div><div class="ttdef"><b>Definition:</b> <a href="CallGraph_8h_source.html#l00223">CallGraph.h:223</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrusiveRefCntPtr_html"><div class="ttname"><a href="classllvm_1_1IntrusiveRefCntPtr.html">llvm::IntrusiveRefCntPtr&lt; const ProgramState &gt;</a></div></div>
<div class="ttc" id="a____clang__cuda__cmath_8h_html_ac1b35672b5f9f009e233daf419b34dbb"><div class="ttname"><a href="____clang__cuda__cmath_8h.html#ac1b35672b5f9f009e233daf419b34dbb">abs</a></div><div class="ttdeci">__DEVICE__ long long abs(long long __n)</div><div class="ttdef"><b>Definition:</b> <a href="____clang__cuda__cmath_8h_source.html#l00041">__clang_cuda_cmath.h:41</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924"><div class="ttname"><a href="namespaceclang_1_1ento.html#aaa9478ede47d40f326648cd3bb0b25a4a17bc10091293fdc562a6db69940ee924">clang::ento::ObjKind::OS</a></div><div class="ttdeci">@ OS</div><div class="ttdoc">Indicates that the tracking object is a descendant of a referenced-counted OSObject,...</div></div>
<div class="ttc" id="aclassclang_1_1ReturnStmt_html"><div class="ttname"><a href="classclang_1_1ReturnStmt.html">clang::ReturnStmt</a></div><div class="ttdoc">ReturnStmt - This represents a return, optionally of an expression: return; return 4;.</div><div class="ttdef"><b>Definition:</b> <a href="Stmt_8h_source.html#l02765">Stmt.h:2765</a></div></div>
<div class="ttc" id="aclassclang_1_1CXXMethodDecl_html_a290cbceee004310e1a43bb8cd9ab25de"><div class="ttname"><a href="classclang_1_1CXXMethodDecl.html#a290cbceee004310e1a43bb8cd9ab25de">clang::CXXMethodDecl::getParent</a></div><div class="ttdeci">const CXXRecordDecl * getParent() const</div><div class="ttdoc">Return the parent of this method declaration, which is the class in which this method is defined.</div><div class="ttdef"><b>Definition:</b> <a href="DeclCXX_8h_source.html#l02083">DeclCXX.h:2083</a></div></div>
<div class="ttc" id="aclassclang_1_1NamedDecl_html_a350fd0415d5f387716d5a970b9de4c29"><div class="ttname"><a href="classclang_1_1NamedDecl.html#a350fd0415d5f387716d5a970b9de4c29">clang::NamedDecl::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Get the name of identifier for this declaration as a StringRef.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l00274">Decl.h:274</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 4 2022 01:35:53 for clang by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
