<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>clang: lib/StaticAnalyzer/Checkers/ChrootChecker.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">clang
   &#160;<span id="projectnumber">15.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_5323669f7aaa7f9ff43db9a3c9e1bf2d.html">StaticAnalyzer</a></li><li class="navelem"><a class="el" href="dir_98a0d9a5a3820cce728a787f3e823141.html">Checkers</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ChrootChecker.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ChrootChecker_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- ChrootChecker.cpp - chroot usage checks ---------------------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//  This file defines chroot checker, which checks improper use of chroot.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BuiltinCheckerRegistration_8h.html">clang/StaticAnalyzer/Checkers/BuiltinCheckerRegistration.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BugType_8h.html">clang/StaticAnalyzer/Core/BugReporter/BugType.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Checker_8h.html">clang/StaticAnalyzer/Core/Checker.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CheckerManager_8h.html">clang/StaticAnalyzer/Core/CheckerManager.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallDescription_8h.html">clang/StaticAnalyzer/Core/PathSensitive/CallDescription.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallEvent_8h.html">clang/StaticAnalyzer/Core/PathSensitive/CallEvent.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CheckerContext_8h.html">clang/StaticAnalyzer/Core/PathSensitive/CheckerContext.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProgramState_8h.html">clang/StaticAnalyzer/Core/PathSensitive/ProgramState.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProgramStateTrait_8h.html">clang/StaticAnalyzer/Core/PathSensitive/ProgramStateTrait.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SymbolManager_8h.html">clang/StaticAnalyzer/Core/PathSensitive/SymbolManager.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceclang.html">clang</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">using namespace </span>ento;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// enum value that represent the jail state</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">enum</span> <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> { NO_CHROOT, ROOT_CHANGED, JAIL_ENTERED };</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keywordtype">bool</span> isRootChanged(<a class="code" href="opencl-c-base_8h.html#a0bd5dec00e345e69027427f8621d6a6c">intptr_t</a> k) { <span class="keywordflow">return</span> k == ROOT_CHANGED; }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//bool isJailEntered(intptr_t k) { return k == JAIL_ENTERED; }</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// This checker checks improper use of chroot.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// The state transition:</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// NO_CHROOT ---chroot(path)--&gt; ROOT_CHANGED ---chdir(/) --&gt; JAIL_ENTERED</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//                                  |                               |</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//         ROOT_CHANGED&lt;--chdir(..)--      JAIL_ENTERED&lt;--chdir(..)--</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//                                  |                               |</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//                      bug&lt;--foo()--          JAIL_ENTERED&lt;--foo()--</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">class </span>ChrootChecker : <span class="keyword">public</span> Checker&lt;eval::Call, check::PreCall&gt; {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">// This bug refers to possibly break out of a chroot() jail.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;BuiltinBug&gt; BT_BreakJail;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keyword">const</span> CallDescription Chroot{<span class="stringliteral">&quot;chroot&quot;</span>, 1}, Chdir{<span class="stringliteral">&quot;chdir&quot;</span>, 1};</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  ChrootChecker() {}</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> *getTag() {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="CodeGen_2README_8txt.html#a2f5467b833926827f4292d3ba7fea003">x</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">return</span> &amp;<a class="code" href="CodeGen_2README_8txt.html#a2f5467b833926827f4292d3ba7fea003">x</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">bool</span> evalCall(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">void</span> checkPreCall(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">void</span> evalChroot(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordtype">void</span> evalChdir(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;};</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keywordtype">bool</span> ChrootChecker::evalCall(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">if</span> (Chroot.matches(Call)) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    evalChroot(Call, C);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">if</span> (Chdir.matches(Call)) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    evalChdir(Call, C);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keywordtype">void</span> ChrootChecker::evalChroot(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  ProgramStateManager &amp;Mgr = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;getStateManager();</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// Once encouter a chroot(), set the enum value ROOT_CHANGED directly in</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// the GDM.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = Mgr.addGDM(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>, ChrootChecker::getTag(), (<span class="keywordtype">void</span>*) ROOT_CHANGED);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keywordtype">void</span> ChrootChecker::evalChdir(<span class="keyword">const</span> CallEvent &amp;Call, CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">ProgramStateRef</a> <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  ProgramStateManager &amp;Mgr = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;getStateManager();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">// If there are no jail state in the GDM, just return.</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">void</span> *k = <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>-&gt;FindGDM(ChrootChecker::getTag());</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span> (!k)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// After chdir(&quot;/&quot;), enter the jail, set the enum value JAIL_ENTERED.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *ArgExpr = <a class="code" href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">Call</a>.getArgExpr(0);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  SVal ArgVal = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getSVal(ArgExpr);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> MemRegion *R = ArgVal.getAsRegion()) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    R = R-&gt;StripCasts();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> StringRegion* StrRegion= dyn_cast&lt;StringRegion&gt;(R)) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keyword">const</span> <a class="code" href="classclang_1_1StringLiteral.html">StringLiteral</a>* Str = StrRegion-&gt;getStringLiteral();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">if</span> (Str-&gt;<a class="code" href="classclang_1_1StringLiteral.html#ad22b80b61dba8e5c885377cf2a3b0d87">getString</a>() == <span class="stringliteral">&quot;/&quot;</span>)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a> = Mgr.addGDM(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>, ChrootChecker::getTag(),</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                           (<span class="keywordtype">void</span>*) JAIL_ENTERED);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.addTransition(<a class="code" href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">// Check the jail state before any function call except chroot and chdir().</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keywordtype">void</span> ChrootChecker::checkPreCall(<span class="keyword">const</span> CallEvent &amp;Call,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                 CheckerContext &amp;C)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">// Ignore chroot and chdir.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">if</span> (matchesAny(Call, Chroot, Chdir))</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">// If jail state is ROOT_CHANGED, generate BugReport.</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordtype">void</span> *<span class="keyword">const</span>* k = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.getState()-&gt;FindGDM(ChrootChecker::getTag());</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">if</span> (k)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span> (isRootChanged((<a class="code" href="opencl-c-base_8h.html#a0bd5dec00e345e69027427f8621d6a6c">intptr_t</a>) *k))</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">if</span> (ExplodedNode *N = <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.generateNonFatalErrorNode()) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> (!BT_BreakJail)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          BT_BreakJail.reset(<span class="keyword">new</span> BuiltinBug(</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;              <span class="keyword">this</span>, <span class="stringliteral">&quot;Break out of jail&quot;</span>, <span class="stringliteral">&quot;No call of chdir(\&quot;/\&quot;) immediately &quot;</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                         <span class="stringliteral">&quot;after chroot&quot;</span>));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <a class="code" href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">C</a>.emitReport(std::make_unique&lt;PathSensitiveBugReport&gt;(</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            *BT_BreakJail, BT_BreakJail-&gt;getDescription(), N));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordtype">void</span> ento::registerChrootChecker(CheckerManager &amp;mgr) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  mgr.registerChecker&lt;ChrootChecker&gt;();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordtype">bool</span> ento::shouldRegisterChrootChecker(<span class="keyword">const</span> CheckerManager &amp;mgr) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aCallDescription_8h_html"><div class="ttname"><a href="CallDescription_8h.html">CallDescription.h</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ento_html_a4e45a121820f0d80d8910093dd33a1df"><div class="ttname"><a href="namespaceclang_1_1ento.html#a4e45a121820f0d80d8910093dd33a1df">clang::ento::ProgramStateRef</a></div><div class="ttdeci">IntrusiveRefCntPtr&lt; const ProgramState &gt; ProgramStateRef</div><div class="ttdef"><b>Definition:</b> <a href="ProgramState__Fwd_8h_source.html#l00037">ProgramState_Fwd.h:37</a></div></div>
<div class="ttc" id="anamespaceAttributeLangSupport_html_a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e"><div class="ttname"><a href="namespaceAttributeLangSupport.html#a2f895ae8ae6d7966390f197b109d1f4dac1c6ab9ca121c29c650b3ab6a4212b4e">AttributeLangSupport::C</a></div><div class="ttdeci">@ C</div><div class="ttdef"><b>Definition:</b> <a href="SemaDeclAttr_8cpp_source.html#l00054">SemaDeclAttr.cpp:54</a></div></div>
<div class="ttc" id="aSymbolManager_8h_html"><div class="ttname"><a href="SymbolManager_8h.html">SymbolManager.h</a></div></div>
<div class="ttc" id="anamespaceclang_1_1index_html_a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e"><div class="ttname"><a href="namespaceclang_1_1index.html#a21cdcb5f0f9f26abf02e5c4c3bb93e11ac3755e61202abd74da5885d2e9c9160e">clang::index::SymbolRole::Call</a></div><div class="ttdeci">@ Call</div></div>
<div class="ttc" id="aCallEvent_8h_html"><div class="ttname"><a href="CallEvent_8h.html">CallEvent.h</a></div></div>
<div class="ttc" id="aBuiltinCheckerRegistration_8h_html"><div class="ttname"><a href="BuiltinCheckerRegistration_8h.html">BuiltinCheckerRegistration.h</a></div></div>
<div class="ttc" id="aCheckerManager_8h_html"><div class="ttname"><a href="CheckerManager_8h.html">CheckerManager.h</a></div></div>
<div class="ttc" id="aopencl-c-base_8h_html_a0bd5dec00e345e69027427f8621d6a6c"><div class="ttname"><a href="opencl-c-base_8h.html#a0bd5dec00e345e69027427f8621d6a6c">intptr_t</a></div><div class="ttdeci">__INTPTR_TYPE__ intptr_t</div><div class="ttdoc">A signed integer type with the property that any valid pointer to void can be converted to this type,...</div><div class="ttdef"><b>Definition:</b> <a href="opencl-c-base_8h_source.html#l00131">opencl-c-base.h:131</a></div></div>
<div class="ttc" id="aclassclang_1_1StringLiteral_html"><div class="ttname"><a href="classclang_1_1StringLiteral.html">clang::StringLiteral</a></div><div class="ttdoc">StringLiteral - This represents a string literal expression, e.g.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l01767">Expr.h:1767</a></div></div>
<div class="ttc" id="aCodeGen_2README_8txt_html_a2f5467b833926827f4292d3ba7fea003"><div class="ttname"><a href="CodeGen_2README_8txt.html#a2f5467b833926827f4292d3ba7fea003">x</a></div><div class="ttdeci">IRgen optimization opportunities The common pattern of short x</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2README_8txt_source.html#l00007">README.txt:7</a></div></div>
<div class="ttc" id="aStaticAnalyzer_2README_8txt_html_a1a264b3e48bda8ea3bed83698db8dca7"><div class="ttname"><a href="StaticAnalyzer_2README_8txt.html#a1a264b3e48bda8ea3bed83698db8dca7">state</a></div><div class="ttdeci">and static some checkers Checker The latter are built on top of the former via the Checker and CheckerVisitor and attempts to isolate them from much of the gore of the internal analysis the analyzer is basically a source code simulator that traces out possible paths of execution The state of the and the combination of state and program point is a node in an exploded which has the entry program point and initial state</div><div class="ttdef"><b>Definition:</b> <a href="StaticAnalyzer_2README_8txt_source.html#l00030">README.txt:30</a></div></div>
<div class="ttc" id="aBugType_8h_html"><div class="ttname"><a href="BugType_8h.html">BugType.h</a></div></div>
<div class="ttc" id="aCheckerContext_8h_html"><div class="ttname"><a href="CheckerContext_8h.html">CheckerContext.h</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ObjCPropertyAttribute_html_a5cee046f95725089d626e8e3c42bf60c"><div class="ttname"><a href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">clang::ObjCPropertyAttribute::Kind</a></div><div class="ttdeci">Kind</div><div class="ttdef"><b>Definition:</b> <a href="DeclObjCCommon_8h_source.html#l00022">DeclObjCCommon.h:22</a></div></div>
<div class="ttc" id="aProgramState_8h_html"><div class="ttname"><a href="ProgramState_8h.html">ProgramState.h</a></div></div>
<div class="ttc" id="aChecker_8h_html"><div class="ttname"><a href="Checker_8h.html">Checker.h</a></div></div>
<div class="ttc" id="anamespaceclang_html"><div class="ttname"><a href="namespaceclang.html">clang</a></div><div class="ttdef"><b>Definition:</b> <a href="CalledOnceCheck_8h_source.html#l00017">CalledOnceCheck.h:17</a></div></div>
<div class="ttc" id="aProgramStateTrait_8h_html"><div class="ttname"><a href="ProgramStateTrait_8h.html">ProgramStateTrait.h</a></div></div>
<div class="ttc" id="aclassclang_1_1Expr_html"><div class="ttname"><a href="classclang_1_1Expr.html">clang::Expr</a></div><div class="ttdoc">This represents one expression.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l00109">Expr.h:109</a></div></div>
<div class="ttc" id="aclassclang_1_1StringLiteral_html_ad22b80b61dba8e5c885377cf2a3b0d87"><div class="ttname"><a href="classclang_1_1StringLiteral.html#ad22b80b61dba8e5c885377cf2a3b0d87">clang::StringLiteral::getString</a></div><div class="ttdeci">StringRef getString() const</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l01850">Expr.h:1850</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 4 2022 01:35:52 for clang by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
