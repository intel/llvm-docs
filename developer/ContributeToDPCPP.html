
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Contributing to DPC++ &#8212; oneAPI DPC++ Compiler  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/haiku.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="ABI Policy Guide" href="ABIPolicyGuide.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>oneAPI DPC++ Compiler  documentation</span></a></h1>
        <h2 class="heading"><span>Contributing to DPC++</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="ABIPolicyGuide.html">ABI Policy Guide</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section class="tex2jax_ignore mathjax_ignore" id="contributing-to-dpc">
<h1>Contributing to DPC++<a class="headerlink" href="#contributing-to-dpc" title="Permalink to this headline">¶</a></h1>
<section id="maintaining-stable-abi-api">
<h2>Maintaining stable ABI/API<a class="headerlink" href="#maintaining-stable-abi-api" title="Permalink to this headline">¶</a></h2>
<p>All changes made to the DPC++ compiler and runtime library should generally
preserve existing ABI/API and contributors should avoid making incompatible
changes. One of the exceptions is experimental APIs, clearly marked so by
namespace or related specification.</p>
<p>Another exceptional case is the transition from SYCL 1.2.1 to SYCL 2020
standard.</p>
<p>Deprecation of older APIs is happening in the following order:</p>
<ul class="simple">
<li><p>Newer API implemented and covered with tests</p></li>
<li><p>Deprecation warning is added to older API</p></li>
<li><p>Wait some time allowing users to migrate their codebases (exact period depends
on the change made)</p></li>
<li><p>Old API is removed in headers</p></li>
<li><p>Old API is removed in library</p></li>
</ul>
<p>See <a class="reference internal" href="ABIPolicyGuide.html"><span class="doc std std-doc">ABI Policy Guide</span></a> for more information.</p>
</section>
<section id="project-build-and-local-testing">
<h2>Project build and local testing<a class="headerlink" href="#project-build-and-local-testing" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="../GetStartedGuide.html"><span class="doc std std-doc">Get Started Guide instructions</span></a></p>
</section>
<section id="commit-message">
<h2>Commit message<a class="headerlink" href="#commit-message" title="Permalink to this headline">¶</a></h2>
<p>For any DPC++-related commit, the <code class="docutils literal notranslate"><span class="pre">[SYCL]</span></code> tag should be present in the
commit message title. To a reasonable extent, additional tags can be used
to signify the component changed, e.g.: <code class="docutils literal notranslate"><span class="pre">[PI]</span></code>, <code class="docutils literal notranslate"><span class="pre">[CUDA]</span></code>, <code class="docutils literal notranslate"><span class="pre">[Doc]</span></code>.</p>
</section>
<section id="tests-development">
<h2>Tests development<a class="headerlink" href="#tests-development" title="Permalink to this headline">¶</a></h2>
<p>Every product change should be accompanied with corresponding test modification
(adding new test(s), extending, removing or modifying existing test(s)).</p>
<p>There are 3 types of tests which are used for DPC++ toolchain validation:</p>
<ul class="simple">
<li><p>DPC++ in-tree tests</p></li>
<li><p>DPC++ end-to-end (E2E) tests</p></li>
<li><p>SYCL Conformance Test Suite (CTS)</p></li>
</ul>
<section id="dpc-in-tree-tests">
<h3>DPC++ in-tree tests<a class="headerlink" href="#dpc-in-tree-tests" title="Permalink to this headline">¶</a></h3>
<p>DPC++ in-tree tests are hosted in this repository. They can be run by
<a class="reference external" href="https://github.com/intel/llvm/tree/sycl/sycl/doc/developer//llvm/test"><span class="xref myst">check-llvm</span></a>, <a class="reference external" href="https://github.com/intel/llvm/tree/sycl/sycl/doc/developer//clang/test"><span class="xref myst">check-clang</span></a>,
<a class="reference external" href="https://github.com/intel/llvm/tree/sycl/sycl/doc/developer//llvm-spirv/test"><span class="xref myst">check-llvm-spirv</span></a> and <a class="reference external" href="https://github.com/intel/llvm/tree/sycl/sycl/doc/developer//sycl/test"><span class="xref myst">check-sycl</span></a> targets.
These tests are expected not to have hardware (e.g. GPU, FPGA, etc.) or
external software (e.g. OpenCL, Level Zero, CUDA runtimes) dependencies. All
other tests should land at DPC++ end-to-end or SYCL CTS tests.</p>
<p>Generally, any functional change to any of the DPC++ toolchain components
should be accompanied by one or more tests of this type when possible. They
allow verifying individual components and tend to be more lightweight than
end-to-end or SYCL-CTS tests.</p>
<section id="general-guidelines">
<h4>General guidelines<a class="headerlink" href="#general-guidelines" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">sycl::</span></code> namespace instead of <code class="docutils literal notranslate"><span class="pre">cl::sycl::</span></code></p></li>
<li><p>Add a helpful comment describing what the test does at the beginning and
other comments throughout the test as necessary.</p></li>
<li><p>All identifiers used in <code class="docutils literal notranslate"><span class="pre">llvm/sycl</span></code> headers files must contain at
least one lowercase letter due to avoid conflicts with user-defined macros.</p></li>
<li><p>Try to follow descriptive naming convention for variables, functions as
much as possible. Please refer to
<a class="reference external" href="https://llvm.org/docs/CodingStandards.html#name-types-functions-variables-and-enumerators-properly">LLVM naming convention</a></p></li>
</ul>
</section>
<section id="dpc-clang-fe-tests">
<h4>DPC++ clang FE tests<a class="headerlink" href="#dpc-clang-fe-tests" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p>Include sycl mock headers as system headers.
Example: <code class="docutils literal notranslate"><span class="pre">-internal-isystem</span> <span class="pre">%S/Inputs</span></code></p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span>`#include &quot;sycl.hpp&quot;`
</pre></div>
</div>
</li>
<li><p>Use SYCL functions for invoking kernels from the mock header
<code class="docutils literal notranslate"><span class="pre">(single_task,</span> <span class="pre">parallel_for,</span> <span class="pre">parallel_for_work_group)</span></code>
Example:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span>`#include &quot;Inputs/sycl.hpp&quot;`
sycl::queue q;
q.submit([&amp;](cl::sycl::handler &amp;h) {
h.single_task( { //code });
});
</pre></div>
</div>
</li>
</ul>
</section>
<section id="dpc-headers-and-runtime-tests">
<h4>DPC++ headers and runtime tests<a class="headerlink" href="#dpc-headers-and-runtime-tests" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/intel/llvm/tree/sycl/sycl/doc/developer//sycl/test"><span class="xref myst">check-sycl</span></a> target contains 2 types of tests: LIT tests and
unit tests. LIT tests make compile-time checks of DPC++ headers, e.g. device
code IR verification, static_assert tests. Unit tests check DPC++ runtime
behavior and do not perform any device code compilation, instead relying on
redefining plugin API with <a class="reference external" href="https://github.com/intel/llvm/tree/sycl/sycl/doc/developer//sycl/unittests/helpers/PiMock.hpp"><span class="xref myst">PiMock</span></a> when
necessary.</p></li>
</ul>
</section>
</section>
<section id="dpc-end-to-end-e2e-tests">
<h3>DPC++ end-to-end (E2E) tests<a class="headerlink" href="#dpc-end-to-end-e2e-tests" title="Permalink to this headline">¶</a></h3>
<p>These tests are extension to
<a class="reference external" href="https://github.com/intel/llvm-test-suite/tree/intel/SYCL">LLVM test suite</a>
and hosted at separate repository.
A test which requires full stack including backend runtimes (e.g. OpenCL,
Level Zero or CUDA) should be added to DPC++ E2E test suite following
<a class="reference external" href="https://github.com/intel/llvm-test-suite/blob/intel/CONTRIBUTING.md">CONTRIBUTING</a>.</p>
</section>
<section id="sycl-conformance-test-suite-cts">
<h3>SYCL Conformance Test Suite (CTS)<a class="headerlink" href="#sycl-conformance-test-suite-cts" title="Permalink to this headline">¶</a></h3>
<p>These tests are hosted at
<a class="reference external" href="https://github.com/KhronosGroup/SYCL-CTS">Khronos SYCL conformance tests</a>.
These tests verify SYCL specification conformance. All implementation details
are out of scope for the tests.
See DPC++ compiler invocation definitions at
<a class="reference external" href="https://github.com/KhronosGroup/SYCL-CTS/blob/SYCL-1.2.1/master/cmake/FindIntel_SYCL.cmake">FindIntel_SYCL</a>)</p>
</section>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="ABIPolicyGuide.html">ABI Policy Guide</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, Intel Corporation.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.1.2.
    </div>
  </body>
</html>